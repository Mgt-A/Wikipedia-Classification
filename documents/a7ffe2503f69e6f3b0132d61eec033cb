<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="P-code machine,BCPL,Business Operating System,Bytecode,Compiler,Computer programming,Cross-platform,Dynamic memory allocation,Forth (programming language),Frame pointer,Interpreted language" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=P-code_machine&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=P-code_machine&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>P-code machine - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "P-code_machine";
		var wgTitle = "P-code machine";
		var wgAction = "view";
		var wgArticleId = "24722";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 279354268;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
<style type="text/css">/*<![CDATA[*/
.source-pascal {line-height: normal;}
.source-pascal li, .source-pascal pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for pascal
 * CSS class: source-pascal, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter)
 */
.source-pascal .de1, .source-pascal .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal;}
.source-pascal  {}
.source-pascal .head {}
.source-pascal .foot {}
.source-pascal .imp {font-weight: bold; color: red;}
.source-pascal .ln-xtra {color: #cc0; background-color: #ffc;}
.source-pascal li {font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;}
.source-pascal li.li2 {font-weight: bold;}
.source-pascal .kw1 {color: #b1b100;}
.source-pascal .kw2 {color: #000000; font-weight: bold;}
.source-pascal .kw3 {}
.source-pascal .kw4 {color: #993333;}
.source-pascal .co1 {color: #808080; font-style: italic;}
.source-pascal .co2 {color: #339933;}
.source-pascal .coMULTI {color: #808080; font-style: italic;}
.source-pascal .es0 {color: #000099; font-weight: bold;}
.source-pascal .br0 {color: #66cc66;}
.source-pascal .st0 {color: #ff0000;}
.source-pascal .nu0 {color: #cc66cc;}
.source-pascal .me1 {color: #202020;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
/*]]>*/
</style>		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-P-code_machine skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">P-code machine</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p>In <a href="/wiki/Computer_programming" title="Computer programming">computer programming</a>, a <b>p-code machine</b>, <b>precompiled code machine</b> or <b>pseudo-code machine</b> is a <a href="/wiki/Virtual_machine" title="Virtual machine">virtual machine</a> designed to execute <b>p-code</b> (the <a href="/wiki/Machine_language" title="Machine language" class="mw-redirect">assembly language</a> of a hypothetical CPU). This term is applied both generically to all such machines (such as the <a href="/wiki/Java_Virtual_Machine" title="Java Virtual Machine">Java Virtual Machine</a> and <a href="/wiki/Matlab" title="Matlab" class="mw-redirect">Matlab</a> precompiled code, both using <a href="/wiki/Bytecode" title="Bytecode">bytecode</a>), and to specific implementations, the most famous being the p-Machine of <a href="/wiki/UCSD_Pascal" title="UCSD Pascal">UCSD Pascal</a>.</p>
<p>Although the concept was first implemented circa 1966 (as <a href="/wiki/O-code" title="O-code">O-code</a> for <a href="/wiki/BCPL" title="BCPL">BCPL</a>), the term p-code first appeared in the early 1970s. Two early <a href="/wiki/Compiler" title="Compiler">compilers</a> generating p-code were the Pascal-P compiler in 1973, by Nori, Ammann, Jensen, Hageli, and Jacobi,<sup id="cite_ref-0" class="reference"><a href="#cite_note-0" title=""><span>[</span>1<span>]</span></a></sup> and the Pascal-S compiler in 1975, by <a href="/wiki/Niklaus_Wirth" title="Niklaus Wirth">Niklaus Wirth</a>.</p>
<p>Programs that have been translated to p-code are interpreted by a software program that emulates the behavior of the hypothetical CPU. If there is sufficient commercial interest, a hardware implementation of the CPU specification may be built (e.g., the <a href="/wiki/Pascal_MicroEngine" title="Pascal MicroEngine">Pascal MicroEngine</a>).</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Why_p-code.3F"><span class="tocnumber">1</span> <span class="toctext">Why p-code?</span></a></li>
<li class="toclevel-1"><a href="#The_UCSD_p-Machine"><span class="tocnumber">2</span> <span class="toctext">The UCSD p-Machine</span></a>
<ul>
<li class="toclevel-2"><a href="#Architecture"><span class="tocnumber">2.1</span> <span class="toctext">Architecture</span></a></li>
<li class="toclevel-2"><a href="#Environment"><span class="tocnumber">2.2</span> <span class="toctext">Environment</span></a></li>
<li class="toclevel-2"><a href="#Calling_conventions"><span class="tocnumber">2.3</span> <span class="toctext">Calling conventions</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Example_machine"><span class="tocnumber">3</span> <span class="toctext">Example machine</span></a></li>
<li class="toclevel-1"><a href="#Notes"><span class="tocnumber">4</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1"><a href="#Further_reading"><span class="tocnumber">5</span> <span class="toctext">Further reading</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Why_p-code.3F" id="Why_p-code.3F"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=1" title="Edit section: Why p-code?">edit</a>]</span> <span class="mw-headline">Why p-code?</span></h2>
<p>Compared to direct translation into native machine code, a two-stage approach involving translation into p-code and execution by an interpreter or <a href="/wiki/Just-in-time_compilation" title="Just-in-time compilation">just-in-time compiler</a> offers several advantages.</p>
<p><b>Portability:</b> It is much easier to write a small p-code interpreter for a new machine than it is to modify a compiler to generate native code for the same machine.</p>
<p><b>Simple implementation:</b> Generating machine code is one of the more complicated parts of writing a compiler. By comparison, generating p-code is much easier. This makes it useful for getting a compiler up and running quickly.</p>
<p><b>Compact size:</b> Since p-code is based on an ideal virtual machine, a p-code program is often much smaller than the same program translated to machine code.</p>
<p><b>Debugging:</b> When the p-code is interpreted, the interpreter can apply additional runtime checks that are difficult to implement with native code.</p>
<p>In the early 1980s, at least two operating systems achieved <a href="/wiki/Cross-platform" title="Cross-platform">machine independence</a> through extensive use of p-code. The <a href="/wiki/Business_Operating_System" title="Business Operating System">Business Operating System</a> (BOS) was a cross-platform operating system designed to run p-code programs exclusively. The UCSD p-System, developed at The University of California, San Diego, was a self-compiling and self-hosted operating system based on p-code optimized for generation by the <a href="/wiki/Pascal_programming_language" title="Pascal programming language" class="mw-redirect">Pascal programming language</a>.</p>
<p>In the 1990s, translation into p-code became a popular strategy for implementations of languages such as <a href="/wiki/Python_(programming_language)" title="Python (programming language)">Python</a> and <a href="/wiki/Java_(programming_language)" title="Java (programming language)">Java</a>.</p>
<p><a name="The_UCSD_p-Machine" id="The_UCSD_p-Machine"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=2" title="Edit section: The UCSD p-Machine">edit</a>]</span> <span class="mw-headline">The UCSD p-Machine</span></h2>
<p><a name="Architecture" id="Architecture"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=3" title="Edit section: Architecture">edit</a>]</span> <span class="mw-headline">Architecture</span></h3>
<p>Like many other p-code machines, the UCSD p-Machine is a <a href="/wiki/Stack_machine" title="Stack machine">stack machine</a>, which means that most instructions take their operands from the stack, and place results back on the stack. So the "add" instruction replaces the two topmost elements of the stack with their sum. A few instructions take an immediate argument. Like Pascal, the p-code is strongly typed, supporting boolean (b), character (c), integer (i), real (r), set (s), and pointer (a) types natively.</p>
<p>Some simple instructions:</p>
<pre>
Insn.   Stack   Stack   Description
        before  after
 
adi      i1 i2   i1+i2   add two integers
adr      r1 r2   r1+r2   add two reals
dvi      i1 i2   i1/i2   integer division
inn      i1 s1   b1      set membership; b1 = whether i1 is a member of s1
ldci i1          i1      load integer constant
mov      a1 a2           move
not      b1      ~b1     boolean negation
</pre>
<p><a name="Environment" id="Environment"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=4" title="Edit section: Environment">edit</a>]</span> <span class="mw-headline">Environment</span></h3>
<p>Unlike other stack-based environments (such as <a href="/wiki/Forth_(programming_language)" title="Forth (programming language)">Forth</a> and the <a href="/wiki/Java_Virtual_Machine" title="Java Virtual Machine">Java Virtual Machine</a>) the p-System has only one stack shared by procedure stack frames (providing <a href="/wiki/Return_address" title="Return address">return address</a>, etc.) and the arguments to local instructions. Three of the machine's <a href="/wiki/Processor_register" title="Processor register">registers</a> point into the stack (which grows upwards):</p>
<ul>
<li>SP points to the top of the stack (the <a href="/wiki/Stack_pointer" title="Stack pointer" class="mw-redirect">stack pointer</a>).</li>
<li>MP marks the beginning of the active stack frame (the <a href="/wiki/Frame_pointer" title="Frame pointer" class="mw-redirect">frame pointer</a>).</li>
<li>EP points to the highest stack location used in the current procedure.</li>
</ul>
<p>Also present is a constant area, and, below that, the <a href="/wiki/Dynamic_memory_allocation" title="Dynamic memory allocation">heap</a> growing down towards the stack. The NP register points to the top (lowest used address) of the heap. When EP gets greater than NP, the machine's memory is exhausted.</p>
<p>The fifth register, PC, points at the current instruction in the code area.</p>
<p><a name="Calling_conventions" id="Calling_conventions"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=5" title="Edit section: Calling conventions">edit</a>]</span> <span class="mw-headline">Calling conventions</span></h3>
<p>Stack frames look like this:</p>
<pre>
EP -&gt;
      local stack
SP -&gt; ...
      locals
      ...
      parameters
      ...
      return address (previous PC)
      previous EP
      dynamic link (previous MP)
      static link (MP of surrounding procedure)
MP -&gt; function return value
</pre>
<p>The procedure calling sequence works as follows: The call is introduced with</p>
<pre>
 mst n
</pre>
<p>where <i>n</i> specifies the difference in nesting levels (remember that Pascal supports nested procedures). This instruction will <i>mark</i> the stack, i.e. reserve the first five cells of the above stack frame, and initialise previous EP, dynamic, and static link. The caller then computes and pushes any parameters for the procedure, and then issues</p>
<pre>
 cup n, p
</pre>
<p>to call a user procedure (<i>n</i> being the number of parameters, <i>p</i> the procedure's address). This will save the PC in the return address cell, and set the procedure's address as the new PC.</p>
<p>User procedures begin with the two instructions</p>
<pre>
 ent 1, i
 ent 2, j
</pre>
<p>The first sets SP to MP + <i>i</i>, the second sets EP to SP + <i>j</i>. So <i>i</i> essentially specifies the space reserved for locals (plus the number of parameters plus 5), and <i>j</i> gives the number of entries needed locally for the stack. Memory exhaustion is checked at this point.</p>
<p>Returning to the caller is accomplished via</p>
<pre>
 retC
</pre>
<p>with <i>C</i> giving the return type (i, r, c, b, a as above, and p for no return value). The return value has to be stored in the appropriate cell previously. On all types except p, returning will leave this value on the stack.</p>
<p>Instead of calling a user procedure (cup), standard procedure <i>q</i> can be called with</p>
<pre>
 csp q
</pre>
<p>These standard procedures are Pascal procedures like <i>readln()</i> ("csp rln"), <i>sin()</i> ("csp sin"), etc. Peculiarly <i>eof()</i> is a p-Code instruction instead.</p>
<p><a name="Example_machine" id="Example_machine"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=6" title="Edit section: Example machine">edit</a>]</span> <span class="mw-headline">Example machine</span></h2>
<p>Niklaus Wirth specified a simple p-code machine in the 1976 book <i>Algorithms + Data Structures = Programs</i>. The machine had 3 registers - a <a href="/wiki/Program_counter" title="Program counter">program counter</a>, p, a <a href="/wiki/Stack_frame" title="Stack frame" class="mw-redirect">base register</a> b, and a <a href="/wiki/Stack_(data_structure)" title="Stack (data structure)">top-of-stack register</a> t. There were 8 instructions, with one (opr) having multiple forms.</p>
<p>This is the code for the machine:</p>
<div dir="ltr" style="text-align: left;">
<pre class="source-pascal">
<span class="kw2">procedure</span> interpret;
 
  <span class="kw4">const</span> stacksize = <span class="nu0">500</span>;
 
  <span class="kw1">var</span>
    p, b, t: <span class="kw4">integer</span>; <span class="coMULTI">{program-, base-, topstack-registers}</span>
    i: instruction; <span class="coMULTI">{instruction register}</span>
    s: <span class="kw4">array</span> <span class="br0">[</span><span class="nu0">1</span>..<span class="me1">stacksize</span><span class="br0">]</span> <span class="kw1">of</span> <span class="kw4">integer</span>; <span class="coMULTI">{datastore}</span>
 
  <span class="kw2">function</span> base<span class="br0">(</span>l: <span class="kw4">integer</span><span class="br0">)</span>: <span class="kw4">integer</span>;
    <span class="kw1">var</span> b1: <span class="kw4">integer</span>;
  <span class="kw1">begin</span>
    b1 := b; <span class="coMULTI">{find base l levels down}</span>
    <span class="kw1">while</span> l &gt; <span class="nu0">0</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      b1 := s<span class="br0">[</span>b1<span class="br0">]</span>;
      l := l - <span class="nu0">1</span>
    <span class="kw1">end</span>;
    base := b1
  <span class="kw1">end</span> <span class="coMULTI">{base}</span>;
 
<span class="kw1">begin</span>
  <span class="kw3">writeln</span><span class="br0">(</span><span class="st0">' start pl/0'</span><span class="br0">)</span>;
  t := <span class="nu0">0</span>; b := <span class="nu0">1</span>; p := <span class="nu0">0</span>;
  s<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span> := <span class="nu0">0</span>; s<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span> := <span class="nu0">0</span>; s<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span> := <span class="nu0">0</span>;
  <span class="kw1">repeat</span>
    i := code<span class="br0">[</span>p<span class="br0">]</span>; p := p + <span class="nu0">1</span>;
    with i <span class="kw1">do</span>
      <span class="kw1">case</span> f <span class="kw1">of</span>
        lit: <span class="kw1">begin</span> t := t + <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := a <span class="kw1">end</span>;
        opr: 
          <span class="kw1">case</span> a <span class="kw1">of</span> <span class="coMULTI">{operator}</span>
            <span class="nu0">0</span>: 
              <span class="kw1">begin</span> <span class="coMULTI">{return}</span>
                t := b - <span class="nu0">1</span>; p := s<span class="br0">[</span>t + <span class="nu0">3</span><span class="br0">]</span>; b := s<span class="br0">[</span>t + <span class="nu0">2</span><span class="br0">]</span>;
              <span class="kw1">end</span>;
            <span class="nu0">1</span>: s<span class="br0">[</span>t<span class="br0">]</span> := -s<span class="br0">[</span>t<span class="br0">]</span>;
            <span class="nu0">2</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := s<span class="br0">[</span>t<span class="br0">]</span> + s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span> <span class="kw1">end</span>;
            <span class="nu0">3</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := s<span class="br0">[</span>t<span class="br0">]</span> - s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span> <span class="kw1">end</span>;
            <span class="nu0">4</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := s<span class="br0">[</span>t<span class="br0">]</span> * s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span> <span class="kw1">end</span>;
            <span class="nu0">5</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := s<span class="br0">[</span>t<span class="br0">]</span> <span class="kw1">div</span> s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span> <span class="kw1">end</span>;
            <span class="nu0">6</span>: s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span><span class="kw3">odd</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;
            <span class="nu0">8</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span> = s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">end</span>;
            <span class="nu0">9</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span> &lt;&gt; s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">end</span>;
            <span class="nu0">10</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span> &lt; s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">end</span>;
            <span class="nu0">11</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span> &gt;= s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">end</span>;
            <span class="nu0">12</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span> &gt; s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">end</span>;
            <span class="nu0">13</span>: <span class="kw1">begin</span> t := t - <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := <span class="kw3">ord</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span> &lt;= s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">end</span>;
          <span class="kw1">end</span>;
        lod: <span class="kw1">begin</span> t := t + <span class="nu0">1</span>; s<span class="br0">[</span>t<span class="br0">]</span> := s<span class="br0">[</span>base<span class="br0">(</span>l<span class="br0">)</span> + a<span class="br0">]</span> <span class="kw1">end</span>;
        sto: <span class="kw1">begin</span> s<span class="br0">[</span>base<span class="br0">(</span>l<span class="br0">)</span>+a<span class="br0">]</span> := s<span class="br0">[</span>t<span class="br0">]</span>; <span class="kw3">writeln</span><span class="br0">(</span>s<span class="br0">[</span>t<span class="br0">]</span><span class="br0">)</span>; t := t - <span class="nu0">1</span> <span class="kw1">end</span>;
        cal: 
          <span class="kw1">begin</span> <span class="coMULTI">{generate new block mark}</span>
            s<span class="br0">[</span>t + <span class="nu0">1</span><span class="br0">]</span> := base<span class="br0">(</span>l<span class="br0">)</span>; s<span class="br0">[</span>t + <span class="nu0">2</span><span class="br0">]</span> := b; s<span class="br0">[</span>t + <span class="nu0">3</span><span class="br0">]</span> := p;
            b := t + <span class="nu0">1</span>; p := a
          <span class="kw1">end</span>;
        int: t := t + a;
        jmp: p := a;
        jpc: <span class="kw1">begin</span> <span class="kw1">if</span> s<span class="br0">[</span>t<span class="br0">]</span> = <span class="nu0">0</span> <span class="kw1">then</span> p := a; t := t - <span class="nu0">1</span> <span class="kw1">end</span>
      <span class="kw1">end</span> <span class="coMULTI">{with, case}</span>
  <span class="kw1">until</span> p = <span class="nu0">0</span>;
  <span class="kw3">writeln</span><span class="br0">(</span><span class="st0">' end pl/0'</span><span class="br0">)</span>;
<span class="kw1">end</span> <span class="coMULTI">{interpret}</span>;
</pre></div>
<p>This machine was used to run Wirth's <a href="/wiki/PL/0" title="PL/0">PL/0</a>, which was a Pascal subset compiler used to teach compiler development.</p>
<p><a name="Notes" id="Notes"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=7" title="Edit section: Notes">edit</a>]</span> <span class="mw-headline">Notes</span></h2>
<div class="references-small">
<ol class="references">
<li id="cite_note-0"><b><a href="#cite_ref-0" title="">^</a></b> <cite style="font-style:normal" class="book" id="CITEREFNoriAmmannJensenNageli1975">Nori, K.V.; Ammann, U.; Jensen; Nageli, H. (1975). <i>The Pascal P Compiler Implementation Notes</i>. Zurich: Eidgen. Tech. Hochschule.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=The+Pascal+P+Compiler+Implementation+Notes&amp;rft.aulast=Nori&amp;rft.aufirst=K.V.&amp;rft.au=Nori%2C+K.V.&amp;rft.au=Ammann%2C+U.&amp;rft.au=Jensen&amp;rft.au=Nageli%2C+H.&amp;rft.date=1975&amp;rft.place=Zurich&amp;rft.pub=Eidgen.+Tech.+Hochschule&amp;rfr_id=info:sid/en.wikipedia.org:P-code_machine"><span style="display: none;">&#160;</span></span></li>
</ol>
</div>
<p><a name="Further_reading" id="Further_reading"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=8" title="Edit section: Further reading">edit</a>]</span> <span class="mw-headline">Further reading</span></h2>
<ul>
<li><a href="/wiki/Steven_Pemberton" title="Steven Pemberton">Steven Pemberton</a> and Martin Daniels: <a href="http://www.cwi.nl/~steven/pascal/book/" class="external text" title="http://www.cwi.nl/~steven/pascal/book/" rel="nofollow">Pascal Implementation: The P4 Compiler and Interpreter</a>. <a href="/wiki/Special:BookSources/0853123586" class="internal">ISBN 0-85312-358-6</a>; <a href="/wiki/Special:BookSources/0136530311" class="internal">ISBN 0-13-653031-1</a></li>
<li><a href="http://homepages.cwi.nl/~steven/pascal/" class="external text" title="http://homepages.cwi.nl/~steven/pascal/" rel="nofollow">Steven Pemberton's page on Pascal</a> has Pascal sources of the P4 compiler and interpreter, usage instructions, and <a href="http://www.cwi.nl/ftp/pascal/pcom.code4.Z" class="external text" title="http://www.cwi.nl/ftp/pascal/pcom.code4.Z" rel="nofollow">the p-code of the compiler</a> (generated by itself).</li>
<li><a href="http://www.threedee.com/jcm/psystem/" class="external text" title="http://www.threedee.com/jcm/psystem/" rel="nofollow">The Jefferson Computer Museum's page on the UCSD p-System</a></li>
<li><a href="http://www.klebsch.de" class="external text" title="http://www.klebsch.de" rel="nofollow">Open Source implementation</a></li>
<li><i>Compiling with C# and Java</i>, Pat Terry, 2005, <a href="/wiki/Special:BookSources/032126360X" class="internal">ISBN 0-321-26360-X</a>, 624</li>
<li><i>Algorithms + Data Structures = Programs</i>, Niklaus Wirth, 1975, <a href="/wiki/Special:BookSources/0130224189" class="internal">ISBN 0-13-022418-9</a></li>
<li><i>Compiler Construction</i>, Niklaus Wirth, 1996, <a href="/wiki/Special:BookSources/0201403536" class="internal">ISBN 0-201-40353-6</a></li>
<li><i>The Byte Book of Pascal</i>, Blaise W. Liffick, Editor, 1979, <a href="/wiki/Special:BookSources/0070378231" class="internal">ISBN 0-07-037823-1</a></li>
<li><i>PASCAL - The Language and its Implementation</i>, Edited by D.W. Barron, 1981, <a href="/wiki/Special:BookSources/0471278351" class="internal">ISBN 0-471-27835-1</a>. Especially see the articles <i>Pascal-P Implementation Notes</i> and <i>Pascal-S: A Subset and its Implementation</i>.</li>
</ul>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=P-code_machine&amp;action=edit&amp;section=9" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/Runtime" title="Runtime">Runtime</a></li>
<li><a href="/wiki/Compiler" title="Compiler">Compiler</a></li>
<li><a href="/wiki/Interpreter_(computer_software)" title="Interpreter (computer software)" class="mw-redirect">Interpreter</a></li>
<li><a href="/wiki/Interpreted_language" title="Interpreted language">Interpreted language</a></li>
<li><a href="/wiki/Joel_McCormack" title="Joel McCormack">Joel McCormack</a></li>
<li><a href="/wiki/Microsoft_P-Code" title="Microsoft P-Code">Microsoft P-Code</a></li>
<li><a href="/wiki/Threaded_code#Token_threading" title="Threaded code">Token threaded code</a></li>
</ul>


<!-- 
NewPP limit report
Preprocessor node count: 624/1000000
Post-expand include size: 3539/2048000 bytes
Template argument size: 641/2048000 bytes
Expensive parser function count: 0/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:24722-0!1!0!default!!en!2 and timestamp 20090324131915 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/P-code_machine">http://en.wikipedia.org/wiki/P-code_machine</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Virtualization_software" title="Category:Virtualization software">Virtualization software</a></span> | <span dir='ltr'><a href="/wiki/Category:Pascal" title="Category:Pascal">Pascal</a></span> | <span dir='ltr'><a href="/wiki/Category:Compilers" title="Category:Compilers">Compilers</a></span> | <span dir='ltr'><a href="/wiki/Category:Programming_language_implementation" title="Category:Programming language implementation">Programming language implementation</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/P-code_machine" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:P-code_machine" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=P-code_machine&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=P-code_machine&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=P-code_machine" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/P-code_machine" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/P-code_machine" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=P-code_machine&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=P-code_machine&amp;oldid=279354268" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=P-code_machine&amp;id=279354268">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-de"><a href="http://de.wikipedia.org/wiki/P-Code">Deutsch</a></li>
				<li class="interwiki-it"><a href="http://it.wikipedia.org/wiki/P-Code">Italiano</a></li>
				<li class="interwiki-nl"><a href="http://nl.wikipedia.org/wiki/P-Code">Nederlands</a></li>
				<li class="interwiki-ja"><a href="http://ja.wikipedia.org/wiki/P%E3%82%B3%E3%83%BC%E3%83%89%E3%83%9E%E3%82%B7%E3%83%B3">日本語</a></li>
				<li class="interwiki-ru"><a href="http://ru.wikipedia.org/wiki/P-%D0%BA%D0%BE%D0%B4">Русский</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 24 March 2009, at 13:11.</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv191 in 0.040 secs. --></body></html>
