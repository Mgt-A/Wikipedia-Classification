<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="Tagged union,ALGOL 68,Ada programming language,Algebraic data type,Binary tree,Boost C++ Libraries,C++,C (programming language),Class hierarchy,Computer science,Constructor (computer science)" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Tagged_union&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=Tagged_union&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Tagged union - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Tagged_union";
		var wgTitle = "Tagged union";
		var wgAction = "view";
		var wgArticleId = "453395";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 265914577;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
<style type="text/css">/*<![CDATA[*/
.source-pascal {line-height: normal;}
.source-pascal li, .source-pascal pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for pascal
 * CSS class: source-pascal, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter)
 */
.source-pascal .de1, .source-pascal .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal;}
.source-pascal  {}
.source-pascal .head {}
.source-pascal .foot {}
.source-pascal .imp {font-weight: bold; color: red;}
.source-pascal .ln-xtra {color: #cc0; background-color: #ffc;}
.source-pascal li {font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;}
.source-pascal li.li2 {font-weight: bold;}
.source-pascal .kw1 {color: #b1b100;}
.source-pascal .kw2 {color: #000000; font-weight: bold;}
.source-pascal .kw3 {}
.source-pascal .kw4 {color: #993333;}
.source-pascal .co1 {color: #808080; font-style: italic;}
.source-pascal .co2 {color: #339933;}
.source-pascal .coMULTI {color: #808080; font-style: italic;}
.source-pascal .es0 {color: #000099; font-weight: bold;}
.source-pascal .br0 {color: #66cc66;}
.source-pascal .st0 {color: #ff0000;}
.source-pascal .nu0 {color: #cc66cc;}
.source-pascal .me1 {color: #202020;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-c {line-height: normal;}
.source-c li, .source-c pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for c
 * CSS class: source-c, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter)
 */
.source-c .de1, .source-c .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal;}
.source-c  {}
.source-c .head {}
.source-c .foot {}
.source-c .imp {font-weight: bold; color: red;}
.source-c .ln-xtra {color: #cc0; background-color: #ffc;}
.source-c li {font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;}
.source-c li.li2 {font-weight: bold;}
.source-c .kw1 {color: #b1b100;}
.source-c .kw2 {color: #000000; font-weight: bold;}
.source-c .kw3 {color: #000066;}
.source-c .kw4 {color: #993333;}
.source-c .co1 {color: #808080; font-style: italic;}
.source-c .co2 {color: #339933;}
.source-c .coMULTI {color: #808080; font-style: italic;}
.source-c .es0 {color: #000099; font-weight: bold;}
.source-c .br0 {color: #66cc66;}
.source-c .st0 {color: #ff0000;}
.source-c .nu0 {color: #cc66cc;}
.source-c .me1 {color: #202020;}
.source-c .me2 {color: #202020;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-cpp {line-height: normal;}
.source-cpp li, .source-cpp pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp
 * CSS class: source-cpp, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter)
 */
.source-cpp .de1, .source-cpp .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal;}
.source-cpp  {}
.source-cpp .head {}
.source-cpp .foot {}
.source-cpp .imp {font-weight: bold; color: red;}
.source-cpp .ln-xtra {color: #cc0; background-color: #ffc;}
.source-cpp li {font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;}
.source-cpp li.li2 {font-weight: bold;}
.source-cpp .kw1 {color: #0000ff;}
.source-cpp .kw2 {color: #0000ff;}
.source-cpp .kw3 {color: #0000dd;}
.source-cpp .kw4 {color: #0000ff;}
.source-cpp .co1 {color: #ff0000;}
.source-cpp .co2 {color: #339900;}
.source-cpp .coMULTI {color: #ff0000; font-style: italic;}
.source-cpp .es0 {color: #666666; font-weight: bold;}
.source-cpp .br0 {color: #000000;}
.source-cpp .st0 {color: #666666;}
.source-cpp .nu0 {color: #0000dd;}
.source-cpp .me1 {color: #00eeff;}
.source-cpp .me2 {color: #00eeff;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
/*]]>*/
</style>		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Tagged_union skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">Tagged union</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p>In <a href="/wiki/Computer_science" title="Computer science">computer science</a>, a <b>tagged union</b>, also called a <a href="/wiki/Variant_type" title="Variant type">variant</a>, variant record, discriminated union, or <a href="/wiki/Disjoint_union" title="Disjoint union">disjoint union</a>, is a <a href="/wiki/Data_structure" title="Data structure">data structure</a> used to hold a value that could take on several different, but fixed types. Only one of the types can be in use at any one time, and a <b>tag</b> field explicitly indicates which one is in use. It can be thought of as a type which has several "cases," each of which should be handled correctly when that type is manipulated. Like ordinary <a href="/wiki/Union_(computer_science)" title="Union (computer science)">unions</a>, tagged unions can save storage by overlapping storage areas for each type, since only one is in use at a time.</p>
<p>Tagged unions are most important in functional languages such as <a href="/wiki/ML_programming_language" title="ML programming language" class="mw-redirect">ML</a> and <a href="/wiki/Haskell_(programming_language)" title="Haskell (programming language)">Haskell</a>, where they are called <b>datatypes</b> (see <a href="/wiki/Algebraic_data_type" title="Algebraic data type">algebraic data type</a>) and the compiler is able to verify that all cases of a tagged union are always handled, avoiding many types of errors. They can, however, be constructed in nearly any language, and are much safer than untagged unions, often simply called unions, which are similar but do not explicitly keep track of which member of the union is currently in use.</p>
<p>Tagged unions are often accompanied by the concept of a <b>constructor</b>, which is similar but not the same as a <a href="/wiki/Constructor_(computer_science)" title="Constructor (computer science)">constructor</a> for a class. Constructors produce a tagged union value, given the initial tag value and a value of the corresponding type.</p>
<p>Mathematically, tagged unions correspond to <i><a href="/wiki/Disjoint_union" title="Disjoint union">disjoint</a></i> or <i>discriminated unions</i>, usually written using +. Given an element of a disjoint union <i>A</i> + <i>B</i>, it is possible to determine whether it came from <i>A</i> or <i>B</i>. If an element lies in both, there will be two effectively distinct copies of the value in <i>A</i> + <i>B</i>, one from <i>A</i> and one from <i>B</i>.</p>
<p>In <a href="/wiki/Type_theory" title="Type theory">type theory</a>, a tagged union is called a <i>sum type</i>. Notations vary, but usually the sum type <span class="texhtml"><i>A</i> + <i>B</i></span> comes with two introduction forms <img class="tex" alt="\mathrm{inj}_1&#160;: A \to A+B" src="http://upload.wikimedia.org/math/8/d/1/8d1df1ad13d8d381eb25ea76769de402.png" /> and <img class="tex" alt="\mathrm{inj}_2&#160;: B \to A+B" src="http://upload.wikimedia.org/math/e/f/6/ef6bedb2defb020f9949098759a51dd4.png" />. The elimination form is case analysis: if <span class="texhtml"><i>e</i></span> has type <span class="texhtml"><i>A</i> + <i>B</i></span> and <span class="texhtml"><i>e</i><sub>1</sub></span> and <span class="texhtml"><i>e</i><sub>2</sub></span> have type <span class="texhtml">τ</span> under the assumptions <span class="texhtml"><i>x</i>:<i>A</i></span> and <span class="texhtml"><i>y</i>:<i>B</i></span> respectively, then the term <img class="tex" alt="\texttt{case}\ e\ \texttt{of}\ x \Rightarrow e_1 | y \Rightarrow e_2" src="http://upload.wikimedia.org/math/4/8/8/488eefd5ce2730660d39ae7ef39c77fb.png" /> has type <span class="texhtml">τ</span>. The sum type corresponds to <a href="/wiki/Logical_disjunction" title="Logical disjunction">logical disjunction</a> under the <a href="/wiki/Curry-Howard" title="Curry-Howard" class="mw-redirect">Curry-Howard</a> correspondence.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Advantages_and_disadvantages"><span class="tocnumber">1</span> <span class="toctext">Advantages and disadvantages</span></a></li>
<li class="toclevel-1"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">Examples</span></a></li>
<li class="toclevel-1"><a href="#Time_line_of_language_support"><span class="tocnumber">3</span> <span class="toctext">Time line of language support</span></a>
<ul>
<li class="toclevel-2"><a href="#1960s"><span class="tocnumber">3.1</span> <span class="toctext">1960s</span></a></li>
<li class="toclevel-2"><a href="#1970s_.26_1980s"><span class="tocnumber">3.2</span> <span class="toctext">1970s &amp; 1980s</span></a></li>
<li class="toclevel-2"><a href="#2000s"><span class="tocnumber">3.3</span> <span class="toctext">2000s</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Class_hierarchies_as_tagged_unions"><span class="tocnumber">4</span> <span class="toctext">Class hierarchies as tagged unions</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">5</span> <span class="toctext">External links</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Advantages_and_disadvantages" id="Advantages_and_disadvantages"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=1" title="Edit section: Advantages and disadvantages">edit</a>]</span> <span class="mw-headline">Advantages and disadvantages</span></h2>
<p>The primary advantage of a tagged union over an untagged union is that all accesses are safe, and the compiler can even check that all cases are handled. Untagged unions depend on program logic to correctly identify the currently active field, which may result in strange behavior and hard-to-find bugs if that logic fails.</p>
<p>The primary advantage of a tagged union over a simple <a href="/wiki/Record_(computer_science)" title="Record (computer science)">record</a> containing a field for each type is that it saves storage by overlapping storage for all the types. Some implementations reserve enough storage for the largest type, while others dynamically adjust the size of a tagged union value as needed. When the value is <a href="/wiki/Immutable_object" title="Immutable object">immutable</a>, it is simple to allocate just as much storage as is needed.</p>
<p>The main disadvantage of tagged unions is that the tag occupies space. Since there are usually a small number of alternatives, the tag can often be squeezed into 2 or 3 bits wherever space can be found, but sometimes even these bits are not available. In this case, a helpful alternative may be <b>folded</b>, <b>computed</b> or <b>encoded tags</b>, where the tag value is dynamically computed from the contents of the union field. Common examples of this are the use of <i>reserved values</i>, where, for example, a function returning a positive number may return -1 to indicate failure, and <a href="/wiki/Sentinel_value" title="Sentinel value">sentinel values</a>, most often used in <a href="/wiki/Tagged_pointer" title="Tagged pointer">tagged pointers</a>.</p>
<p>Sometimes, untagged unions are used to perform bit-level conversions between types, called reinterpret casts in C++. Tagged unions are not intended for this purpose; typically a new value is assigned whenever the tag is changed.</p>
<p>Many languages support, to some extent, a <a href="/wiki/Top_type" title="Top type">universal data type</a>, which is a type that includes every value of every other type, and often a way is provided to test the actual type of a value of the universal type. These are sometimes referred to as <i>variants</i>. While universal data types are comparable to tagged unions in their formal definition, typical tagged unions include a relatively small number of cases, and these cases form different ways of expressing a single coherent concept, such as a data structure node or instruction. Also, there is an expectation that every possible case of a tagged union will be dealt with when it is used. The values of a universal data type are not related and there is no feasible way to deal with them all.</p>
<p><a name="Examples" id="Examples"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=2" title="Edit section: Examples">edit</a>]</span> <span class="mw-headline">Examples</span></h2>
<p>Say we wanted to build a <a href="/wiki/Binary_tree" title="Binary tree">binary tree</a> of integers. In ML, we would do this by creating a datatype like this:</p>
<pre>
datatype tree = Leaf
              | Node of (int * tree * tree)
</pre>
<p>This is a tagged union with two cases: one, the leaf, is used to terminate a path of the tree, and functions much like a null value would in imperative languages. The other branch holds a node, which contains an integer and a left and right subtree. Leaf and Node are the constructors, which enable us to actually produce a particular tree, such as:</p>
<pre>
Node(5, Node(1,Leaf,Leaf), Node(3, Leaf, Node(4, Leaf, Leaf)))
</pre>
<p>which corresponds to this tree:</p>
<center><a href="/wiki/File:Tagged_union_tree.svg" class="image" title="The tree produced by the above constructors"><img alt="The tree produced by the above constructors" src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Tagged_union_tree.svg/200px-Tagged_union_tree.svg.png" width="200" height="178" border="0" /></a></center>
<p>Now we can easily write a typesafe function that, say, counts the number of nodes in the tree:</p>
<pre>
fun countNodes(Leaf) = 0
  | countNodes(Node(int,left,right)) =
      1 + countNodes(left) + countNodes(right)
</pre>
<p><a name="Time_line_of_language_support" id="Time_line_of_language_support"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=3" title="Edit section: Time line of language support">edit</a>]</span> <span class="mw-headline">Time line of language support</span></h2>
<p><a name="1960s" id="1960s"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=4" title="Edit section: 1960s">edit</a>]</span> <span class="mw-headline">1960s</span></h3>
<p>In <a href="/wiki/ALGOL_68" title="ALGOL 68">Algol 68</a>, tagged unions are called <b>united modes</b>, the tag is implicit, and the <code><u>case</u></code> construct is used to determine which field is tagged:</p>
<pre>
 <u>mode</u> <u>node</u> = <u>union</u> <b>(</b><u>real</u>, <u>int</u>, <u>compl</u>, <u>string</u><b>)</b>;
</pre>
<p>Usage example for <code><u>union</u></code> <code><u>case</u></code> of <code><u>node</u></code>:</p>
<pre>
 <u>node</u> n := "1234";
  
 <u>case</u> n <u>in</u>
   (<u>real</u> r):   print(("real:", r)),
   (<u>int</u> i):    print(("int:", i)),
   (<u>compl</u> c):  print(("compl:", c)),
   (<u>string</u> s): print(("string:", s))
   <u>out</u>         print(("?:", n))
 <u>esac</u>
</pre>
<p><a name="1970s_.26_1980s" id="1970s_.26_1980s"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=5" title="Edit section: 1970s &amp; 1980s">edit</a>]</span> <span class="mw-headline">1970s &amp; 1980s</span></h3>
<p>Although primarily only <a href="/wiki/Functional_programming_language" title="Functional programming language" class="mw-redirect">functional languages</a> such as <a href="/wiki/ML_programming_language" title="ML programming language" class="mw-redirect">ML</a> and <a href="/wiki/Haskell_(programming_language)" title="Haskell (programming language)">Haskell</a> (from 1990s) give a central role to tagged unions and have the power to check that all cases are handled, other languages have support for tagged unions as well. However, in practice they can be less efficient in non-functional languages due to optimizations enabled by functional language compilers that can eliminate explicit tag checks and avoid explicit storage of tags.</p>
<p><a href="/wiki/Pascal_programming_language" title="Pascal programming language" class="mw-redirect">Pascal</a>, <a href="/wiki/Ada_programming_language" title="Ada programming language" class="mw-redirect">Ada</a>, and <a href="/wiki/Modula-2" title="Modula-2">Modula-2</a> call them <b>variant records</b>, and require the tag field to be manually created and the tag values specified, as in this Pascal example:</p>
<div dir="ltr" style="text-align: left;">
<pre class="source-pascal">
<span class="kw4">type</span> shapeKind = <span class="br0">(</span>square, rectangle, circle<span class="br0">)</span>;
     shape = <span class="kw4">record</span>
                centerx : <span class="kw4">integer</span>;
                centery : <span class="kw4">integer</span>;
                <span class="kw1">case</span> kind : shapeKind <span class="kw1">of</span>
                   square : <span class="br0">(</span>side : <span class="kw4">integer</span><span class="br0">)</span>;
                   rectangle : <span class="br0">(</span>length, height : <span class="kw4">integer</span><span class="br0">)</span>;
                   circle : <span class="br0">(</span>radius : <span class="kw4">integer</span><span class="br0">)</span>;
	      <span class="kw1">end</span>;
</pre></div>
<p><br />
In <a href="/wiki/C_(programming_language)" title="C (programming language)">C</a> and <a href="/wiki/C%2B%2B" title="C++">C++</a>, a tagged union can be created from untagged unions using a strict access discipline where the tag is always checked:</p>
<div dir="ltr" style="text-align: left;">
<pre class="source-c">
<span class="kw2">enum</span> ShapeKind <span class="br0">{</span> Square, Rectangle, Circle <span class="br0">}</span>;
 
<span class="kw4">struct</span> Shape <span class="br0">{</span>
    <span class="kw4">int</span> centerx;
    <span class="kw4">int</span> centery;
    <span class="kw2">enum</span> ShapeKind kind;
    <span class="kw4">union</span> <span class="br0">{</span>
        <span class="kw4">struct</span> <span class="br0">{</span> <span class="kw4">int</span> side; <span class="br0">}</span>           squareData;
        <span class="kw4">struct</span> <span class="br0">{</span> <span class="kw4">int</span> length, height; <span class="br0">}</span> rectangleData;
        <span class="kw4">struct</span> <span class="br0">{</span> <span class="kw4">int</span> radius; <span class="br0">}</span>         circleData;
    <span class="br0">}</span> shapeKindData;
<span class="br0">}</span>;
 
<span class="kw4">int</span> getSquareSide<span class="br0">(</span><span class="kw4">struct</span> Shape* s<span class="br0">)</span> <span class="br0">{</span>
    assert<span class="br0">(</span>s-&gt;kind == Square<span class="br0">)</span>;
    <span class="kw1">return</span> s-&gt;shapeKindData.<span class="me1">squareData</span>.<span class="me1">side</span>;
<span class="br0">}</span>
 
<span class="kw4">void</span> setSquareSide<span class="br0">(</span><span class="kw4">struct</span> Shape* s, <span class="kw4">int</span> side<span class="br0">)</span> <span class="br0">{</span>
    s-&gt;kind = Square;
    s-&gt;shapeKindData.<span class="me1">squareData</span>.<span class="me1">side</span> = side;
<span class="br0">}</span>
 
<span class="coMULTI">/* and so on */</span>
</pre></div>
<p>As long as the union fields are only accessed through the functions, the accesses will be safe and correct. The same approach can be used for encoded tags; we simply decode the tag and then check it on each access. If the inefficiency of these tag checks is a concern, they may be automatically removed in the final version.</p>
<p>C and C++ also have language support for one particular tagged union: the possibly-null <a href="/wiki/Pointer" title="Pointer" class="mw-redirect">pointer</a>. This may be compared to the <code>option</code> type in ML or the <code>Maybe</code> type in Haskell, and can be seen as a <a href="/wiki/Tagged_pointer" title="Tagged pointer">tagged pointer</a>: a tagged union (with an encoded tag) of two types:</p>
<ul>
<li>Valid pointers,</li>
<li>A type with only one value, <code>null</code>, indicating an exceptional condition.</li>
</ul>
<p>Unfortunately, C compilers do not verify that the null case is always handled, and this is a particularly prevalent source of errors in C code, since there is a tendency to ignore exceptional cases.</p>
<p><a name="2000s" id="2000s"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=6" title="Edit section: 2000s">edit</a>]</span> <span class="mw-headline">2000s</span></h3>
<p>One advanced dialect of C called <a href="/wiki/Cyclone_programming_language" title="Cyclone programming language" class="mw-redirect">Cyclone</a> has extensive built-in support for tagged unions. See <a href="http://cyclone.thelanguage.org/wiki/Tagged%20Unions" class="external text" title="http://cyclone.thelanguage.org/wiki/Tagged%20Unions" rel="nofollow">the tagged union section of the on-line manual</a> for more information.</p>
<p><br />
The variant library from <a href="/wiki/Boost_C%2B%2B_Libraries" title="Boost C++ Libraries">Boost</a> has demonstrated it was possible to implement a safe tagged union as a library in C++, visitable using functors, a mechanism more or less equivalent to closures.</p>
<div dir="ltr" style="text-align: left;">
<pre class="source-cpp">
<span class="kw4">struct</span> display : boost::<span class="me2">static_visitor</span>&lt;void&gt;
<span class="br0">{</span>
    <span class="kw4">void</span> operator<span class="br0">(</span><span class="br0">)</span><span class="br0">(</span><span class="kw4">int</span> i<span class="br0">)</span>
    <span class="br0">{</span>
        std::<span class="kw3">cout</span> &lt;&lt; <span class="st0">"It's an int, with value "</span> &lt;&lt; i &lt;&lt; std::<span class="me2">endl</span>;
    <span class="br0">}</span>
 
    <span class="kw4">void</span> operator<span class="br0">(</span><span class="br0">)</span><span class="br0">(</span><span class="kw4">const</span> std::<span class="me2">string</span>&amp; s<span class="br0">)</span>
    <span class="br0">{</span>
        std::<span class="kw3">cout</span> &lt;&lt; <span class="st0">"It's a string, with value "</span> &lt;&lt; s &lt;&lt; std::<span class="me2">endl</span>;
    <span class="br0">}</span>
<span class="br0">}</span>;
 
boost::<span class="me2">variant</span>&lt;int, std::<span class="me2">string</span>&gt; v = <span class="nu0">42</span>;
boost::<span class="me2">apply_visitor</span><span class="br0">(</span>display<span class="br0">(</span><span class="br0">)</span>, v<span class="br0">)</span>;
 
boost::<span class="me2">variant</span>&lt;int, std::<span class="me2">string</span>&gt; v = <span class="st0">"hello world"</span>;
boost::<span class="me2">apply_visitor</span><span class="br0">(</span>display<span class="br0">(</span><span class="br0">)</span>, v<span class="br0">)</span>;
</pre></div>
<p><a name="Class_hierarchies_as_tagged_unions" id="Class_hierarchies_as_tagged_unions"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=7" title="Edit section: Class hierarchies as tagged unions">edit</a>]</span> <span class="mw-headline">Class hierarchies as tagged unions</span></h2>
<p>In a typical <a href="/wiki/Class_hierarchy" title="Class hierarchy">class hierarchy</a> in <a href="/wiki/Object-oriented_programming" title="Object-oriented programming">object-oriented programming</a>, each subclass can encapsulate data unique to that class. The metadata used to perform <a href="/wiki/Virtual_method" title="Virtual method" class="mw-redirect">virtual method</a> lookup (for example, the object's <a href="/wiki/Virtual_method_table" title="Virtual method table">vtable</a> pointer in most C++ implementations) identifies the subclass and so effectively acts as a tag identifying the particular data stored by the instance. An object's <a href="/wiki/Constructor_(computer_science)" title="Constructor (computer science)">constructor</a> sets this tag, and it remains constant throughout the object's lifetime.</p>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=8" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.boost.org/libs/variant/index.html" class="external text" title="http://www.boost.org/libs/variant/index.html" rel="nofollow">boost::variant</a> is a C++ typesafe discriminated union</li>
<li><a href="http://www.digitalmars.com/d/phobos/std_variant.html" class="external text" title="http://www.digitalmars.com/d/phobos/std_variant.html" rel="nofollow">std.variant</a> is an implementation of variant type in <a href="/wiki/D_(programming_language)" title="D (programming language)">D</a> 2.0</li>
</ul>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Tagged_union&amp;action=edit&amp;section=9" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/Discriminator" title="Discriminator">Discriminator</a></li>
</ul>


<!-- 
NewPP limit report
Preprocessor node count: 64/1000000
Post-expand include size: 0/2048000 bytes
Template argument size: 0/2048000 bytes
Expensive parser function count: 0/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:453395-0!1!0!default!!en!2 and timestamp 20090415225021 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/Tagged_union">http://en.wikipedia.org/wiki/Tagged_union</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Data_structures" title="Category:Data structures">Data structures</a></span> | <span dir='ltr'><a href="/wiki/Category:Data_types" title="Category:Data types">Data types</a></span> | <span dir='ltr'><a href="/wiki/Category:Type_theory" title="Category:Type theory">Type theory</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_example_Pascal_code" title="Category:Articles with example Pascal code">Articles with example Pascal code</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_example_ALGOL_68_code" title="Category:Articles with example ALGOL 68 code">Articles with example ALGOL 68 code</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_example_C_code" title="Category:Articles with example C code">Articles with example C code</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Tagged_union" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:Tagged_union" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=Tagged_union&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=Tagged_union&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Tagged_union" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Tagged_union" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Tagged_union" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=Tagged_union&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=Tagged_union&amp;oldid=265914577" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=Tagged_union&amp;id=265914577">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-pl"><a href="http://pl.wikipedia.org/wiki/Rekord_z_wariantami">Polski</a></li>
				<li class="interwiki-zh"><a href="http://zh.wikipedia.org/wiki/%E6%A0%87%E7%AD%BE%E8%81%94%E5%90%88">中文</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 23 January 2009, at 14:13 (UTC).</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv179 in 0.063 secs. --></body></html>
