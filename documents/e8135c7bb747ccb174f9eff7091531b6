<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="RC4,Articles with unsourced statements since January 2009,Articles with unsourced statements since March 2009,Crypto stream,Crypto navbox,1994,802.11,A5/1,A5/2,ASCII,Adi Shamir" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=RC4&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=RC4&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>RC4 - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "RC4";
		var wgTitle = "RC4";
		var wgAction = "view";
		var wgArticleId = "25831";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 281864906;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
<style type="text/css">/*<![CDATA[*/
.source-c {line-height: normal;}
.source-c li, .source-c pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for c
 * CSS class: source-c, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter)
 */
.source-c .de1, .source-c .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal;}
.source-c  {}
.source-c .head {}
.source-c .foot {}
.source-c .imp {font-weight: bold; color: red;}
.source-c .ln-xtra {color: #cc0; background-color: #ffc;}
.source-c li {font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;}
.source-c li.li2 {font-weight: bold;}
.source-c .kw1 {color: #b1b100;}
.source-c .kw2 {color: #000000; font-weight: bold;}
.source-c .kw3 {color: #000066;}
.source-c .kw4 {color: #993333;}
.source-c .co1 {color: #808080; font-style: italic;}
.source-c .co2 {color: #339933;}
.source-c .coMULTI {color: #808080; font-style: italic;}
.source-c .es0 {color: #000099; font-weight: bold;}
.source-c .br0 {color: #66cc66;}
.source-c .st0 {color: #ff0000;}
.source-c .nu0 {color: #cc66cc;}
.source-c .me1 {color: #202020;}
.source-c .me2 {color: #202020;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-perl {line-height: normal;}
.source-perl li, .source-perl pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for perl
 * CSS class: source-perl, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie (http://qbnz.com/highlighter)
 */
.source-perl .de1, .source-perl .de2 {font-family: 'Courier New', Courier, monospace; font-weight: normal;}
.source-perl  {}
.source-perl .head {}
.source-perl .foot {}
.source-perl .imp {font-weight: bold; color: red;}
.source-perl .ln-xtra {color: #cc0; background-color: #ffc;}
.source-perl li {font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;}
.source-perl li.li2 {font-weight: bold;}
.source-perl .kw1 {color: #b1b100;}
.source-perl .kw2 {color: #000000; font-weight: bold;}
.source-perl .kw3 {color: #000066;}
.source-perl .co1 {color: #808080; font-style: italic;}
.source-perl .coMULTI {color: #808080; font-style: italic;}
.source-perl .es0 {color: #000099; font-weight: bold;}
.source-perl .br0 {color: #66cc66;}
.source-perl .st0 {color: #ff0000;}
.source-perl .nu0 {color: #cc66cc;}
.source-perl .me1 {color: #006600;}
.source-perl .me2 {color: #006600;}
.source-perl .re0 {color: #0000ff;}
.source-perl .re4 {color: #009999;}

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/w/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=2678400";
/*]]>*/
</style>		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-RC4 skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">RC4</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<div class="dablink">For the Vietnam road named RC4, see <a href="/wiki/Battle_of_Route_Coloniale_4" title="Battle of Route Coloniale 4">Battle of Route Coloniale 4</a>.</div>
<table class="metadata plainlinks ambox ambox-content" style="">
<tr>
<td class="mbox-image">
<div style="width: 52px;"><a href="/wiki/File:Ambox_outdated_serious.svg" class="image" title="Ambox outdated serious.svg"><img alt="" src="http://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Ambox_outdated_serious.svg/40px-Ambox_outdated_serious.svg.png" width="40" height="40" border="0" /></a></div>
</td>
<td class="mbox-text" style="">This article <b>may need to be updated</b>. Please update this article to reflect recent events or newly available information, and remove this template when finished. Please see the <a href="/wiki/Talk:RC4" title="Talk:RC4">talk page</a> for more information.</td>
</tr>
</table>
<p>In <a href="/wiki/Cryptography" title="Cryptography">cryptography</a>, <b>RC4</b> (also known as <b>ARC4</b> or <b>ARCFOUR</b> meaning Alleged RC4, see below) is the most widely-used software <a href="/wiki/Stream_cipher" title="Stream cipher">stream cipher</a> and is used in popular protocols such as <a href="/wiki/Secure_Sockets_Layer" title="Secure Sockets Layer" class="mw-redirect">Secure Sockets Layer</a> (SSL) (to protect Internet traffic) and <a href="/wiki/Wired_Equivalent_Privacy" title="Wired Equivalent Privacy">WEP</a> (to secure wireless networks). While remarkable for its simplicity and speed in software, RC4 has weaknesses that argue against its use in new systems.<sup id="cite_ref-0" class="reference"><a href="#cite_note-0" title=""><span>[</span>1<span>]</span></a></sup> It is especially vulnerable when the beginning of the output <a href="/wiki/Keystream" title="Keystream">keystream</a> is not discarded, nonrandom or related keys are used, or a single keystream is used twice; some ways of using RC4 can lead to very insecure <a href="/wiki/Cryptosystem" title="Cryptosystem">cryptosystems</a> such as <a href="/wiki/Wired_Equivalent_Privacy" title="Wired Equivalent Privacy">WEP</a>.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#History"><span class="tocnumber">1</span> <span class="toctext">History</span></a></li>
<li class="toclevel-1"><a href="#Description"><span class="tocnumber">2</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2"><a href="#The_key-scheduling_algorithm_.28KSA.29"><span class="tocnumber">2.1</span> <span class="toctext">The key-scheduling algorithm (KSA)</span></a></li>
<li class="toclevel-2"><a href="#The_pseudo-random_generation_algorithm_.28PRGA.29"><span class="tocnumber">2.2</span> <span class="toctext">The pseudo-random generation algorithm (PRGA)</span></a></li>
<li class="toclevel-2"><a href="#Implementation"><span class="tocnumber">2.3</span> <span class="toctext">Implementation</span></a></li>
<li class="toclevel-2"><a href="#Test_vectors"><span class="tocnumber">2.4</span> <span class="toctext">Test vectors</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Security"><span class="tocnumber">3</span> <span class="toctext">Security</span></a>
<ul>
<li class="toclevel-2"><a href="#Biased_Outputs_of_the_RC4"><span class="tocnumber">3.1</span> <span class="toctext">Biased Outputs of the RC4</span></a></li>
<li class="toclevel-2"><a href="#Fluhrer.2C_Mantin_and_Shamir_attack"><span class="tocnumber">3.2</span> <span class="toctext">Fluhrer, Mantin and Shamir attack</span></a></li>
<li class="toclevel-2"><a href="#Klein.27s_Attack"><span class="tocnumber">3.3</span> <span class="toctext">Klein's Attack</span></a></li>
<li class="toclevel-2"><a href="#Combinatorial_problem"><span class="tocnumber">3.4</span> <span class="toctext">Combinatorial problem</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#RC4-based_cryptosystems"><span class="tocnumber">4</span> <span class="toctext">RC4-based cryptosystems</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">5</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">6</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">7</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="History" id="History"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=1" title="Edit section: History">edit</a>]</span> <span class="mw-headline">History</span></h2>
<p>RC4 was designed by <a href="/wiki/Ron_Rivest" title="Ron Rivest">Ron Rivest</a> of <a href="/wiki/RSA_Security" title="RSA Security">RSA Security</a> in 1987. While it is officially termed "Rivest Cipher 4", the RC acronym is alternatively understood to stand for "Ron's Code"<sup id="cite_ref-1" class="reference"><a href="#cite_note-1" title=""><span>[</span>2<span>]</span></a></sup> (see also <a href="/wiki/RC2" title="RC2">RC2</a>, <a href="/wiki/RC5" title="RC5">RC5</a> and <a href="/wiki/RC6" title="RC6">RC6</a>).</p>
<p>RC4 was initially a <a href="/wiki/Trade_secret" title="Trade secret">trade secret</a>, but in September 1994 a description of it was anonymously posted to the <a href="/wiki/Cypherpunks" title="Cypherpunks" class="mw-redirect">Cypherpunks</a> mailing list<sup id="cite_ref-2" class="reference"><a href="#cite_note-2" title=""><span>[</span>3<span>]</span></a></sup>. It was soon posted on the <a href="/wiki/Sci.crypt" title="Sci.crypt" class="mw-redirect">sci.crypt</a> newsgroup, and from there to many sites on the <a href="/wiki/Internet" title="Internet">Internet</a>. The leaked code was confirmed to be genuine as its output was found to match that of proprietary software using licensed RC4. Because the algorithm is known, it is no longer a <a href="/wiki/Trade_secret" title="Trade secret">trade secret</a>. The name "RC4" is <a href="/wiki/Trademark" title="Trademark">trademarked</a>, however. RC4 is often referred to as "ARCFOUR" or "ARC4" (meaning <b>A</b>lleged <b>RC4</b>, because <a href="/wiki/RSA_Security" title="RSA Security">RSA</a> has never officially released the algorithm), to avoid possible trademark problems. It has become part of some commonly used encryption protocols and standards, including <a href="/wiki/Wired_Equivalent_Privacy" title="Wired Equivalent Privacy">WEP</a> and <a href="/wiki/Wi-Fi_Protected_Access" title="Wi-Fi Protected Access">WPA</a> for wireless cards and <a href="/wiki/Transport_Layer_Security" title="Transport Layer Security">TLS</a>.</p>
<p>The main factors which helped its deployment over such a wide range of applications consisted in its impressive speed and simplicity. Implementations in both software and hardware are very easy to develop.</p>
<p><a name="Description" id="Description"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=2" title="Edit section: Description">edit</a>]</span> <span class="mw-headline">Description</span></h2>
<p>RC4 generates a <a href="/wiki/Pseudo-random_number_generator" title="Pseudo-random number generator" class="mw-redirect">pseudorandom stream of bits</a> (a <a href="/wiki/Keystream" title="Keystream">keystream</a>) which, for encryption, is combined with the plaintext using bit-wise <a href="/wiki/Exclusive_or" title="Exclusive or">exclusive-or</a>; decryption is performed the same way (since exclusive-or is a symmetric operation). (This is similar to the <a href="/wiki/Vernam_cipher" title="Vernam cipher" class="mw-redirect">Vernam cipher</a> except that <em>pseudorandom bits</em>, rather than <em>random bits</em>, are used.) To generate the keystream, the cipher makes use of a secret internal state which consists of two parts:</p>
<ol>
<li>A <a href="/wiki/Permutation" title="Permutation">permutation</a> of all 256 possible <a href="/wiki/Bytes" title="Bytes" class="mw-redirect">bytes</a> (denoted "S" below).</li>
<li>Two 8-bit index-pointers (denoted "i" and "j").</li>
</ol>
<p>The permutation is initialized with a variable length <a href="/wiki/Key_(cryptography)" title="Key (cryptography)">key</a>, typically between 40 and 256 bits, using the <i><a href="/wiki/Key_schedule" title="Key schedule">key-scheduling</a></i> algorithm (KSA). Once this has been completed, the stream of bits is generated using the <i>pseudo-random generation algorithm</i> (PRGA).</p>
<p><a name="The_key-scheduling_algorithm_.28KSA.29" id="The_key-scheduling_algorithm_.28KSA.29"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=3" title="Edit section: The key-scheduling algorithm (KSA)">edit</a>]</span> <span class="mw-headline">The key-scheduling algorithm (KSA)</span></h3>
<p>The <a href="/wiki/Key_schedule" title="Key schedule">key-scheduling</a> algorithm is used to initialize the permutation in the array "S". "keylength" is defined as the number of bytes in the key and can be in the range 1 ≤ keylength ≤ 256, typically between 5 and 16, corresponding to a <a href="/wiki/Key_length" title="Key length" class="mw-redirect">key length</a> of 40 – 128 bits. First, the array "S" is initialized to the <a href="/wiki/Identity_(mathematics)" title="Identity (mathematics)">identity permutation</a>. S is then processed for 256 iterations in a similar way to the main PRGA algorithm, but also mixes in bytes of the key at the same time.</p>
<pre>
<b>for</b> i <b>from</b> 0 <b>to</b> 255
    S[i] := i
<b>endfor</b>
j := 0
<b>for</b> i <b>from</b> 0 <b>to</b> 255
    j := (j + S[i] + key[i <a href="/wiki/Modulo_operation" title="Modulo operation">mod</a> keylength]) mod 256
    swap(S[i],S[j])
<b>endfor</b>
</pre>
<p><a name="The_pseudo-random_generation_algorithm_.28PRGA.29" id="The_pseudo-random_generation_algorithm_.28PRGA.29"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=4" title="Edit section: The pseudo-random generation algorithm (PRGA)">edit</a>]</span> <span class="mw-headline">The pseudo-random generation algorithm (PRGA)</span></h3>
<div class="thumb tright">
<div class="thumbinner" style="width:322px;"><a href="/wiki/File:RC4.svg" class="image" title="The lookup stage of RC4. The output byte is selected by looking up the values of S(i) and S(j), adding them together modulo 256, and then looking up the sum in S; S(S(i) + S(j)) is used as a byte of the key stream, K."><img alt="" src="http://upload.wikimedia.org/wikipedia/commons/thumb/e/e9/RC4.svg/320px-RC4.svg.png" width="320" height="143" border="0" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify"><a href="/wiki/File:RC4.svg" class="internal" title="Enlarge"><img src="/skins-1.5/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
The lookup stage of RC4. The output byte is selected by looking up the values of S(i) and S(j), adding them together modulo 256, and then looking up the sum in S; S(S(i) + S(j)) is used as a byte of the key stream, K.</div>
</div>
</div>
<p>For as many iterations as are needed, the PRGA modifies the state and outputs a byte of the keystream. In each iteration, the PRGA increments <i>i</i>, adds the value of S pointed to by <i>i</i> to <i>j</i>, exchanges the values of S[<i>i</i>] and S[<i>j</i>], and then outputs the value of S at the location S[i] + S[j] (modulo 256). Each value of S is swapped at least once every 256 iterations.</p>
<pre>
i := 0
j := 0
<b>while</b> GeneratingOutput:
    i := (i + 1) mod 256
    j := (j + S[i]) mod 256
    swap(S[i],S[j])
    output S[(S[i] + S[j]) mod 256]
<b>endwhile</b>
</pre>
<p><a name="Implementation" id="Implementation"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=5" title="Edit section: Implementation">edit</a>]</span> <span class="mw-headline">Implementation</span></h3>
<p>Many stream ciphers are based on <a href="/wiki/Linear_feedback_shift_register" title="Linear feedback shift register">linear feedback shift registers</a> (LFSRs), which while efficient in hardware are less so in software. The design of RC4 avoids the use of LFSRs, and is ideal for software implementation, as it requires only byte manipulations. It uses 256 bytes of memory for the state array, S[0] through S[255], k bytes of memory for the key, key[0] through key[k-1], and integer variables, i, j, and k. Performing a <i>modulus 256</i> can be done with a <a href="/wiki/Bitwise_AND" title="Bitwise AND" class="mw-redirect">bitwise AND</a> with 255 (or on most platforms, simple addition of bytes ignoring overflow).</p>
<p>Here is a simple implementation in <a href="/wiki/C_(programming_language)" title="C (programming language)">C</a>:</p>
<div dir="ltr" style="text-align: left;">
<pre class="source-c">
<span class="kw4">unsigned</span> <span class="kw4">char</span> S<span class="br0">[</span><span class="nu0">256</span><span class="br0">]</span>;
<span class="kw4">unsigned</span> <span class="kw4">int</span> i, j;
 
<span class="coMULTI">/* KSA */</span>
<span class="kw4">void</span> rc4_init<span class="br0">(</span><span class="kw4">unsigned</span> <span class="kw4">char</span> *key, <span class="kw4">unsigned</span> <span class="kw4">int</span> key_length<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span> <span class="br0">(</span>i = <span class="nu0">0</span>; i &lt; <span class="nu0">256</span>; i++<span class="br0">)</span>
        S<span class="br0">[</span>i<span class="br0">]</span> = i;
 
    <span class="kw1">for</span> <span class="br0">(</span>i = j = <span class="nu0">0</span>; i &lt; <span class="nu0">256</span>; i++<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw4">unsigned</span> <span class="kw4">char</span> temp;
 
        j = <span class="br0">(</span>j + key<span class="br0">[</span>i % key_length<span class="br0">]</span> + S<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span> &amp; <span class="nu0">255</span>;
        temp = S<span class="br0">[</span>i<span class="br0">]</span>;
        S<span class="br0">[</span>i<span class="br0">]</span> = S<span class="br0">[</span>j<span class="br0">]</span>;
        S<span class="br0">[</span>j<span class="br0">]</span> = temp;
    <span class="br0">}</span>
 
    i = j = <span class="nu0">0</span>;
<span class="br0">}</span>
 
<span class="coMULTI">/* PRGA */</span>
<span class="kw4">unsigned</span> <span class="kw4">char</span> rc4_output<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw4">unsigned</span> <span class="kw4">char</span> temp;
 
    i = <span class="br0">(</span>i + <span class="nu0">1</span><span class="br0">)</span> &amp; <span class="nu0">255</span>;
    j = <span class="br0">(</span>j + S<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span> &amp; <span class="nu0">255</span>;
 
    temp = S<span class="br0">[</span>j<span class="br0">]</span>;
    S<span class="br0">[</span>j<span class="br0">]</span> = S<span class="br0">[</span>i<span class="br0">]</span>;
    S<span class="br0">[</span>i<span class="br0">]</span> = temp;
 
    <span class="kw1">return</span> S<span class="br0">[</span><span class="br0">(</span>temp + S<span class="br0">[</span>j<span class="br0">]</span><span class="br0">)</span> &amp; <span class="nu0">255</span><span class="br0">]</span>;
<span class="br0">}</span>
 
<span class="co2">#include &lt;stdio.h&gt;</span>
<span class="co2">#include &lt;string.h&gt;</span>
<span class="co2">#include &lt;stdlib.h&gt;</span>
 
<span class="kw4">int</span> main<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw4">unsigned</span> <span class="kw4">char</span> test_vectors<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">32</span><span class="br0">]</span> = 
    <span class="br0">{</span>
        <span class="br0">{</span><span class="st0">"Key"</span>, <span class="st0">"Plaintext"</span><span class="br0">}</span>,
        <span class="br0">{</span><span class="st0">"Wiki"</span>, <span class="st0">"pedia"</span><span class="br0">}</span>,
        <span class="br0">{</span><span class="st0">"Secret"</span>, <span class="st0">"Attack at dawn"</span><span class="br0">}</span>
    <span class="br0">}</span>;
 
    <span class="kw4">int</span> x;
    <span class="kw1">for</span> <span class="br0">(</span>x = <span class="nu0">0</span>; x &lt; <span class="nu0">3</span>; x++<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw4">int</span> y;
        rc4_init<span class="br0">(</span>test_vectors<span class="br0">[</span>x<span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>, strlen<span class="br0">(</span><span class="br0">(</span><span class="kw4">char</span>*<span class="br0">)</span>test_vectors<span class="br0">[</span>x<span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>;
 
        <span class="kw1">for</span> <span class="br0">(</span>y = <span class="nu0">0</span>; y &lt; strlen<span class="br0">(</span><span class="br0">(</span><span class="kw4">char</span>*<span class="br0">)</span>test_vectors<span class="br0">[</span>x<span class="br0">]</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span>; y++<span class="br0">)</span>
            <span class="kw3">printf</span><span class="br0">(</span><span class="st0">"%02X"</span>, test_vectors<span class="br0">[</span>x<span class="br0">]</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>y<span class="br0">]</span> ^ rc4_output<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>;
        <span class="kw3">printf</span><span class="br0">(</span><span class="st0">"<span class="es0">\n</span>"</span><span class="br0">)</span>;
    <span class="br0">}</span>
    <span class="kw1">return</span> <span class="nu0">0</span>;
<span class="br0">}</span>
</pre></div>
<p>Here is a simple implementation in <a href="/wiki/Perl_5" title="Perl 5" class="mw-redirect">Perl 5</a>:</p>
<div dir="ltr" style="text-align: left;">
<pre class="source-perl">
<span class="kw2">use</span> strict;
<span class="kw2">use</span> warnings <span class="st0">'all'</span>;
 
<span class="co1"># key-scheduling algorithm</span>
<span class="kw2">sub</span> rc4_init <span class="br0">{</span>
    <span class="kw1">my</span> <span class="br0">(</span> <span class="re0">$key</span> <span class="br0">)</span> = <span class="re0">@_</span>;
 
    <span class="co1"># Make an array of the bytes in the key</span>
    <span class="kw1">my</span> <span class="re0">@key</span> = <span class="kw3">unpack</span> <span class="st0">'C*'</span>, <span class="re0">$key</span>;
 
    <span class="co1"># Initialize to the identity permutation</span>
    <span class="kw1">my</span> <span class="re0">@S</span> = <span class="nu0">0</span>..<span class="nu0">255</span>;
 
    <span class="kw1">my</span> <span class="re0">$y</span> = <span class="nu0">0</span>;
 
    <span class="kw1">for</span> <span class="kw1">my</span> <span class="re0">$x</span> <span class="br0">(</span> <span class="nu0">0</span>..<span class="nu0">255</span> <span class="br0">)</span> <span class="br0">{</span>
        <span class="re0">$y</span> = <span class="br0">(</span> <span class="re0">$y</span> + <span class="re0">$S</span><span class="br0">[</span> <span class="re0">$x</span> <span class="br0">]</span> + <span class="re0">$key</span><span class="br0">[</span> <span class="re0">$x</span> % <span class="re0">@key</span> <span class="br0">]</span> <span class="br0">)</span> % <span class="nu0">256</span>;
        <span class="re0">@S</span><span class="br0">[</span><span class="re0">$x</span>,<span class="re0">$y</span><span class="br0">]</span> = <span class="re0">@S</span><span class="br0">[</span><span class="re0">$y</span>,<span class="re0">$x</span><span class="br0">]</span>;
    <span class="br0">}</span>
 
    <span class="kw3">return</span> <span class="re0">@S</span>;
<span class="br0">}</span>
 
<span class="co1"># pseudo-random generation algorithm</span>
<span class="kw2">sub</span> rc4_output <span class="br0">{</span>
    <span class="kw1">my</span> <span class="br0">(</span> <span class="re0">$S_ref</span>, <span class="re0">$i_ref</span>, <span class="re0">$j_ref</span> <span class="br0">)</span> = <span class="re0">@_</span>;
 
    <span class="kw1">my</span> <span class="re0">@S</span> = @<span class="br0">{</span> <span class="re0">$S_ref</span> <span class="br0">}</span>;
 
    <span class="re0">$$i_ref</span> = <span class="br0">(</span><span class="re0">$$i_ref</span> + <span class="nu0">1</span><span class="br0">)</span> % <span class="nu0">256</span>;
    <span class="re0">$$j_ref</span> = <span class="br0">(</span><span class="re0">$$j_ref</span> + <span class="re0">$S</span><span class="br0">[</span><span class="re0">$$i_ref</span><span class="br0">]</span><span class="br0">)</span> % <span class="nu0">256</span>;
 
    <span class="re0">@S</span><span class="br0">[</span><span class="re0">$$i_ref</span>,<span class="re0">$$j_ref</span><span class="br0">]</span> = <span class="re0">@S</span><span class="br0">[</span><span class="re0">$$j_ref</span>,<span class="re0">$$i_ref</span><span class="br0">]</span>;
 
 
    <span class="re0">$S_ref</span> = \<span class="re0">@S</span>;
 
    <span class="kw3">return</span> <span class="re0">$S</span><span class="br0">[</span> <span class="br0">(</span> <span class="re0">$S</span><span class="br0">[</span><span class="re0">$$i_ref</span><span class="br0">]</span> + <span class="re0">$S</span><span class="br0">[</span><span class="re0">$$j_ref</span><span class="br0">]</span> <span class="br0">)</span> % <span class="nu0">256</span> <span class="br0">]</span>;
<span class="br0">}</span>
 
<span class="co1"># Bug found with previous implementation in the line: `@S[$$i_ref,$$j_ref] = @S[$$j_ref,$$i_ref];`,</span>
<span class="co1"># In some cases that exchange take incorrect value by index.. i don't know why..</span>
<span class="co1"># kosyak &lt;kosyak_ua@yahoo.com&gt;</span>
<span class="co1"># my rc4_output is:</span>
<span class="kw2">sub</span> rc4_output2 <span class="br0">{</span>
 
    <span class="kw1">my</span> <span class="br0">(</span> <span class="re0">$S_ref</span>, <span class="re0">$i_ref</span>, <span class="re0">$j_ref</span> <span class="br0">)</span> = <span class="re0">@_</span>;
 
    <span class="re0">$$i_ref</span> = <span class="br0">(</span><span class="re0">$$i_ref</span> + <span class="nu0">1</span><span class="br0">)</span> &amp; 0xff;                                                                                           
    <span class="re0">$$j_ref</span> = <span class="br0">(</span><span class="re0">$$j_ref</span> + <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$i_ref</span><span class="br0">]</span><span class="br0">)</span> &amp; 0xff;
 
    <span class="kw1">my</span> <span class="re0">$tmp</span> = <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$i_ref</span><span class="br0">]</span>;
    <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$i_ref</span><span class="br0">]</span> = <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$j_ref</span><span class="br0">]</span>;
    <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$j_ref</span><span class="br0">]</span> = <span class="re0">$tmp</span>;
 
    <span class="kw3">return</span> <span class="re0">$$S_ref</span><span class="br0">[</span> <span class="br0">(</span> <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$i_ref</span><span class="br0">]</span> + <span class="re0">$$S_ref</span><span class="br0">[</span><span class="re0">$$j_ref</span><span class="br0">]</span> <span class="br0">)</span> &amp; 0xff <span class="br0">]</span>;
<span class="br0">}</span>
 
<span class="kw1">my</span> <span class="re0">@test_vectors</span> = <span class="br0">(</span>
    <span class="br0">[</span> <span class="st0">'Key'</span>, <span class="st0">'Plaintext'</span> <span class="br0">]</span>,
    <span class="br0">[</span> <span class="st0">'Wiki'</span>, <span class="st0">'pedia'</span> <span class="br0">]</span>,
    <span class="br0">[</span> <span class="st0">'Secret'</span>, <span class="st0">'Attack at dawn'</span> <span class="br0">]</span>,
<span class="br0">)</span>;
 
<span class="kw1">for</span> <span class="kw1">my</span> <span class="re0">$test</span> <span class="br0">(</span> <span class="re0">@test_vectors</span> <span class="br0">)</span> <span class="br0">{</span>
    <span class="co1"># Get the initialized state</span>
    <span class="kw1">my</span> <span class="re0">@S</span> = rc4_init<span class="br0">(</span> <span class="re0">$test</span>-&gt;<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="br0">)</span>;
    <span class="kw1">my</span> <span class="re0">$i</span> = <span class="nu0">0</span>;
    <span class="kw1">my</span> <span class="re0">$j</span> = <span class="nu0">0</span>;
 
    <span class="kw1">for</span> <span class="kw1">my</span> <span class="re0">$byte</span> <span class="br0">(</span> <span class="kw3">unpack</span><span class="br0">(</span> <span class="st0">'C*'</span>, <span class="re0">$test</span>-&gt;<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span> <span class="br0">)</span> <span class="br0">)</span> <span class="br0">{</span>
        <span class="kw3">printf</span> <span class="st0">'%02X'</span>, <span class="re0">$byte</span> ^ rc4_output<span class="br0">(</span> \<span class="re0">@S</span>, \<span class="re0">$i</span>, \<span class="re0">$j</span> <span class="br0">)</span>;
    <span class="br0">}</span>
    <span class="kw3">print</span> <span class="st0">"<span class="es0">\n</span>"</span>;
<span class="br0">}</span>
</pre></div>
<p><a name="Test_vectors" id="Test_vectors"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=6" title="Edit section: Test vectors">edit</a>]</span> <span class="mw-headline">Test vectors</span></h3>
<table class="metadata plainlinks ambox ambox-content" style="">
<tr>
<td class="mbox-image">
<div style="width: 52px;"><a href="/wiki/File:Ambox_content.png" class="image" title="Ambox content.png"><img alt="" src="http://upload.wikimedia.org/wikipedia/en/f/f4/Ambox_content.png" width="40" height="40" border="0" /></a></div>
</td>
<td class="mbox-text" style="">This section <b>may contain <a href="/wiki/Wikipedia:No_original_research" title="Wikipedia:No original research">original research</a> or <a href="/wiki/Wikipedia:Verifiability" title="Wikipedia:Verifiability">unverified claims</a></b>. Please <a href="http://en.wikipedia.org/w/index.php?title=RC4&amp;action=edit" class="external text" title="http://en.wikipedia.org/w/index.php?title=RC4&amp;action=edit" rel="nofollow">improve the article</a> by adding <a href="/wiki/Wikipedia:References" title="Wikipedia:References" class="mw-redirect">references</a>. See the <a href="/wiki/Talk:RC4" title="Talk:RC4">talk page</a> for details. <small><i>(February 2009)</i></small></td>
</tr>
</table>
<p>These test vectors are not official, but convenient for anyone testing their own RC4 program. The keys and plaintext are <a href="/wiki/ASCII" title="ASCII">ASCII</a>, the ciphertext is in <a href="/wiki/Hexadecimal" title="Hexadecimal">hexadecimal</a>.</p>
<table class="wikitable">
<tr>
<th>Key</th>
<th>Plaintext</th>
<th>Ciphertext</th>
</tr>
<tr>
<td>
<pre>
Key
</pre></td>
<td>
<pre>
Plaintext
</pre></td>
<td>
<pre>
BBF316E8D940AF0AD3
</pre></td>
</tr>
<tr>
<td>
<pre>
Wiki
</pre></td>
<td>
<pre>
pedia
</pre></td>
<td>
<pre>
1021BF0420
</pre></td>
</tr>
<tr>
<td>
<pre>
Secret
</pre></td>
<td>
<pre>
Attack at dawn
</pre></td>
<td>
<pre>
45A01F645FC35B383552544B9BF5
</pre></td>
</tr>
</table>
<p><a name="Security" id="Security"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=7" title="Edit section: Security">edit</a>]</span> <span class="mw-headline">Security</span></h2>
<p>RC4 falls short of the standards set by cryptographers for a secure cipher in several ways, and thus is not recommended for use in new applications<sup class="noprint Template-Fact"><span title="This claim needs references to reliable sources&#160;since January 2009" style="white-space: nowrap;">[<i><a href="/wiki/Wikipedia:Citation_needed" title="Wikipedia:Citation needed">citation needed</a></i>]</span></sup>.</p>
<p>Unlike a modern stream cipher (such as those in <a href="/wiki/ESTREAM" title="ESTREAM">eSTREAM</a>), RC4 does not take a separate <a href="/wiki/Cryptographic_nonce" title="Cryptographic nonce">nonce</a> alongside the key. This means that if a single long-term key is to be used to securely encrypt multiple streams, the cryptosystem must specify how to combine the nonce and the long-term key to generate the stream key for RC4. One approach to addressing this is to generate a "fresh" RC4 key by <a href="/wiki/Cryptographic_hash_function" title="Cryptographic hash function">hashing</a> a long-term key with a <a href="/wiki/Cryptographic_nonce" title="Cryptographic nonce">nonce</a>. However, many applications that use RC4 simply concatenate key and nonce; RC4's weak <a href="/wiki/Key_schedule" title="Key schedule">key schedule</a> then gives rise to a variety of serious problems.</p>
<p><a name="Biased_Outputs_of_the_RC4" id="Biased_Outputs_of_the_RC4"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=8" title="Edit section: Biased Outputs of the RC4">edit</a>]</span> <span class="mw-headline">Biased Outputs of the RC4</span></h3>
<p>The keystream generated by the RC4 is biased in varying degrees towards certain sequences. The best such attack is due to Itsik Mantin and <a href="/wiki/Adi_Shamir" title="Adi Shamir">Adi Shamir</a> who showed that the second output byte of the cipher was biased toward zero with probability 1/128 (instead of 1/256). This is due to the fact that if the third byte of the original state is zero, and the second byte is not equal to 2, then the second output byte is always zero. Such bias can be detected by observing only 256 bytes.<sup id="cite_ref-3" class="reference"><a href="#cite_note-3" title=""><span>[</span>4<span>]</span></a></sup></p>
<p><a href="/wiki/Souradyuti_Paul" title="Souradyuti Paul">Souradyuti Paul</a> and <a href="/wiki/Bart_Preneel" title="Bart Preneel">Bart Preneel</a> of <a href="/wiki/COSIC" title="COSIC">COSIC</a> showed that the first and the second bytes of the RC4 were also biased. The number of required samples to detect this bias is 2<sup>25</sup> bytes.<sup id="cite_ref-4" class="reference"><a href="#cite_note-4" title=""><span>[</span>5<span>]</span></a></sup></p>
<p><a href="/w/index.php?title=Scott_Fluhrer&amp;action=edit&amp;redlink=1" class="new" title="Scott Fluhrer (page does not exist)">Fluhrer</a> and <a href="/w/index.php?title=David_McGrew&amp;action=edit&amp;redlink=1" class="new" title="David McGrew (page does not exist)">McGrew</a> also showed such attacks which distinguished the keystream of the RC4 from a random stream given a gigabyte of output.<sup id="cite_ref-5" class="reference"><a href="#cite_note-5" title=""><span>[</span>6<span>]</span></a></sup></p>
<p><a name="Fluhrer.2C_Mantin_and_Shamir_attack" id="Fluhrer.2C_Mantin_and_Shamir_attack"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=9" title="Edit section: Fluhrer, Mantin and Shamir attack">edit</a>]</span> <span class="mw-headline">Fluhrer, Mantin and Shamir attack</span></h3>
<div class="rellink noprint relarticle mainarticle">Main article: <a href="/wiki/Fluhrer,_Mantin,_and_Shamir_attack" title="Fluhrer, Mantin, and Shamir attack">Fluhrer, Mantin, and Shamir attack</a></div>
<p>In 2001, a new and surprising discovery was made by <a href="/w/index.php?title=Scott_Fluhrer&amp;action=edit&amp;redlink=1" class="new" title="Scott Fluhrer (page does not exist)">Fluhrer</a>, <a href="/w/index.php?title=Itsik_Mantin&amp;action=edit&amp;redlink=1" class="new" title="Itsik Mantin (page does not exist)">Mantin</a> and <a href="/wiki/Adi_Shamir" title="Adi Shamir">Shamir</a>: over all possible RC4 keys, the statistics for the first few bytes of output keystream are strongly non-random, leaking information about the key. If the long-term key and nonce are simply concatenated to generate the RC4 key, this long-term key can be discovered by analysing a large number of messages encrypted with this key.<sup id="cite_ref-6" class="reference"><a href="#cite_note-6" title=""><span>[</span>7<span>]</span></a></sup> This and related effects were then used to break the <a href="/wiki/Wired_Equivalent_Privacy" title="Wired Equivalent Privacy">WEP</a> ("wired equivalent privacy") encryption used with <a href="/wiki/802.11" title="802.11" class="mw-redirect">802.11</a> <a href="/wiki/Wireless_network" title="Wireless network">wireless networks</a>. This caused a scramble for a standards-based replacement for WEP in the 802.11 market, and led to the <a href="/wiki/IEEE_802.11i" title="IEEE 802.11i" class="mw-redirect">IEEE 802.11i</a> effort and <a href="/wiki/Wi-Fi_Protected_Access" title="Wi-Fi Protected Access">WPA</a>.<sup class="noprint Template-Fact"><span title="This claim needs references to reliable sources&#160;since March 2009" style="white-space: nowrap;">[<i><a href="/wiki/Wikipedia:Citation_needed" title="Wikipedia:Citation needed">citation needed</a></i>]</span></sup></p>
<p>Cryptosystems can defend against this attack by discarding the initial portion of the keystream. Such a modified algorithm is traditionally called "RC4-drop[n]", where n is the number of initial keystream bytes that are dropped. The SCAN default is n = 768 bytes, but a conservative value would be n = 3072 bytes. <sup id="cite_ref-7" class="reference"><a href="#cite_note-7" title=""><span>[</span>8<span>]</span></a></sup></p>
<p><a name="Klein.27s_Attack" id="Klein.27s_Attack"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=10" title="Edit section: Klein's Attack">edit</a>]</span> <span class="mw-headline">Klein's Attack</span></h3>
<p>In 2005, Andreas Klein presented an analysis of the RC4 stream cipher showing more correlations between the RC4 keystream and the key.<sup class="noprint Template-Fact"><span title="This claim needs references to reliable sources&#160;since March 2009" style="white-space: nowrap;">[<i><a href="/wiki/Wikipedia:Citation_needed" title="Wikipedia:Citation needed">citation needed</a></i>]</span></sup> <a href="/w/index.php?title=Erik_Tews&amp;action=edit&amp;redlink=1" class="new" title="Erik Tews (page does not exist)">Erik Tews</a>, <a href="/w/index.php?title=Ralf-Philipp_Weinmann&amp;action=edit&amp;redlink=1" class="new" title="Ralf-Philipp Weinmann (page does not exist)">Ralf-Philipp Weinmann</a>, and <a href="/w/index.php?title=Andrei_Pyshkin&amp;action=edit&amp;redlink=1" class="new" title="Andrei Pyshkin (page does not exist)">Andrei Pyshkin</a> used this analysis to create aircrack-ptw, a tool which cracks 104-bit RC4 used in 128-bit WEP in under a minute<sup id="cite_ref-8" class="reference"><a href="#cite_note-8" title=""><span>[</span>9<span>]</span></a></sup> Whereas the Fluhrer, Mantin, and Shamir attack used around 10 million messages, aircrack-ptw can break 104-bit keys in 40,000 frames with 50% probability, or in 85,000 frames with 95% probability.</p>
<p><a name="Combinatorial_problem" id="Combinatorial_problem"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=11" title="Edit section: Combinatorial problem">edit</a>]</span> <span class="mw-headline">Combinatorial problem</span></h3>
<p>A combinatorial problem related to the number of inputs and outputs of the RC4 cipher was first posed by <a href="/w/index.php?title=Itsik_Mantin&amp;action=edit&amp;redlink=1" class="new" title="Itsik Mantin (page does not exist)">Itsik Mantin</a> and <a href="/wiki/Adi_Shamir" title="Adi Shamir">Adi Shamir</a> in 2001, whereby, of the total 256 elements in the typical state of RC4, if <i>x</i> number of elements (<i>x</i> ≤ 256) are <i>only</i> known (all other elements can be assumed empty), then the maximum number of elements that can be produced deterministically is also <i>x</i> in the next 256 rounds. This conjecture was put to rest in 2004 with a formal proof given by <a href="/wiki/Souradyuti_Paul" title="Souradyuti Paul">Souradyuti Paul</a> and <a href="/wiki/Bart_Preneel" title="Bart Preneel">Bart Preneel</a>.<sup id="cite_ref-9" class="reference"><a href="#cite_note-9" title=""><span>[</span>10<span>]</span></a></sup></p>
<p><a name="RC4-based_cryptosystems" id="RC4-based_cryptosystems"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=12" title="Edit section: RC4-based cryptosystems">edit</a>]</span> <span class="mw-headline">RC4-based cryptosystems</span></h2>
<ul>
<li><a href="/wiki/Wired_Equivalent_Privacy" title="Wired Equivalent Privacy">WEP</a></li>
<li><a href="/wiki/Wi-Fi_Protected_Access" title="Wi-Fi Protected Access">WPA</a> (optionally)</li>
<li><a href="/wiki/BitTorrent_protocol_encryption" title="BitTorrent protocol encryption">BitTorrent protocol encryption</a></li>
<li><a href="/wiki/MPPE" title="MPPE" class="mw-redirect">Microsoft Point-to-Point Encryption</a></li>
<li><a href="/wiki/Secure_Sockets_Layer" title="Secure Sockets Layer" class="mw-redirect">Secure Sockets Layer</a> (optionally)</li>
<li><a href="/wiki/Secure_shell" title="Secure shell" class="mw-redirect">Secure shell</a> (optionally)</li>
<li><a href="/wiki/Remote_Desktop_Protocol" title="Remote Desktop Protocol">Remote Desktop Protocol</a></li>
<li><a href="/wiki/Kerberos_(protocol)" title="Kerberos (protocol)">Kerberos</a> (optionally)</li>
<li><a href="/wiki/Simple_Authentication_and_Security_Layer" title="Simple Authentication and Security Layer">SASL</a> Mechanism Digest-MD5 (optionally)</li>
<li><a href="/w/index.php?title=Gpcode.AK&amp;action=edit&amp;redlink=1" class="new" title="Gpcode.AK (page does not exist)">Gpcode.AK</a>, an early June 2008 computer virus for Microsoft Windows, which takes documents hostage for <a href="/wiki/Ransom" title="Ransom">ransom</a> by obscuring them with RC4 and RSA-1024 encryption</li>
<li><a href="/wiki/Portable_Document_Format" title="Portable Document Format">PDF</a></li>
</ul>
<p>Where a cryptosystem is marked with "(optionally)", RC4 is one of several ciphers the system can be configured to use.</p>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=13" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/ESTREAM" title="ESTREAM">eSTREAM</a> - An evaluation of new <a href="/wiki/Stream_cipher" title="Stream cipher">stream ciphers</a> being conducted by the EU.</li>
<li><a href="/wiki/Tiny_Encryption_Algorithm" title="Tiny Encryption Algorithm">TEA</a>, <a href="/wiki/XTEA" title="XTEA">Block TEA</a> also known as <a href="/wiki/XTEA" title="XTEA">eXtended TEA</a> and <a href="/wiki/XXTEA" title="XXTEA">Corrected Block TEA</a> - A family of <a href="/wiki/Block_cipher" title="Block cipher">block ciphers</a> that, like RC4, are designed to be very simple to implement.</li>
<li><a href="/wiki/Advanced_Encryption_Standard" title="Advanced Encryption Standard">Advanced Encryption Standard</a></li>
<li><a href="/wiki/CipherSaber" title="CipherSaber">CipherSaber</a></li>
</ul>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=14" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ol class="references">
<li id="cite_note-0"><b><a href="#cite_ref-0" title="">^</a></b> "<a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html" class="external text" title="http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html" rel="nofollow">RC4 Page</a>" lists some of the biases</li>
<li id="cite_note-1"><b><a href="#cite_ref-1" title="">^</a></b> <a href="http://people.csail.mit.edu/rivest/faq.html#Ron" class="external text" title="http://people.csail.mit.edu/rivest/faq.html#Ron" rel="nofollow">Rivest FAQ</a></li>
<li id="cite_note-2"><b><a href="#cite_ref-2" title="">^</a></b> <cite style="font-style:normal" class="web"><a href="http://cypherpunks.venona.com/date/1994/09/msg00304.html" class="external text" title="http://cypherpunks.venona.com/date/1994/09/msg00304.html" rel="nofollow">"Thank you Bob Anderson"</a>. <i><a href="/wiki/Cypherpunks" title="Cypherpunks" class="mw-redirect">Cypherpunks</a> mailing list</i>. <span class="mw-formatted-date" title="1994-09-09"><a href="/wiki/1994" title="1994">1994</a>-<a href="/wiki/September_9" title="September 9">09-09</a></span><span class="printonly">. <a href="http://cypherpunks.venona.com/date/1994/09/msg00304.html" class="external free" title="http://cypherpunks.venona.com/date/1994/09/msg00304.html" rel="nofollow">http://cypherpunks.venona.com/date/1994/09/msg00304.html</a></span><span class="reference-accessdate">. Retrieved on 2007-05-28</span>.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=bookitem&amp;rft.btitle=Thank+you+Bob+Anderson&amp;rft.atitle=%5B%5BCypherpunks%5D%5D+mailing+list&amp;rft.date=%5B%5B1994-09-09%5D%5D&amp;rft_id=http%3A%2F%2Fcypherpunks.venona.com%2Fdate%2F1994%2F09%2Fmsg00304.html&amp;rfr_id=info:sid/en.wikipedia.org:RC4"><span style="display: none;">&#160;</span></span></li>
<li id="cite_note-3"><b><a href="#cite_ref-3" title="">^</a></b> Itsik Mantin and <a href="/wiki/Adi_Shamir" title="Adi Shamir">Adi Shamir</a>, A Practical Attack on Broadcast RC4. FSE 2001, pp152 – 164 <a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/bc_rc4.ps" class="external text" title="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/bc_rc4.ps" rel="nofollow">(PS)</a>.</li>
<li id="cite_note-4"><b><a href="#cite_ref-4" title="">^</a></b> <a href="/wiki/Souradyuti_Paul" title="Souradyuti Paul">Souradyuti Paul</a> and <a href="/wiki/Bart_Preneel" title="Bart Preneel">Bart Preneel</a>, Analysis of Non-fortuitous Predictive States of the RC4 Keystream Generator. <a href="/wiki/INDOCRYPT" title="INDOCRYPT" class="mw-redirect">INDOCRYPT</a> 2003, pp52 – 67 <a href="http://www.cosic.esat.kuleuven.be/publications/article-86.pdf" class="external text" title="http://www.cosic.esat.kuleuven.be/publications/article-86.pdf" rel="nofollow">(PDF)</a>.</li>
<li id="cite_note-5"><b><a href="#cite_ref-5" title="">^</a></b> Scott R. Fluhrer and David A. McGrew, Statistical Analysis of the Alleged RC4 Keystream Generator. FSE 2000, pp19 – 30 <a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/FluhrerMcgrew.pdf" class="external text" title="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/FluhrerMcgrew.pdf" rel="nofollow">(PDF)</a></li>
<li id="cite_note-6"><b><a href="#cite_ref-6" title="">^</a></b> Scott R. Fluhrer, Itsik Mantin and Adi Shamir, Weaknesses in the Key Scheduling Algorithm of RC4. <a href="/wiki/Selected_Areas_in_Cryptography" title="Selected Areas in Cryptography">Selected Areas in Cryptography</a> 2001, pp1 – 24 <a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/Rc4_ksa.ps" class="external text" title="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/Rc4_ksa.ps" rel="nofollow">(PS)</a>.</li>
<li id="cite_note-7"><b><a href="#cite_ref-7" title="">^</a></b> <a href="http://www.users.zetnet.co.uk/hopwood/crypto/scan/cs.html#RC4-drop" class="external text" title="http://www.users.zetnet.co.uk/hopwood/crypto/scan/cs.html#RC4-drop" rel="nofollow">"RC4-drop(nbytes)"</a> in the <i>"Standard Cryptographic Algorithm Naming"</i> database</li>
<li id="cite_note-8"><b><a href="#cite_ref-8" title="">^</a></b> Erik Tews, Ralf-Philipp Weinmann, Andrei Pyshkin. <a href="http://eprint.iacr.org/2007/120" class="external text" title="http://eprint.iacr.org/2007/120" rel="nofollow">Breaking 104-bit WEP in under a minute</a>.</li>
<li id="cite_note-9"><b><a href="#cite_ref-9" title="">^</a></b> <a href="/wiki/Souradyuti_Paul" title="Souradyuti Paul">Souradyuti Paul</a> and <a href="/wiki/Bart_Preneel" title="Bart Preneel">Bart Preneel</a>, A New Weakness in the RC4 Keystream Generator and an Approach to Improve the Security of the Cipher. <a href="/wiki/Fast_Software_Encryption" title="Fast Software Encryption">Fast Software Encryption</a> - FSE 2004, pp245 – 259 <a href="http://www.cosic.esat.kuleuven.be/publications/article-40.pdf" class="external text" title="http://www.cosic.esat.kuleuven.be/publications/article-40.pdf" rel="nofollow">(PDF)</a>.</li>
</ol>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=RC4&amp;action=edit&amp;section=15" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<p><i>RC4</i></p>
<ul>
<li><a href="http://www.mozilla.org/projects/security/pki/nss/draft-kaukonen-cipher-arcfour-03.txt" class="external text" title="http://www.mozilla.org/projects/security/pki/nss/draft-kaukonen-cipher-arcfour-03.txt" rel="nofollow">IETF Draft - A Stream Cipher Encryption Algorithm "Arcfour"</a></li>
<li><a href="http://cypherpunks.venona.com/archive/1994/09/msg00304.html" class="external text" title="http://cypherpunks.venona.com/archive/1994/09/msg00304.html" rel="nofollow">Original posting of RC4 algorithm to Cypherpunks mailing list</a></li>
<li><a href="http://www.users.zetnet.co.uk/hopwood/crypto/scan/cs.html#RC4" class="external text" title="http://www.users.zetnet.co.uk/hopwood/crypto/scan/cs.html#RC4" rel="nofollow">SCAN's entry for RC4</a></li>
<li><a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html" class="external text" title="http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html" rel="nofollow">Attacks on RC4</a></li>
<li><a href="http://research.cyber.ee/~lipmaa/crypto/link/stream/rc4.php" class="external text" title="http://research.cyber.ee/~lipmaa/crypto/link/stream/rc4.php" rel="nofollow">RC4 - Cryptology Pointers by Helger Lipmaa</a></li>
<li><a href="http://www.rsasecurity.com/rsalabs/node.asp?id=2009" class="external text" title="http://www.rsasecurity.com/rsalabs/node.asp?id=2009" rel="nofollow">RSA Security Response to Weaknesses in Key Scheduling Algorithm of RC4</a></li>
<li><a href="http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=76258" class="external text" title="http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=76258" rel="nofollow">T-SQL implementation</a></li>
</ul>
<p><i>RC4 in WEP</i></p>
<ul>
<li><a href="http://www.isaac.cs.berkeley.edu/isaac/wep-faq.html" class="external text" title="http://www.isaac.cs.berkeley.edu/isaac/wep-faq.html" rel="nofollow">(in)Security of the WEP algorithm</a></li>
<li><a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/rc4_wep.ps" class="external text" title="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/rc4_wep.ps" rel="nofollow">Fluhrer, Mantin, and Shamir attack on WEP (postscript format)</a></li>
</ul>
<table class="navbox" cellspacing="0" style=";">
<tr>
<td style="padding:2px;">
<table cellspacing="0" class="nowraplinks" style="width:100%;background:transparent;color:inherit;;">
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em"></div>
<table cellspacing="0" class="nowraplinks navbox-subgroup" style="width:100%;;;;">
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em"></div>
<table cellspacing="0" class="nowraplinks navbox-subgroup" style="width:100%;;;;">
<tr>
<th style=";background:#ccf;" colspan="2" class="navbox-title">
<div style="float:left; width:6em;text-align:left;">
<div class="noprint plainlinksneverexpand navbar" style="background:none; padding:0; font-weight:normal;;background:#ccf;;border:none;; font-size:xx-small;"><a href="/wiki/Template:Crypto_stream" title="Template:Crypto stream"><span title="View this template" style=";background:#ccf;;border:none;">v</span></a>&#160;<span style="font-size:80%;">•</span>&#160;<a href="/wiki/Template_talk:Crypto_stream" title="Template talk:Crypto stream"><span title="Discussion about this template" style=";background:#ccf;;border:none;">d</span></a>&#160;<span style="font-size:80%;">•</span>&#160;<a href="http://en.wikipedia.org/w/index.php?title=Template:Crypto_stream&amp;action=edit" class="external text" title="http://en.wikipedia.org/w/index.php?title=Template:Crypto_stream&amp;action=edit" rel="nofollow"><span title="Edit this template" style=";background:#ccf;;border:none;;">e</span></a></div>
</div>
<div style="float:right;width:6em;">&#160;</div>
<span style="font-size:100%;"><a href="/wiki/Stream_cipher" title="Stream cipher">Stream ciphers</a></span></th>
</tr>
<tr style="height:2px;">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em">
<p><span style="white-space:nowrap"><b>Widely used ciphers:</b> <strong class="selflink">RC4</strong>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Block_cipher_modes_of_operation" title="Block cipher modes of operation">Block ciphers in stream mode</a></span> &#160;&#160;&#160;&#160; <span style="white-space:nowrap"><b><a href="/wiki/ESTREAM" title="ESTREAM">eSTREAM</a> Portfolio:</b>&#160; Software: <a href="/wiki/HC-256" title="HC-256">HC-128</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Rabbit_(cipher)" title="Rabbit (cipher)">Rabbit</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Salsa20" title="Salsa20">Salsa20</a>/12&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/SOSEMANUK" title="SOSEMANUK">SOSEMANUK</a></span> &#160; <span style="white-space:nowrap">Hardware: <a href="/wiki/Grain_(cipher)" title="Grain (cipher)">Grain</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/MICKEY-128" title="MICKEY-128" class="mw-redirect">MICKEY-128</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Trivium_(cipher)" title="Trivium (cipher)">Trivium</a></span></p>
</div>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even">
<div style="padding:0em 0.25em">
<p><span style="white-space:nowrap"><b>Other ciphers:</b> <a href="/wiki/A5/1" title="A5/1">A5/1</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/A5/2" title="A5/2">A5/2</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/E0_(cipher)" title="E0 (cipher)">E0</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/FISH_(cipher)" title="FISH (cipher)">FISH</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/ISAAC_(cipher)" title="ISAAC (cipher)">ISAAC</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/MUGI" title="MUGI">MUGI</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Panama_(cipher)" title="Panama (cipher)" class="mw-redirect">Panama</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Phelix" title="Phelix">Phelix</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Pike_(cipher)" title="Pike (cipher)">Pike</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Py_(cipher)" title="Py (cipher)">Py</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/QUAD_(cipher)" title="QUAD (cipher)">QUAD</a> &#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Scream_(cipher)" title="Scream (cipher)">Scream</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/SEAL_(cipher)" title="SEAL (cipher)">SEAL</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/SOBER" title="SOBER">SOBER</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/SOBER-128" title="SOBER-128">SOBER-128</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/VEST" title="VEST">VEST</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/WAKE_(cipher)" title="WAKE (cipher)">WAKE</a></span></p>
</div>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em">
<p><span style="white-space:nowrap"><b>Theory:</b> <a href="/wiki/Shift_register" title="Shift register">Shift register</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/LFSR" title="LFSR" class="mw-redirect">LFSR</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/NLFSR" title="NLFSR">NLFSR</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Shrinking_generator" title="Shrinking generator">Shrinking generator</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/T-function" title="T-function">T-function</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Initialization_vector" title="Initialization vector">IV</a></span></p>
</div>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even">
<div style="padding:0em 0.25em">
<p><span style="white-space:nowrap"><b>Attacks:</b> <a href="/wiki/Correlation_attack" title="Correlation attack">Correlation attack</a>&#160;|</span> <span style="white-space:nowrap"><a href="/wiki/Correlation_immunity" title="Correlation immunity">Correlation immunity</a></span></p>
</div>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even">
<div style="padding:0em 0.25em"></div>
<table cellspacing="0" class="nowraplinks navbox-subgroup" style="width:100%;;;;">
<tr>
<th style=";background:#ccf;" colspan="2" class="navbox-title">
<div style="float:left; width:6em;text-align:left;">
<div class="noprint plainlinksneverexpand navbar" style="background:none; padding:0; font-weight:normal;;background:#ccf;;border:none;; font-size:xx-small;"><a href="/wiki/Template:Crypto_navbox" title="Template:Crypto navbox"><span title="View this template" style=";background:#ccf;;border:none;">v</span></a>&#160;<span style="font-size:80%;">•</span>&#160;<a href="/wiki/Template_talk:Crypto_navbox" title="Template talk:Crypto navbox"><span title="Discussion about this template" style=";background:#ccf;;border:none;">d</span></a>&#160;<span style="font-size:80%;">•</span>&#160;<a href="http://en.wikipedia.org/w/index.php?title=Template:Crypto_navbox&amp;action=edit" class="external text" title="http://en.wikipedia.org/w/index.php?title=Template:Crypto_navbox&amp;action=edit" rel="nofollow"><span title="Edit this template" style=";background:#ccf;;border:none;;">e</span></a></div>
</div>
<div style="float:right;width:6em;">&#160;</div>
<span style="font-size:100%;"><a href="/wiki/Cryptography" title="Cryptography">Cryptography</a></span></th>
</tr>
<tr style="height:2px;">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em"><a href="/wiki/History_of_cryptography" title="History of cryptography">History of cryptography</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Cryptanalysis" title="Cryptanalysis">Cryptanalysis</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Portal:Cryptography" title="Portal:Cryptography">Cryptography portal</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Topics_in_cryptography" title="Topics in cryptography">Topics in cryptography</a></div>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even">
<div style="padding:0em 0.25em"><a href="/wiki/Symmetric-key_algorithm" title="Symmetric-key algorithm">Symmetric-key algorithm</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Block_cipher" title="Block cipher">Block cipher</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Stream_cipher" title="Stream cipher">Stream cipher</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Public-key_cryptography" title="Public-key cryptography">Public-key cryptography</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Cryptographic_hash_function" title="Cryptographic hash function">Cryptographic hash function</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Message_authentication_code" title="Message authentication code">Message authentication code</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Cryptographically_secure_pseudorandom_number_generator" title="Cryptographically secure pseudorandom number generator">Random numbers</a><span style="font-weight:bold;">&#160;·</span> <a href="/wiki/Steganography" title="Steganography">Steganography</a></div>
</td>
</tr>
</table>
</td>
</tr>
</table>
</td>
</tr>
</table>


<!-- 
NewPP limit report
Preprocessor node count: 2150/1000000
Post-expand include size: 75843/2048000 bytes
Template argument size: 41577/2048000 bytes
Expensive parser function count: 3/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:25831-0!1!0!default!!en!2 and timestamp 20090405090511 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/RC4">http://en.wikipedia.org/wiki/RC4</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Stream_ciphers" title="Category:Stream ciphers">Stream ciphers</a></span> | <span dir='ltr'><a href="/wiki/Category:Pseudorandom_number_generators" title="Category:Pseudorandom number generators">Pseudorandom number generators</a></span> | <span dir='ltr'><a href="/wiki/Category:Free_ciphers" title="Category:Free ciphers">Free ciphers</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_example_C_code" title="Category:Articles with example C code">Articles with example C code</a></span></div><div id="mw-hidden-catlinks" class="mw-hidden-cats-hidden">Hidden categories:&#32;<span dir='ltr'><a href="/wiki/Category:Wikipedia_articles_in_need_of_updating" title="Category:Wikipedia articles in need of updating">Wikipedia articles in need of updating</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_that_may_contain_original_research_since_February_2009" title="Category:Articles that may contain original research since February 2009">Articles that may contain original research since February 2009</a></span> | <span dir='ltr'><a href="/wiki/Category:All_articles_that_may_contain_original_research" title="Category:All articles that may contain original research">All articles that may contain original research</a></span> | <span dir='ltr'><a href="/wiki/Category:All_articles_with_unsourced_statements" title="Category:All articles with unsourced statements">All articles with unsourced statements</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_unsourced_statements_since_January_2009" title="Category:Articles with unsourced statements since January 2009">Articles with unsourced statements since January 2009</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_unsourced_statements_since_March_2009" title="Category:Articles with unsourced statements since March 2009">Articles with unsourced statements since March 2009</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/RC4" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:RC4" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=RC4&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=RC4&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=RC4" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/RC4" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/RC4" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=RC4&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=RC4&amp;oldid=281864906" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=RC4&amp;id=281864906">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-de"><a href="http://de.wikipedia.org/wiki/RC4">Deutsch</a></li>
				<li class="interwiki-es"><a href="http://es.wikipedia.org/wiki/RC4">Español</a></li>
				<li class="interwiki-fr"><a href="http://fr.wikipedia.org/wiki/RC4">Français</a></li>
				<li class="interwiki-hr"><a href="http://hr.wikipedia.org/wiki/RC4">Hrvatski</a></li>
				<li class="interwiki-it"><a href="http://it.wikipedia.org/wiki/RC4">Italiano</a></li>
				<li class="interwiki-he"><a href="http://he.wikipedia.org/wiki/RC4">עברית</a></li>
				<li class="interwiki-nl"><a href="http://nl.wikipedia.org/wiki/RC4_(encryptie)">Nederlands</a></li>
				<li class="interwiki-ja"><a href="http://ja.wikipedia.org/wiki/RC4">日本語</a></li>
				<li class="interwiki-pl"><a href="http://pl.wikipedia.org/wiki/RC4">Polski</a></li>
				<li class="interwiki-pt"><a href="http://pt.wikipedia.org/wiki/RC4">Português</a></li>
				<li class="interwiki-ru"><a href="http://ru.wikipedia.org/wiki/RC4">Русский</a></li>
				<li class="interwiki-simple"><a href="http://simple.wikipedia.org/wiki/RC4">Simple English</a></li>
				<li class="interwiki-sl"><a href="http://sl.wikipedia.org/wiki/RC4">Slovenščina</a></li>
				<li class="interwiki-fi"><a href="http://fi.wikipedia.org/wiki/RC4">Suomi</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 5 April 2009, at 09:05.</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv96 in 0.466 secs. --></body></html>
