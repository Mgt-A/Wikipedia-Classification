<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="QR decomposition,ArXiv,Charles F. Van Loan,Determinant,Eigenvalue algorithm,Eigenvalue decomposition,Euclidean space,Floating-point arithmetic,Gene H. Golub,Givens rotation,Gram-Schmidt" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=QR_decomposition&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=QR_decomposition&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>QR decomposition - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "QR_decomposition";
		var wgTitle = "QR decomposition";
		var wgAction = "view";
		var wgArticleId = "305223";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 282092158;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-QR_decomposition skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">QR decomposition</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p>In <a href="/wiki/Linear_algebra" title="Linear algebra">linear algebra</a>, a <b>QR decomposition</b> (also called a <b>QR factorization</b>) of a <a href="/wiki/Matrix_(mathematics)" title="Matrix (mathematics)">matrix</a> is a <a href="/wiki/Matrix_decomposition" title="Matrix decomposition">decomposition</a> of the matrix into an <a href="/wiki/Orthogonal_matrix" title="Orthogonal matrix">orthogonal</a> and a <a href="/wiki/Right_triangular_matrix" title="Right triangular matrix" class="mw-redirect">right triangular matrix</a>. QR decomposition is often used to solve the <a href="/wiki/Linear_least_squares" title="Linear least squares">linear least squares</a> problem, and is the basis for a particular <a href="/wiki/Eigenvalue_algorithm" title="Eigenvalue algorithm">eigenvalue algorithm</a>, the <a href="/wiki/QR_algorithm" title="QR algorithm">QR algorithm</a>.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Definition"><span class="tocnumber">1</span> <span class="toctext">Definition</span></a></li>
<li class="toclevel-1"><a href="#Computing_the_QR_decomposition"><span class="tocnumber">2</span> <span class="toctext">Computing the QR decomposition</span></a>
<ul>
<li class="toclevel-2"><a href="#Using_the_Gram-Schmidt_process"><span class="tocnumber">2.1</span> <span class="toctext">Using the Gram-Schmidt process</span></a>
<ul>
<li class="toclevel-3"><a href="#Example"><span class="tocnumber">2.1.1</span> <span class="toctext">Example</span></a></li>
<li class="toclevel-3"><a href="#Relation_to_RQ_decomposition"><span class="tocnumber">2.1.2</span> <span class="toctext">Relation to RQ decomposition</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Using_Householder_reflections"><span class="tocnumber">2.2</span> <span class="toctext">Using Householder reflections</span></a>
<ul>
<li class="toclevel-3"><a href="#Example_2"><span class="tocnumber">2.2.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Using_Givens_rotations"><span class="tocnumber">2.3</span> <span class="toctext">Using Givens rotations</span></a>
<ul>
<li class="toclevel-3"><a href="#Example_3"><span class="tocnumber">2.3.1</span> <span class="toctext">Example</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#Connection_to_a_determinant_or_a_product_of_eigenvalues"><span class="tocnumber">3</span> <span class="toctext">Connection to a determinant or a product of eigenvalues</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">5</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">6</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Definition" id="Definition"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=1" title="Edit section: Definition">edit</a>]</span> <span class="mw-headline">Definition</span></h2>
<p>A <b>QR decomposition</b> of a real square matrix <i>A</i> is a decomposition of <i>A</i> as</p>
<dl>
<dd><img class="tex" alt=" A = QR, \, " src="http://upload.wikimedia.org/math/2/2/1/221a7ed8943f9168fa5ad6465f9d1961.png" /></dd>
</dl>
<p>where <i>Q</i> is an <a href="/wiki/Orthogonal_matrix" title="Orthogonal matrix">orthogonal matrix</a> (meaning that <i>Q</i><sup>T</sup><i>Q</i> = <i>I</i> ) and <i>R</i> is an upper <a href="/wiki/Triangular_matrix" title="Triangular matrix">triangular matrix</a> (also called right triangular matrix). Analogously, we can define the QL, RQ, and LQ decompositions of A (with <i>L</i> being a lower triangular matrix in this case).</p>
<p>More generally, we can factor a complex <span class="texhtml"><i>m</i></span>×<span class="texhtml"><i>n</i></span> matrix (with <i>m</i> ≥ <i>n</i>) as the product of an <span class="texhtml"><i>m</i></span>×<span class="texhtml"><i>m</i></span> <a href="/wiki/Unitary_matrix" title="Unitary matrix">unitary matrix</a> and an <span class="texhtml"><i>m</i></span>×<span class="texhtml"><i>n</i></span> upper triangular matrix. An alternative definition is decomposing a complex <span class="texhtml"><i>m</i></span>×<span class="texhtml"><i>n</i></span> matrix (with <i>m</i> ≥ <i>n</i>) as the product of an <span class="texhtml"><i>m</i></span>×<span class="texhtml"><i>n</i></span> matrix with orthogonal columns and an <span class="texhtml"><i>n</i></span>×<span class="texhtml"><i>n</i></span> upper triangular matrix; <a href="#CITEREFGolubVan_Loan1996" title="">Golub &amp; Van Loan (1996</a>, §5.2) call this the <i>thin QR factorization</i>.</p>
<p>If <i>A</i> is <a href="/wiki/Invertible_matrix" title="Invertible matrix">nonsingular</a>, then this factorization is unique if we require that the diagonal elements of <i>R</i> are positive.</p>
<p><a name="Computing_the_QR_decomposition" id="Computing_the_QR_decomposition"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=2" title="Edit section: Computing the QR decomposition">edit</a>]</span> <span class="mw-headline">Computing the QR decomposition</span></h2>
<p>There are several methods for actually computing the QR decomposition, such as by means of the <a href="/wiki/Gram%E2%80%93Schmidt_process" title="Gram–Schmidt process">Gram–Schmidt process</a>, <a href="/wiki/Householder_transformation" title="Householder transformation">Householder transformations</a>, or <a href="/wiki/Givens_rotation" title="Givens rotation">Givens rotations</a>. Each has a number of advantages and disadvantages.</p>
<p><a name="Using_the_Gram-Schmidt_process" id="Using_the_Gram-Schmidt_process"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=3" title="Edit section: Using the Gram-Schmidt process">edit</a>]</span> <span class="mw-headline">Using the Gram-Schmidt process</span></h3>
<div class="rellink boilerplate seealso">For more details on this topic, see <a href="/wiki/Gram-Schmidt#Numerical_stability" title="Gram-Schmidt" class="mw-redirect">Gram-Schmidt#Numerical stability</a>.</div>
<p>Consider the <a href="/wiki/Gram%E2%80%93Schmidt_process" title="Gram–Schmidt process">Gram–Schmidt process</a>, with the vectors to be considered in the process as the columns of the matrix <img class="tex" alt="A=(\mathbf{a}_1| \cdots|\mathbf{a}_n)" src="http://upload.wikimedia.org/math/3/2/c/32c848792025e0106a4ad32167289324.png" />. We define <img class="tex" alt="\mathrm{proj}_{\mathbf{e}}\mathbf{a} 
= \frac{\left\langle\mathbf{e},\mathbf{a}\right\rangle}{\left\langle\mathbf{e},\mathbf{e}\right\rangle}\mathbf{e}
" src="http://upload.wikimedia.org/math/d/f/7/df7ac204b15f4e30b421dc7995652990.png" /> where <img class="tex" alt="\left\langle\mathbf{v},\mathbf{w}\right\rangle
=\mathbf{v}^T\mathbf{w}" src="http://upload.wikimedia.org/math/3/d/3/3d330f278eebab7aa416e5cbbf809758.png" />.</p>
<p>Then</p>
<dl>
<dd><img class="tex" alt="
\mathbf{u}_1 = \mathbf{a}_1, \qquad\mathbf{e}_1 = {\mathbf{u}_1 \over \|\mathbf{u}_1\|}" src="http://upload.wikimedia.org/math/7/6/9/769ea5a3bfb990de7cab0305c8b0df61.png" /></dd>
<dd><img class="tex" alt="
\mathbf{u}_2 = \mathbf{a}_2-\mathrm{proj}_{\mathbf{e}_1}\,\mathbf{a}_2, \qquad\mathbf{e}_2 = {\mathbf{u}_2 \over \|\mathbf{u}_2\|}" src="http://upload.wikimedia.org/math/3/8/e/38eeb6c28fc4f149913cfff83cb605da.png" /></dd>
<dd><img class="tex" alt="
\mathbf{u}_3 = \mathbf{a}_3-\mathrm{proj}_{\mathbf{e}_1}\,\mathbf{a}_3-\mathrm{proj}_{\mathbf{e}_2}\,\mathbf{a}_3, \qquad\mathbf{e}_3 = {\mathbf{u}_3 \over \|\mathbf{u}_3\|} " src="http://upload.wikimedia.org/math/9/b/d/9bd12f408107427b3831ca7c8d9d1aec.png" />
<dl>
<dd><img class="tex" alt="\vdots" src="http://upload.wikimedia.org/math/7/0/e/70e4c7b983e3bc5849c2cfd6af4a431e.png" /></dd>
</dl>
</dd>
<dd><img class="tex" alt="
\mathbf{u}_k = \mathbf{a}_k-\sum_{j=1}^{k-1}\mathrm{proj}_{\mathbf{e}_j}\,\mathbf{a}_k,\qquad\mathbf{e}_k = {\mathbf{u}_k\over\|\mathbf{u}_k\|}
" src="http://upload.wikimedia.org/math/1/4/8/148b83fc84f073529c03fb38e474f176.png" /></dd>
</dl>
<p>We then rearrange the equations above so that the <img class="tex" alt="\mathbf{a}_i" src="http://upload.wikimedia.org/math/4/f/9/4f9ee9b3c06edf24b61f27307fd0f009.png" />s are on the left, producing the following equations.</p>
<dl>
<dd><img class="tex" alt="\mathbf{a}_1 = \mathbf{e}_1\|\mathbf{u}_1\| " src="http://upload.wikimedia.org/math/1/a/1/1a1f5560168167a5ec1b9cc4877d24aa.png" /></dd>
<dd><img class="tex" alt="\mathbf{a}_2 = \mathrm{proj}_{\mathbf{e}_1}\,\mathbf{a}_2+\mathbf{e}_2\|\mathbf{u}_2\| " src="http://upload.wikimedia.org/math/8/0/9/809fe2867df55a51b0544852253f5213.png" /></dd>
<dd><img class="tex" alt="\mathbf{a}_3 = \mathrm{proj}_{\mathbf{e}_1}\,\mathbf{a}_3+\mathrm{proj}_{\mathbf{e}_2}\,\mathbf{a}_3+\mathbf{e}_3\|\mathbf{u}_3\| " src="http://upload.wikimedia.org/math/b/6/b/b6b17429c9b448373478409e6c6cbe0e.png" />
<dl>
<dd><img class="tex" alt="\vdots" src="http://upload.wikimedia.org/math/7/0/e/70e4c7b983e3bc5849c2cfd6af4a431e.png" /></dd>
</dl>
</dd>
<dd><img class="tex" alt="\mathbf{a}_k = \sum_{j=1}^{k-1}\mathrm{proj}_{\mathbf{e}_j}\,\mathbf{a}_k+\mathbf{e}_k\|\mathbf{u}_k\| " src="http://upload.wikimedia.org/math/b/a/0/ba0212c5d65bf8c39c78fd4fb4eb9f19.png" /></dd>
</dl>
<p><br />
Note that since the <img class="tex" alt="\mathbf{e}_i" src="http://upload.wikimedia.org/math/f/b/6/fb65726b99cf310c0c12347ddebc6d79.png" /> are unit vectors, we have the following.</p>
<dl>
<dd><img class="tex" alt="\mathbf{a}_1 = \mathbf{e}_1\|\mathbf{u}_1\| " src="http://upload.wikimedia.org/math/1/a/1/1a1f5560168167a5ec1b9cc4877d24aa.png" /></dd>
<dd><img class="tex" alt="\mathbf{a}_2 = \left\langle\mathbf{e}_1,\mathbf{a}_2\right\rangle\mathbf{e}_1
+\mathbf{e}_2\|\mathbf{u}_2\| " src="http://upload.wikimedia.org/math/c/d/6/cd6002656c1b1311a3f13a818f701f3d.png" /></dd>
<dd><img class="tex" alt="\mathbf{a}_3 = \left\langle\mathbf{e}_1,\mathbf{a}_3\right\rangle\mathbf{e}_1
+\left\langle\mathbf{e_2},\mathbf{a}_3\right\rangle\mathbf{e}_2
+\mathbf{e}_3\|\mathbf{u}_3\| " src="http://upload.wikimedia.org/math/0/c/9/0c9fdf0525b3cd40f78c6d2c90d33428.png" />
<dl>
<dd><img class="tex" alt="\vdots" src="http://upload.wikimedia.org/math/7/0/e/70e4c7b983e3bc5849c2cfd6af4a431e.png" /></dd>
</dl>
</dd>
<dd><img class="tex" alt="\mathbf{a}_k = \sum_{j=1}^{k-1}\left\langle\mathbf{e}_j,\mathbf{a}_k\right\rangle\mathbf{e}_j
+\mathbf{e}_k\|\mathbf{u}_k\| " src="http://upload.wikimedia.org/math/a/3/8/a38c801effaf3b77be2eecf51bb2f875.png" /></dd>
</dl>
<p>Now the right sides of these equations can be written in matrix form as follows:</p>
<dl>
<dd><img class="tex" alt="\left(\mathbf{e}_1|\cdots |\mathbf{e}_n\right)
\begin{pmatrix} 
\|\mathbf{u}_1\| &amp; \langle\mathbf{e}_1,\mathbf{a}_2\rangle &amp;  \langle\mathbf{e}_1,\mathbf{a}_3\rangle  &amp; \ldots \\
0                &amp; \|\mathbf{u}_2\|                        &amp;  \langle\mathbf{e}_2,\mathbf{a}_3\rangle  &amp; \ldots \\
0                &amp; 0                                       &amp; \|\mathbf{u}_3\|                          &amp; \ldots \\
\vdots           &amp; \vdots                                  &amp; \vdots                                    &amp; \ddots \end{pmatrix}." src="http://upload.wikimedia.org/math/6/b/7/6b7006876a037aa0991c032e5496d621.png" /></dd>
</dl>
<p>But the product of each row and column of the matrices above give us a respective column of <i>A</i> that we started with, and together, they give us the matrix <i>A</i>, so we have factorized <i>A</i> into an orthogonal matrix <i>Q</i> (the matrix of <i><b>e</b></i><sub><i>k</i></sub>s), via Gram Schmidt, and the obvious <a href="/wiki/Upper_triangular" title="Upper triangular" class="mw-redirect">upper triangular</a> matrix as a remainder <i>R</i>.</p>
<p>Alternatively, <img class="tex" alt="\begin{matrix} R \end{matrix}" src="http://upload.wikimedia.org/math/f/5/5/f554e34ae46b29f03bcafdd1779ce13b.png" /> can be calculated as follows:</p>
<p>Recall that <img class="tex" alt="
\begin{matrix}Q\end{matrix} = (\mathbf{e}_1|\cdots |\mathbf{e}_n).
" src="http://upload.wikimedia.org/math/0/2/c/02c91c8ee1c62529f9513fa9b11b9bb0.png" /> Then, we have</p>
<dl>
<dd><img class="tex" alt="
\begin{matrix} R = Q^{T}A = \end{matrix} 
\begin{pmatrix} 
\langle\mathbf{e}_1,\mathbf{a}_1\rangle &amp; \langle\mathbf{e}_1,\mathbf{a}_2\rangle &amp;  \langle\mathbf{e}_1,\mathbf{a}_3\rangle  &amp; \ldots 
\\
0                &amp; \langle\mathbf{e}_2,\mathbf{a}_2\rangle                        &amp;  \langle\mathbf{e}_2,\mathbf{a}_3\rangle  &amp; \ldots 
\\
0                &amp; 0                                       &amp; \langle\mathbf{e}_3,\mathbf{a}_3\rangle                          &amp; \ldots 
\\
\vdots           &amp; \vdots                                  &amp; \vdots                                    &amp; \ddots \end{pmatrix}.
" src="http://upload.wikimedia.org/math/c/0/f/c0f11aaf5ef2bc340c7817e5b4d498c7.png" /></dd>
</dl>
<p>Note that <img class="tex" alt="\langle\mathbf{e}_j,\mathbf{a}_j\rangle = \|\mathbf{u}_j\|," src="http://upload.wikimedia.org/math/6/f/2/6f26eb9b6a129af34a7de9066ce8b61c.png" /> <img class="tex" alt="\langle\mathbf{e}_j,\mathbf{a}_k\rangle = 0 \mathrm{~~for~~} j &gt; k," src="http://upload.wikimedia.org/math/3/4/8/3485971641ca1898445b338eedd635fd.png" /> and <span class="texhtml"><i>Q</i><i>Q</i><sup><i>T</i></sup> = <i>I</i></span>, so <span class="texhtml"><i>Q</i><sup><i>T</i></sup> = <i>Q</i> <sup>− 1</sup></span>.</p>
<p><a name="Example" id="Example"></a></p>
<h4><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=4" title="Edit section: Example">edit</a>]</span> <span class="mw-headline">Example</span></h4>
<p>Consider the decomposition of</p>
<dl>
<dd><img class="tex" alt="A = 
\begin{pmatrix}
12 &amp; -51 &amp; 4 \\
6 &amp; 167 &amp; -68 \\
-4 &amp; 24 &amp; -41 
\end{pmatrix}
." src="http://upload.wikimedia.org/math/a/3/d/a3d7f42c13a2dca10a0d75e4a181b763.png" /></dd>
</dl>
<p>Recall that an orthogonal matrix <span class="texhtml"><i>Q</i></span> has the property</p>
<dl>
<dd><img class="tex" alt="
\begin{matrix}
 Q\,Q^{T} = I.
\end{matrix}
" src="http://upload.wikimedia.org/math/e/d/1/ed173b326b74d7c10e5d5693a8af0ef3.png" /></dd>
</dl>
<p>Then, we can calculate <span class="texhtml"><i>Q</i></span> by means of Gram-Schmidt as follows:</p>
<dl>
<dd><img class="tex" alt="
U = 
\begin{pmatrix}
\mathbf u_1 &amp; \mathbf u_2 &amp; \mathbf u_3
\end{pmatrix}
=
\begin{pmatrix}
12 &amp; -69 &amp; -58/5 \\
6  &amp; 158 &amp; 6/5 \\
-4 &amp;  30 &amp; -33 
\end{pmatrix};
" src="http://upload.wikimedia.org/math/a/1/a/a1af8a446da43e5615a0c263074b43bf.png" /></dd>
<dd><img class="tex" alt="
Q = 
\begin{pmatrix}
\frac{\mathbf u_1}{\|\mathbf u_1\|} &amp; 
\frac{\mathbf u_2}{\|\mathbf u_2\|} &amp; 
\frac{\mathbf u_3}{\|\mathbf u_3\|}
\end{pmatrix}
=
\begin{pmatrix}
     6/7    &amp;    -69/175   &amp;   -58/175   \\
     3/7    &amp;    158/175   &amp;     6/175   \\
    -2/7    &amp;      6/35    &amp;   -33/35    
\end{pmatrix};
" src="http://upload.wikimedia.org/math/1/5/1/1511d26182acdb1f40b7113e186cd9c4.png" /></dd>
</dl>
<p>Thus, we have</p>
<dl>
<dd><img class="tex" alt="
\begin{matrix}
 A = Q\,Q^{T}A = Q R; 
\end{matrix}
" src="http://upload.wikimedia.org/math/2/2/8/228ca189ef7a6e7a54c907a9d5d07d3f.png" /></dd>
<dd><img class="tex" alt="
\begin{matrix}
 R = Q^{T}A =
\end{matrix}
\begin{pmatrix}
    14  &amp;  21          &amp;            -14 \\
     0  &amp; 175          &amp;            -70 \\
     0  &amp;   0          &amp;             35
\end{pmatrix}.
" src="http://upload.wikimedia.org/math/6/2/4/62457f147ee937b086330fe52cd4c5ea.png" /></dd>
</dl>
<p><a name="Relation_to_RQ_decomposition" id="Relation_to_RQ_decomposition"></a></p>
<h4><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=5" title="Edit section: Relation to RQ decomposition">edit</a>]</span> <span class="mw-headline">Relation to RQ decomposition</span></h4>
<p>The RQ decomposition transforms a matrix <i>A</i> into the product of an upper triangular matrix <i>R</i> (also known as right-triangular) and an orthogonal matrix <i>Q</i>. The only difference from QR decomposition is the order of these matrices.</p>
<p>QR decomposition is Gram-Schmidt orthogonalization of columns of A, started from the first column.</p>
<p>RQ decomposition is Gram-Schmidt orthogonalization of rows of A, started from the last row.</p>
<p><a name="Using_Householder_reflections" id="Using_Householder_reflections"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=6" title="Edit section: Using Householder reflections">edit</a>]</span> <span class="mw-headline">Using Householder reflections</span></h3>
<p>A <a href="/wiki/Householder_reflection" title="Householder reflection" class="mw-redirect">Householder reflection</a> (or <i>Householder transformation</i>) is a transformation that takes a vector and reflects it about some plane. We can use this operation to calculate the QR factorization of a matrix.</p>
<p><i>Q</i> can be used to reflect a vector in such a way that all coordinates but one disappear.</p>
<p>Let <img class="tex" alt="\mathbf{x}" src="http://upload.wikimedia.org/math/3/c/6/3c66d9170d4c3fb75456e1a9fc6ead37.png" /> be an arbitrary real <i>m</i>-dimensional column vector such that ||<img class="tex" alt="\mathbf{x}" src="http://upload.wikimedia.org/math/3/c/6/3c66d9170d4c3fb75456e1a9fc6ead37.png" />|| = |α| for a scalar α. If the algorithm is implemented using <a href="/wiki/Floating-point_arithmetic" title="Floating-point arithmetic" class="mw-redirect">floating-point arithmetic</a>, then α should get the opposite sign as the first coordinate of <img class="tex" alt="\mathbf{x}" src="http://upload.wikimedia.org/math/3/c/6/3c66d9170d4c3fb75456e1a9fc6ead37.png" /> to avoid <a href="/wiki/Loss_of_significance" title="Loss of significance">loss of significance</a>. In the complex case, set</p>
<dl>
<dd><img class="tex" alt=" \alpha = - \mathrm{e}^{\mathrm{i} \arg x_1} \|\mathbf{x}\|" src="http://upload.wikimedia.org/math/f/2/6/f260eb74a9bafa4f02a990145a701044.png" /></dd>
</dl>
<p><cite class="inline">(<a href="#CITEREFStoerBulirsch2002" title="">Stoer &amp; Bulirsch 2002</a>, p.&#160;225)</cite> and substitute transposition by conjugate transposition in the construction of <i>Q</i> below.</p>
<p>Then, where <img class="tex" alt="\mathbf{e}_1" src="http://upload.wikimedia.org/math/5/2/e/52e37e54802864968a5c71bd37e1d5eb.png" /> is the vector (1,0,...,0)<sup>T</sup>, and ||·|| the <a href="/wiki/Euclidean_space#Euclidean_structure" title="Euclidean space">Euclidean norm</a>, set</p>
<dl>
<dd><img class="tex" alt="\mathbf{u} = \mathbf{x} - \alpha\mathbf{e}_1," src="http://upload.wikimedia.org/math/b/4/5/b45d27817481e8920b3a3840672e09bf.png" /></dd>
<dd><img class="tex" alt="\mathbf{v} = {\mathbf{u}\over\|\mathbf{u}\|}," src="http://upload.wikimedia.org/math/c/6/5/c65538aa0c24ad79f882ee85159f86a8.png" /></dd>
<dd><img class="tex" alt="Q = I - 2 \mathbf{v}\mathbf{v}^T." src="http://upload.wikimedia.org/math/5/b/0/5b0b40e16b199d19944f0c1f5a929834.png" /></dd>
</dl>
<p>If, in case of complex matrix</p>
<dl>
<dd><img class="tex" alt="Q = I - (1+w)\mathbf{v}\mathbf{v}^H, where...  \mathbf{w} = \mathbf{x}^H\mathbf{v}\mathbf{/}\mathbf{v}^H\mathbf{x} " src="http://upload.wikimedia.org/math/3/4/f/34f4f7ce8e0422e6b03d6ba59cbaae54.png" /></dd>
<dd><img class="tex" alt=" \mathbf{x}^H." src="http://upload.wikimedia.org/math/8/5/4/854ad7c9176bd048a6e35499eff50ded.png" /> is Transpos and conjugate matrix of <img class="tex" alt=" \mathbf{x}." src="http://upload.wikimedia.org/math/d/9/4/d94edc126e1d335b3f07b247b6a23efb.png" /></dd>
</dl>
<p><br />
<span class="texhtml"><i>Q</i></span> is a Householder matrix and</p>
<dl>
<dd><img class="tex" alt="Qx = (\alpha, 0, \cdots, 0)^T.\," src="http://upload.wikimedia.org/math/7/0/d/70dd3c2c768e5c85892cc5cada32bd84.png" /></dd>
</dl>
<p>This can be used to gradually transform an <i>m</i>-by-<i>n</i> matrix <i>A</i> to upper <a href="/wiki/Triangular" title="Triangular" class="mw-redirect">triangular</a> form. First, we multiply <i>A</i> with the Householder matrix <i>Q</i><sub>1</sub> we obtain when we choose the first matrix column for <b>x</b>. This results in a matrix <i>Q</i><sub>1</sub><i>A</i> with zeros in the left column (except for the first row).</p>
<dl>
<dd><img class="tex" alt="Q_1A = \begin{bmatrix}
                   \alpha_1&amp;\star&amp;\dots&amp;\star\\
                      0    &amp;     &amp;     &amp;    \\
                   \vdots  &amp;     &amp;  A' &amp;    \\
                      0    &amp;     &amp;     &amp; \end{bmatrix}" src="http://upload.wikimedia.org/math/9/d/8/9d82239d57d58c6dc58ae0679d6330fc.png" /></dd>
</dl>
<p>This can be repeated for <i>A</i>′ (obtained from <i>Q</i><sub>1</sub><i>A</i> by deleting the first row and first column), resulting in a Householder matrix <i>Q</i>′<sub>2</sub>. Note that <i>Q</i>′<sub>2</sub> is smaller than <i>Q</i><sub>1</sub>. Since we want it really to operate on <i>Q</i><sub>1</sub><i>A</i> instead of <i>A</i>′ we need to expand it to the upper left, filling in a 1, or in general:</p>
<dl>
<dd><img class="tex" alt="Q_k = \begin{pmatrix}
                  I_{k-1} &amp; 0\\
                   0  &amp; Q_k'\end{pmatrix}." src="http://upload.wikimedia.org/math/8/8/b/88ba89097eee8fd169cb196c413008cf.png" /></dd>
</dl>
<p>After <span class="texhtml"><i>t</i></span> iterations of this process, <span class="texhtml"><i>t</i> = min(<i>m</i> − 1,<i>n</i>)</span>,</p>
<dl>
<dd><img class="tex" alt=" R = Q_t \cdots Q_2Q_1A" src="http://upload.wikimedia.org/math/4/3/0/4301f3ff863f40032ea96141d4f9f45d.png" /></dd>
</dl>
<p>is a upper triangular matrix. So, with</p>
<dl>
<dd><img class="tex" alt=" Q = Q_1^T Q_2^T \cdots Q_t^T, " src="http://upload.wikimedia.org/math/b/1/8/b18605a834a5e0d2d06c71198dbccd55.png" /></dd>
</dl>
<p><span class="texhtml"><i>A</i> = <i>Q</i><i>R</i></span> is a QR decomposition of <span class="texhtml"><i>A</i></span>.</p>
<p>This method has greater <a href="/wiki/Numerical_stability" title="Numerical stability">numerical stability</a> than the Gram-Schmidt method above.</p>
<p>The following table gives the number of operations in the k-th step of the QR-Decomposition by the Householder transformation, assuming a square matrix with size <i>n</i>.</p>
<table class="wikitable">
<tr>
<th>Operation</th>
<th>Number of operations in the k-th step</th>
</tr>
<tr>
<td>multiplications</td>
<td><span class="texhtml">2(<i>n</i> − <i>k</i> + 1)<sup>2</sup></span></td>
</tr>
<tr>
<td>additions</td>
<td><span class="texhtml">(<i>n</i> − <i>k</i> + 1)<sup>2</sup> + (<i>n</i> − <i>k</i> + 1)(<i>n</i> − <i>k</i>) + 2</span></td>
</tr>
<tr>
<td>division</td>
<td><span class="texhtml">1</span></td>
</tr>
<tr>
<td>square root</td>
<td><span class="texhtml">1</span></td>
</tr>
</table>
<p>Summing these numbers over the <span class="texhtml">(<i>n</i> − 1)</span> steps (for a square matrix of size <i>n</i>), the complexity of the algorithm (in terms of floating point multiplications) is given by</p>
<dl>
<dd><img class="tex" alt="\frac{2}{3}n^3+n^2+\frac{1}{3}n-2=O(n^3)" src="http://upload.wikimedia.org/math/1/0/c/10ce0d42cc07d92f73d7367edf0d846d.png" /></dd>
</dl>
<p><a name="Example_2" id="Example_2"></a></p>
<h4><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=7" title="Edit section: Example">edit</a>]</span> <span class="mw-headline">Example</span></h4>
<p>Let us calculate the decomposition of</p>
<dl>
<dd><img class="tex" alt="A = \begin{pmatrix}
12 &amp; -51 &amp; 4 \\
6 &amp; 167 &amp; -68 \\
-4 &amp; 24 &amp; -41 \end{pmatrix}." src="http://upload.wikimedia.org/math/a/3/d/a3d7f42c13a2dca10a0d75e4a181b763.png" /></dd>
</dl>
<p>First, we need to find a reflection that transforms the first column of matrix <i>A</i>, vector <img class="tex" alt="\mathbf{a}_1 = (12, 6, -4)^T" src="http://upload.wikimedia.org/math/e/e/0/ee05ccb957b61579c954d36051730a9e.png" />, to <img class="tex" alt="\|\mathbf{a}_1\| \;\mathrm{e}_1 = (14, 0, 0)^T." src="http://upload.wikimedia.org/math/8/3/b/83b169647badcaa37daf931bcb997abf.png" /></p>
<p>Now,</p>
<dl>
<dd><img class="tex" alt="\mathbf{u} = \mathbf{x} - \alpha\mathbf{e}_1," src="http://upload.wikimedia.org/math/b/4/5/b45d27817481e8920b3a3840672e09bf.png" /></dd>
</dl>
<p>and</p>
<dl>
<dd><img class="tex" alt="\mathbf{v} = {\mathbf{u}\over\|\mathbf{u}\|}." src="http://upload.wikimedia.org/math/2/5/b/25bfac07b9a8a2c63a99d303bea4459f.png" /></dd>
</dl>
<p>Here,</p>
<dl>
<dd><span class="texhtml">α = 14</span> and <img class="tex" alt="\mathbf{x} = \mathbf{a}_1 = (12, 6, -4)^T" src="http://upload.wikimedia.org/math/f/6/8/f68f453d5ab5602a39ea22be6eb8d182.png" /></dd>
</dl>
<p>Therefore</p>
<dl>
<dd><img class="tex" alt="\mathbf{u} = (-2, 6, -4)^T=({2})(-1, 3, -2)^T" src="http://upload.wikimedia.org/math/9/6/2/962c9d7f6fb6936e18932bb1591391ba.png" /> and <img class="tex" alt="\mathbf{v} = ({2 \over \sqrt{14}}){1 \over \sqrt{14}}(-1, 3, -2)^T" src="http://upload.wikimedia.org/math/b/7/d/b7d2d76ab11f3fba57897da9d05aa0e3.png" />, and then</dd>
<dd><img class="tex" alt="Q_1 = I - {2 \over \sqrt{14} \sqrt{14}} \begin{pmatrix} -1 \\ 3 \\ -2 \end{pmatrix}\begin{pmatrix} -1 &amp; 3 &amp; -2 \end{pmatrix}" src="http://upload.wikimedia.org/math/b/a/0/ba0873e43cf696fa9a3149414fe7b2b7.png" /></dd>
<dd><img class="tex" alt=" = I - {1 \over 7}\begin{pmatrix}
1 &amp; -3  &amp; 2 \\
-3 &amp; 9 &amp; -6 \\
2  &amp; -6  &amp; 4 
\end{pmatrix}" src="http://upload.wikimedia.org/math/4/e/7/4e7bddb184f7190caea6d96e3277d61e.png" /></dd>
<dd><img class="tex" alt=" = \begin{pmatrix}
6/7 &amp; 3/7   &amp;  -2/7 \\
3/7  &amp;-2/7  &amp;  6/7 \\
-2/7 &amp; 6/7  &amp;   3/7 \\
\end{pmatrix}." src="http://upload.wikimedia.org/math/0/3/d/03dbbbfd412a60e29903677aff4aedeb.png" /></dd>
</dl>
<p>Now observe:</p>
<dl>
<dd><img class="tex" alt="Q_1A = \begin{pmatrix}
14 &amp; 21 &amp; -14 \\
0 &amp; -49 &amp; -14 \\
0 &amp; 168 &amp; -77 \end{pmatrix}," src="http://upload.wikimedia.org/math/4/f/7/4f71b8e9a776e979b3fc6b9995ee48fa.png" /></dd>
</dl>
<p>so we already have almost a triangular matrix. We only need to zero the (3, 2) entry.</p>
<p>Take the (1, 1) <a href="/wiki/Minor_(linear_algebra)" title="Minor (linear algebra)">minor</a>, and then apply the process again to</p>
<dl>
<dd><img class="tex" alt="A' = M_{11} = \begin{pmatrix}
-49 &amp; -14 \\
168 &amp; -77 \end{pmatrix}." src="http://upload.wikimedia.org/math/c/2/4/c24a2e6cf8d76540ac58d21f65ace91b.png" /></dd>
</dl>
<p>By the same method as above, we obtain the matrix of the Householder transformation</p>
<dl>
<dd><img class="tex" alt="Q_2 = \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; -7/25 &amp; 24/25 \\
0 &amp; 24/25 &amp; 7/25 \end{pmatrix}" src="http://upload.wikimedia.org/math/d/1/4/d148fc0322308e6cf0d94695bd794d06.png" /></dd>
</dl>
<p>after performing a direct sum with 1 to make sure the next step in the process works properly.</p>
<p>Now, we find</p>
<dl>
<dd><img class="tex" alt="Q=Q_1^T Q_2^T=\begin{pmatrix}
6/7 &amp; -69/175 &amp; 58/175\\
3/7 &amp; 158/175 &amp; -6/175 \\
-2/7 &amp; 6/35 &amp; 33/35
\end{pmatrix} " src="http://upload.wikimedia.org/math/9/9/b/99b8cba416796deb28777f9c1d5206e1.png" /></dd>
<dd><img class="tex" alt="R=Q_2Q_1A=Q^T A=\begin{pmatrix}
14 &amp; 21 &amp; -14 \\
0 &amp; 175 &amp; -70 \\
0 &amp; 0 &amp; -35
\end{pmatrix}." src="http://upload.wikimedia.org/math/5/9/8/5982a2083169bbfb2959611774d6666c.png" /></dd>
</dl>
<p>The matrix <i>Q</i> is orthogonal and <i>R</i> is upper triangular, so <i>A</i> = <i>QR</i> is the required QR-decomposition.</p>
<p><a name="Using_Givens_rotations" id="Using_Givens_rotations"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=8" title="Edit section: Using Givens rotations">edit</a>]</span> <span class="mw-headline">Using Givens rotations</span></h3>
<p><i>QR</i> decompositions can also be computed with a series of <a href="/wiki/Givens_rotation" title="Givens rotation">Givens rotations</a>. Each rotation zeros an element in the subdiagonal of the matrix, forming the <i>R</i> matrix. The concatenation of all the Givens rotations forms the orthogonal <i>Q</i> matrix.</p>
<p>In practice, Givens rotations are not actually performed by building a whole matrix and doing a matrix multiplication. A Givens rotation procedure is used instead which does the equivalent of the sparse Givens matrix multiplication, without the extra work of handling the sparse elements. The Givens rotation procedure is useful in situations where only a relatively few off diagonal elements need to be zeroed, and is more easily parallelized than Householder transformations.</p>
<p><a name="Example_3" id="Example_3"></a></p>
<h4><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=9" title="Edit section: Example">edit</a>]</span> <span class="mw-headline">Example</span></h4>
<p>Let us calculate the decomposition of</p>
<dl>
<dd><img class="tex" alt="A = \begin{pmatrix}
12 &amp; -51 &amp; 4 \\
6 &amp; 167 &amp; -68 \\
-4 &amp; 24 &amp; -41 \end{pmatrix}." src="http://upload.wikimedia.org/math/a/3/d/a3d7f42c13a2dca10a0d75e4a181b763.png" /></dd>
</dl>
<p>First, we need to form a rotation matrix that will zero the lowermost left element, <img class="tex" alt="\mathbf{a}_{31} = -4" src="http://upload.wikimedia.org/math/2/e/7/2e7480f3b31c824e60ab78df7d263c7a.png" />. We form this matrix using the <a href="/wiki/Givens_rotation" title="Givens rotation">Givens rotation</a> method, and call the matrix <span class="texhtml"><i>G</i><sub>1</sub></span>. We will first rotate the vector <span class="texhtml">(6, − 4)</span>, to point along the <i>X</i> axis. This vector has an angle <img class="tex" alt="\theta = \arctan({-4 \over 6})" src="http://upload.wikimedia.org/math/d/e/0/de00aadee0a003be365c757b1597bd36.png" />. We create the orthogonal Givens rotation matrix, <span class="texhtml"><i>G</i><sub>1</sub></span>:</p>
<dl>
<dd><img class="tex" alt="G_1 = \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; \cos(\theta) &amp; \sin(\theta) \\
0 &amp; -\sin(\theta) &amp; \cos(\theta)
\end{pmatrix}" src="http://upload.wikimedia.org/math/b/1/c/b1c4882e9fb15adae065cb73eec53003.png" /></dd>
<dd><img class="tex" alt="\approx \begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 0.83205 &amp; -0.55470 \\
0 &amp; 0.55470 &amp; 0.83205
\end{pmatrix}" src="http://upload.wikimedia.org/math/4/7/3/4739528c1ff9314333ffda04e8205413.png" /></dd>
</dl>
<p>And the result of <span class="texhtml"><i>G</i><sub>1</sub><i>A</i></span> now has a zero in the <img class="tex" alt="\mathbf{a}_{31}" src="http://upload.wikimedia.org/math/d/6/4/d6456cfb89b452fc59b153df7f855bf5.png" /> element.</p>
<dl>
<dd><img class="tex" alt="G_1A \approx \begin{pmatrix}
12 &amp; -51 &amp; 4 \\
7.21110 &amp; 125.6396 &amp; -33.83671 \\
0 &amp; 112.6041 &amp; -71.83368
\end{pmatrix}" src="http://upload.wikimedia.org/math/6/f/a/6faa0fa23a91900e8b2b14a1a495ce28.png" /></dd>
</dl>
<p>We can similarly form Givens matrices <span class="texhtml"><i>G</i><sub>2</sub></span> and <span class="texhtml"><i>G</i><sub>3</sub></span>, which will zero the sub-diagonal elements <span class="texhtml"><i>a</i><sub>21</sub></span> and <span class="texhtml"><i>a</i><sub>32</sub></span>, forming a triangular matrix <span class="texhtml"><i>R</i></span>. The orthogonal matrix <span class="texhtml"><i>Q</i><sup><i>T</i></sup></span> is formed from the concatenation of all the Givens matrices <span class="texhtml"><i>Q</i><sup><i>T</i></sup> = <i>G</i><sub>3</sub><i>G</i><sub>2</sub><i>G</i><sub>1</sub></span>. Thus, we have <span class="texhtml"><i>G</i><sub>3</sub><i>G</i><sub>2</sub><i>G</i><sub>1</sub><i>A</i> = <i>Q</i><sup><i>T</i></sup><i>A</i> = <i>R</i></span>, and the <i>QR</i> decomposition is <span class="texhtml"><i>A</i> = <i>Q</i><i>R</i></span>.</p>
<p><a name="Connection_to_a_determinant_or_a_product_of_eigenvalues" id="Connection_to_a_determinant_or_a_product_of_eigenvalues"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=10" title="Edit section: Connection to a determinant or a product of eigenvalues">edit</a>]</span> <span class="mw-headline">Connection to a determinant or a product of eigenvalues</span></h2>
<p>We can use QR decomposition to find the absolute value of the <a href="/wiki/Determinant" title="Determinant">determinant</a> of a square matrix. Suppose a matrix is decomposed as <span class="texhtml"><i>A</i> = <i>Q</i><i>R</i></span>. Then we have</p>
<dl>
<dd><img class="tex" alt="\det(A)=\det(Q)\cdot\det(R)." src="http://upload.wikimedia.org/math/f/2/4/f24eb20f66d9f612badcd407383d8dfb.png" /></dd>
</dl>
<p>Since <i>Q</i> is unitary, <span class="texhtml">| det(<i>Q</i>) | = 1</span>. Thus,</p>
<dl>
<dd><img class="tex" alt="|\det(A)|=|\det(R)|=\Big|\prod_{i} r_{ii}\Big|," src="http://upload.wikimedia.org/math/5/9/3/5937d99a6504ab19081268d93b7000db.png" /></dd>
</dl>
<p>where <span class="texhtml"><i>r</i><sub><i>i</i><i>i</i></sub></span> are the entries on the diagonal of <i>R</i>.</p>
<p>Furthermore, because the determinant equals the product of the eigenvalues, we have</p>
<dl>
<dd><img class="tex" alt="\Big|\prod_{i} r_{ii}\Big|=\Big|\prod_{i} \lambda_{i}\Big|," src="http://upload.wikimedia.org/math/3/e/c/3ec498df2b9c6223eeea94e29b8b7998.png" /></dd>
</dl>
<p>where <span class="texhtml">λ<sub><i>i</i></sub></span> are eigenvalues of <span class="texhtml"><i>A</i></span>.</p>
<p>We can extend the above properties to non-square complex matrix <span class="texhtml"><i>A</i></span> by introducing the definition of QR-decomposition for non-square complex matrix and replacing eigenvalues with singular values.</p>
<p>Suppose a QR decomposition for a non-square matrix <i>A</i>:</p>
<dl>
<dd><img class="tex" alt="A = Q \begin{pmatrix}R\\O\end{pmatrix}, \qquad Q^*Q = I," src="http://upload.wikimedia.org/math/8/1/b/81bc97dca5d4603a6a60b5acc0205a15.png" /></dd>
</dl>
<p>where <span class="texhtml"><i>O</i></span> is a zero matrix and <span class="texhtml"><i>Q</i></span> is an unitary matrix.</p>
<p>From the properties of <a href="/wiki/Singular_value_decomposition" title="Singular value decomposition">SVD</a> and determinant of matrix, we have</p>
<dl>
<dd><img class="tex" alt="\Big|\prod_{i} r_{ii}\Big| = \prod_{i} \sigma_{i}," src="http://upload.wikimedia.org/math/d/4/4/d44a99e8cc70849a9e88f0aab1ba6ab1.png" /></dd>
</dl>
<p>where <span class="texhtml">σ<sub><i>i</i></sub></span> are singular values of <span class="texhtml"><i>A</i></span>.</p>
<p>Note that the singular values of <span class="texhtml"><i>A</i></span> and <span class="texhtml"><i>R</i></span> are identical, although the complex eigenvalues of them may be different. However, if <i>A</i> is square, it holds that</p>
<dl>
<dd><img class="tex" alt="
{\prod_{i} \sigma_{i}} = \Big|{\prod_{i} \lambda_{i}}\Big|.
" src="http://upload.wikimedia.org/math/2/0/f/20f782a9214ff74fa0a883feddc9e987.png" /></dd>
</dl>
<p>In conclusion, QR decomposition can be used efficiently to calculate a product of eigenvalues or singular values of matrix.</p>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=11" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/Polar_decomposition" title="Polar decomposition">Polar decomposition</a></li>
<li><a href="/wiki/Eigenvalue_decomposition" title="Eigenvalue decomposition" class="mw-redirect">Eigenvalue decomposition</a></li>
<li><a href="/wiki/Spectral_decomposition" title="Spectral decomposition" class="mw-redirect">Spectral decomposition</a></li>
<li><a href="/wiki/Matrix_decomposition" title="Matrix decomposition">Matrix decomposition</a></li>
<li><a href="/wiki/Zappa-Sz%C3%A9p_product#Examples" title="Zappa-Szép product">Zappa-Szép product</a></li>
</ul>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=12" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ul>
<li><cite style="font-style:normal" class="" id="CITEREFGolubVan_Loan1996"><a href="/wiki/Gene_H._Golub" title="Gene H. Golub">Golub, Gene H.</a>; <a href="/wiki/Charles_F._Van_Loan" title="Charles F. Van Loan">Van Loan, Charles F.</a> (1996), <i>Matrix Computations</i> (3rd ed.), Johns Hopkins, <a href="/wiki/Special:BookSources/9780801854149" class="internal">ISBN 978-0-8018-5414-9</a></cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=Matrix+Computations&amp;rft.aulast=Golub&amp;rft.aufirst=Gene+H.&amp;rft.au=Golub%2C+Gene+H.&amp;rft.au=Van+Loan%2C+Charles+F.&amp;rft.date=1996&amp;rft.edition=3rd&amp;rft.pub=Johns+Hopkins&amp;rft.isbn=978-0-8018-5414-9&amp;rfr_id=info:sid/en.wikipedia.org:QR_decomposition"><span style="display: none;">&#160;</span></span>.</li>
<li><cite style="font-style:normal" class="" id="CITEREFHornJohnson1985">Horn, Roger A.; Johnson, Charles R. (1985), <i>Matrix Analysis</i>, Cambridge University Press, <a href="/wiki/Special:BookSources/0521386322" class="internal">ISBN 0-521-38632-2</a></cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=Matrix+Analysis&amp;rft.aulast=Horn&amp;rft.aufirst=Roger+A.&amp;rft.au=Horn%2C+Roger+A.&amp;rft.au=Johnson%2C+Charles+R.&amp;rft.date=1985&amp;rft.pub=Cambridge+University+Press&amp;rft.isbn=0-521-38632-2&amp;rfr_id=info:sid/en.wikipedia.org:QR_decomposition"><span style="display: none;">&#160;</span></span>. Section 2.8.</li>
<li><cite style="font-style:normal" class="" id="CITEREFStoerBulirsch2002">Stoer, Josef; Bulirsch, Roland (2002), <i>Introduction to Numerical Analysis</i> (3rd ed.), Springer, <a href="/wiki/Special:BookSources/038795452X" class="internal">ISBN 0-387-95452-X</a></cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=Introduction+to+Numerical+Analysis&amp;rft.aulast=Stoer&amp;rft.aufirst=Josef&amp;rft.au=Stoer%2C+Josef&amp;rft.au=Bulirsch%2C+Roland&amp;rft.date=2002&amp;rft.edition=3rd&amp;rft.pub=Springer&amp;rft.isbn=0-387-95452-X&amp;rfr_id=info:sid/en.wikipedia.org:QR_decomposition"><span style="display: none;">&#160;</span></span>.</li>
<li><cite style="font-style:normal" class="" id="CITEREFMezzadri2007">Mezzadri, Francesco (May 2007), "<a href="http://www.ams.org/notices/200705/fea-mezzadri-web.pdf" class="external text" title="http://www.ams.org/notices/200705/fea-mezzadri-web.pdf" rel="nofollow">How to Generate Random Matrices from the Classical Compact Groups</a>", <i>Notices</i> (AMS) <b>54</b> (5): 592–604, <a href="/wiki/ArXiv" title="ArXiv">arΧiv</a>:<a href="http://arxiv.org/abs/math-ph/0609050" class="extiw" title="arxiv:math-ph/0609050">math-ph/0609050</a><span class="printonly">, <a href="http://www.ams.org/notices/200705/fea-mezzadri-web.pdf" class="external free" title="http://www.ams.org/notices/200705/fea-mezzadri-web.pdf" rel="nofollow">http://www.ams.org/notices/200705/fea-mezzadri-web.pdf</a></span></cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.atitle=How+to+Generate+Random+Matrices+from+the+Classical+Compact+Groups&amp;rft.jtitle=Notices&amp;rft.aulast=Mezzadri&amp;rft.aufirst=Francesco&amp;rft.au=Mezzadri%2C+Francesco&amp;rft.date=May+2007&amp;rft.volume=54&amp;rft.issue=5&amp;rft.pages=592%E2%80%93604&amp;rft.pub=AMS&amp;rft_id=http%3A%2F%2Fwww.ams.org%2Fnotices%2F200705%2Ffea-mezzadri-web.pdf&amp;rfr_id=info:sid/en.wikipedia.org:QR_decomposition"><span style="display: none;">&#160;</span></span>.</li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=QR_decomposition&amp;action=edit&amp;section=13" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.bluebit.gr/matrix-calculator/" class="external text" title="http://www.bluebit.gr/matrix-calculator/" rel="nofollow">Online Matrix Calculator</a> Performs QR decomposition of matrices.</li>
<li><a href="http://netlib.org/lapack/lug/node39.html" class="external text" title="http://netlib.org/lapack/lug/node39.html" rel="nofollow">LAPACK users manual</a> gives details of subroutines to calculate the QR decomposition</li>
<li><a href="http://documents.wolfram.com/mathematica/functions/QRDecomposition" class="external text" title="http://documents.wolfram.com/mathematica/functions/QRDecomposition" rel="nofollow">Mathematica users manual</a> gives details and examples of routines to calculate QR decomposition</li>
<li><a href="http://www.alglib.net/" class="external text" title="http://www.alglib.net/" rel="nofollow">ALGLIB</a> includes a partial port of the LAPACK to C++, C#, Delphi, etc.</li>
</ul>


<!-- 
NewPP limit report
Preprocessor node count: 2655/1000000
Post-expand include size: 15344/2048000 bytes
Template argument size: 3335/2048000 bytes
Expensive parser function count: 0/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:305223-0!1!0!default!!en!2 and timestamp 20090406115743 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/QR_decomposition">http://en.wikipedia.org/wiki/QR_decomposition</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Matrix_theory" title="Category:Matrix theory">Matrix theory</a></span> | <span dir='ltr'><a href="/wiki/Category:Numerical_linear_algebra" title="Category:Numerical linear algebra">Numerical linear algebra</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/QR_decomposition" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:QR_decomposition" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=QR_decomposition&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=QR_decomposition&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=QR_decomposition" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/QR_decomposition" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/QR_decomposition" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=QR_decomposition&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=QR_decomposition&amp;oldid=282092158" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=QR_decomposition&amp;id=282092158">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-de"><a href="http://de.wikipedia.org/wiki/QR-Zerlegung">Deutsch</a></li>
				<li class="interwiki-es"><a href="http://es.wikipedia.org/wiki/Descomposici%C3%B3n_QR">Español</a></li>
				<li class="interwiki-fr"><a href="http://fr.wikipedia.org/wiki/D%C3%A9composition_QR">Français</a></li>
				<li class="interwiki-it"><a href="http://it.wikipedia.org/wiki/Decomposizione_QR">Italiano</a></li>
				<li class="interwiki-ja"><a href="http://ja.wikipedia.org/wiki/QR%E5%88%86%E8%A7%A3">日本語</a></li>
				<li class="interwiki-ro"><a href="http://ro.wikipedia.org/wiki/Descompunerea_QR">Română</a></li>
				<li class="interwiki-fi"><a href="http://fi.wikipedia.org/wiki/QR-hajotelma">Suomi</a></li>
				<li class="interwiki-sv"><a href="http://sv.wikipedia.org/wiki/QR-faktorisering">Svenska</a></li>
				<li class="interwiki-uk"><a href="http://uk.wikipedia.org/wiki/QR_%D1%80%D0%BE%D0%B7%D0%BA%D0%BB%D0%B0%D0%B4_%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D1%96">Українська</a></li>
				<li class="interwiki-zh"><a href="http://zh.wikipedia.org/wiki/QR%E5%88%86%E8%A7%A3">中文</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 6 April 2009, at 11:51 (UTC).</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv200 in 0.037 secs. --></body></html>
