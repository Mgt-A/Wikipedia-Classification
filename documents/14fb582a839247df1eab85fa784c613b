<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="Parsing expression grammar,Articles with unsourced statements since February 2007,Ambiguous,Ambiguous grammar,Analytic grammar,Backtracking,Backus-Naur form,Commutativity,Comparison of parser generators,Constructed language,Context-free grammar" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Parsing expression grammar - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Parsing_expression_grammar";
		var wgTitle = "Parsing expression grammar";
		var wgAction = "view";
		var wgArticleId = "892899";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 284092395;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Parsing_expression_grammar skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">Parsing expression grammar</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p>A <b>parsing expression grammar</b>, or <b>PEG</b>, is a type of <a href="/wiki/Analytic_grammar" title="Analytic grammar" class="mw-redirect">analytic</a> <a href="/wiki/Formal_grammar" title="Formal grammar">formal grammar</a> that describes a <a href="/wiki/Formal_language" title="Formal language">formal language</a> in terms of a set of rules for recognizing <a href="/wiki/String_(computer_science)" title="String (computer science)">strings</a> in the language. A parsing expression grammar essentially represents a <a href="/wiki/Recursive_descent_parser" title="Recursive descent parser">recursive descent parser</a> in a pure schematic form that expresses only syntax and is independent of the way an actual parser might be implemented or what it might be used for. Parsing expression grammars look similar to <a href="/wiki/Regular_expression" title="Regular expression">regular expressions</a> or <a href="/wiki/Context-free_grammar" title="Context-free grammar">context-free grammars</a> (CFG) in <a href="/wiki/Backus-Naur_form" title="Backus-Naur form" class="mw-redirect">Backus-Naur form</a> (BNF) notation, but have a different interpretation.</p>
<p>Unlike CFGs, PEGs cannot be <a href="/wiki/Ambiguous_grammar" title="Ambiguous grammar">ambiguous</a>; if a string parses, it has exactly one valid <a href="/wiki/Parse_tree" title="Parse tree">parse tree</a>. This suits PEGs well to parsing computer languages, but not <a href="/wiki/Natural_language" title="Natural language">natural languages</a>.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Definition"><span class="tocnumber">1</span> <span class="toctext">Definition</span></a>
<ul>
<li class="toclevel-2"><a href="#Interpretation_of_parsing_expressions"><span class="tocnumber">1.1</span> <span class="toctext">Interpretation of parsing expressions</span></a></li>
<li class="toclevel-2"><a href="#Examples"><span class="tocnumber">1.2</span> <span class="toctext">Examples</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Implementing_parsers_from_parsing_expression_grammars"><span class="tocnumber">2</span> <span class="toctext">Implementing parsers from parsing expression grammars</span></a></li>
<li class="toclevel-1"><a href="#Advantages"><span class="tocnumber">3</span> <span class="toctext">Advantages</span></a></li>
<li class="toclevel-1"><a href="#Disadvantages"><span class="tocnumber">4</span> <span class="toctext">Disadvantages</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">5</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">6</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">7</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Definition" id="Definition"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=1" title="Edit section: Definition">edit</a>]</span> <span class="mw-headline">Definition</span></h2>
<p>Formally, a parsing expression grammar consists of:</p>
<ul>
<li>A finite set <i>N</i> of <i><a href="/wiki/Nonterminal_symbol" title="Nonterminal symbol" class="mw-redirect">nonterminal symbols</a></i>.</li>
<li>A finite set Î£ of <i><a href="/wiki/Terminal_symbol" title="Terminal symbol" class="mw-redirect">terminal symbols</a></i> that is disjoint from <i>N</i>.</li>
<li>A finite set <i>P</i> of <i>parsing rules</i>.</li>
<li>An expression <i>e<sub>S</sub></i> termed the <i>starting expression</i>.</li>
</ul>
<p>Each parsing rule in <i>P</i> has the form <i>A</i> â <i>e</i>, where <i>A</i> is a nonterminal symbol and <i>e</i> is a <i>parsing expression</i>. A parsing expression is a hierarchical <a href="/wiki/Expression_(mathematics)" title="Expression (mathematics)">expression</a> similar to a <a href="/wiki/Regular_expression" title="Regular expression">regular expression</a>, which is constructed in the following fashion:</p>
<ol>
<li>An <i>atomic parsing expression</i> consists of:
<ul>
<li>any terminal symbol,</li>
<li>any nonterminal symbol, or</li>
<li>the empty string Îµ.</li>
</ul>
</li>
<li>Given any existing parsing expressions <i>e</i>, <i>e</i><sub>1</sub>, and <i>e</i><sub>2</sub>, a new parsing expression can be constructed using the following operators:
<ul>
<li><i>Sequence</i>: <i>e</i><sub>1</sub> <i>e</i><sub>2</sub></li>
<li><i>Ordered choice</i>: <i>e</i><sub>1</sub> / <i>e</i><sub>2</sub></li>
<li><i>Zero-or-more</i>: <i>e</i>*</li>
<li><i>One-or-more</i>: <i>e</i>+</li>
<li><i>Optional</i>: <i>e</i>?</li>
<li><i>And-predicate</i>: &amp;<i>e</i></li>
<li><i>Not-predicate</i>:&#160;!<i>e</i></li>
</ul>
</li>
</ol>
<p>The key difference between <a href="/wiki/Context-free_grammars" title="Context-free grammars" class="mw-redirect">context-free grammars</a> and parsing expression grammars is that the PEG's choice operator is <i>ordered</i>. If the first alternative succeeds, the second alternative <i>is ignored</i>. Thus ordered choice is not <a href="/wiki/Commutativity" title="Commutativity">commutative</a>, unlike textbook definitions of context-free grammars and regular expressions. Ordered choice is analogous to soft <a href="/wiki/Cut_(logic_programming)" title="Cut (logic programming)">cut</a> operators available in some <a href="/wiki/Logic_programming" title="Logic programming">logic programming</a> languages.</p>
<p>Unlike in a <a href="/wiki/Context-free_grammar" title="Context-free grammar">context-free grammar</a> or other <a href="/wiki/Generative_grammar" title="Generative grammar">generative grammars</a>, in a parsing expression grammar there must be <i>exactly one rule</i> in the grammar having a given nonterminal on its left-hand side. That is, rules act as <i>definitions</i> in a PEG, and each nonterminal must have one and only one definition.</p>
<p>The consequence is that if a CFG is transliterated directly to a PEG, any ambiguity in the former is resolved by deterministically picking one parse tree from the possible parses. By carefully choosing the order in which the grammar alternatives are specified, a programmer has a great deal of control over which parse tree is selected.</p>
<p><a name="Interpretation_of_parsing_expressions" id="Interpretation_of_parsing_expressions"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=2" title="Edit section: Interpretation of parsing expressions">edit</a>]</span> <span class="mw-headline">Interpretation of parsing expressions</span></h3>
<p>Each nonterminal in a parsing expression grammar essentially represents a parsing <a href="/wiki/Function_(mathematics)" title="Function (mathematics)">function</a> in a <a href="/wiki/Recursive_descent_parser" title="Recursive descent parser">recursive descent parser</a>, and the corresponding parsing expression represents the "code" comprising the function. Each parsing function conceptually takes an input string as its argument, and yields one of the following results:</p>
<ul>
<li><i>success</i>, in which the function may optionally move forward or "consume" one or more characters of the input string supplied to it, or</li>
<li><i>failure</i>, in which case no input is consumed.</li>
</ul>
<p>A nonterminal may succeed without actually consuming any input, and this is considered an outcome distinct from failure.</p>
<p>An atomic parsing expression consisting of a single terminal succeeds if the first character of the input string matches that terminal, and in that case consumes the input character; otherwise the expression yields a failure result. An atomic parsing expression consisting of the empty string always trivially succeeds without consuming any input. An atomic parsing expression consisting of a nonterminal <i>A</i> represents a <a href="/wiki/Recursion" title="Recursion">recursive</a> call to the nonterminal-function <i>A</i>.</p>
<p>The sequence operator <i>e</i><sub>1</sub> <i>e</i><sub>2</sub> first invokes <i>e</i><sub>1</sub>, and if <i>e</i><sub>1</sub> succeeds, subsequently invokes <i>e</i><sub>2</sub> on the remainder of the input string left unconsumed by <i>e</i><sub>1</sub>, and returns the result. If either <i>e</i><sub>1</sub> or <i>e</i><sub>2</sub> fails, then the sequence expression <i>e</i><sub>1</sub> <i>e</i><sub>2</sub> fails.</p>
<p>The choice operator <i>e</i><sub>1</sub> / <i>e</i><sub>2</sub> first invokes <i>e</i><sub>1</sub>, and if <i>e</i><sub>1</sub> succeeds, returns its result immediately. Otherwise, if <i>e</i><sub>1</sub> fails, then the choice operator <a href="/wiki/Backtracking" title="Backtracking">backtracks</a> to the original input position at which it invoked <i>e</i><sub>1</sub>, but then calls <i>e</i><sub>2</sub> instead, returning <i>e</i><sub>2</sub>'s result.</p>
<p>The zero-or-more, one-or-more, and optional operators consume zero or more, one or more, or zero or one consecutive repetitions of their sub-expression <i>e</i>, respectively. Unlike in <a href="/wiki/Context-free_grammar" title="Context-free grammar">context-free grammars</a> and <a href="/wiki/Regular_expression" title="Regular expression">regular expressions</a>, however, these operators <i>always</i> behave <a href="/wiki/Greedy_algorithm" title="Greedy algorithm">greedily</a>, consuming as much input as possible and never backtracking. (Regular expressions start by matching greedily, but they backtrack and try shorter matches if they fail to match.) For example, the expression a* will always consume as many a's as are consecutively available in the input string, and the expression (a* a) will always fail because the first part (a*) will never leave any a's for the second part to match.</p>
<p>Finally, the and-predicate and not-predicate operators implement <a href="/wiki/Syntactic_predicate" title="Syntactic predicate">syntactic predicates</a>. The expression &amp;<i>e</i> invokes the sub-expression <i>e</i>, and then succeeds if <i>e</i> succeeds and fails if <i>e</i> fails, but in either case <i>never consumes any input</i>. Conversely, the expression&#160;!<i>e</i> succeeds if <i>e</i> fails and fails if <i>e</i> succeeds, again consuming no input in either case. Because these can use an arbitrarily complex sub-expression <i>e</i> to "look ahead" into the input string without actually consuming it, they provide a powerful syntactic <a href="/wiki/Lookahead" title="Lookahead">lookahead</a> and disambiguation facility.</p>
<p><a name="Examples" id="Examples"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=3" title="Edit section: Examples">edit</a>]</span> <span class="mw-headline">Examples</span></h3>
<p>This is a PEG that recognizes mathematical formulas that apply the basic four operations to non-negative integers.</p>
<dl>
<dd><i>Value</i> â [0-9]+ / '(' <i>Expr</i> ')'</dd>
<dd><i>Product</i> â <i>Value</i> (('*' / '/') <i>Value</i>)*</dd>
<dd><i>Sum</i> â <i>Product</i> (('+' / '-') <i>Product</i>)*</dd>
<dd><i>Expr</i> â <i>Sum</i></dd>
</dl>
<p>In the above example, the terminal symbols are characters of text, represented by characters in single quotes, such as <code>'('</code> and <code>')'</code>. The range <b><code>[0-9]</code></b> is also a shortcut for ten characters, indicating any one of the digits 0 through 9. (This range syntax is the same as the syntax used by <a href="/wiki/Regular_expression" title="Regular expression">regular expressions</a>.) The nonterminal symbols are the ones that expand to other rules: <i>Value</i>, <i>Product</i>, <i>Sum</i>, and <i>Expr</i>.</p>
<p>The examples below drop quotation marks in order to be easier to read. Lowercase letters are terminal symbols, while capital letters in italics are nonterminals. Actual PEG parsers would require the lowercase letters to be in quotes.</p>
<p>The parsing expression <b>(a/b)*</b> matches and consumes an arbitrary-length sequence of a's and b's. The rule <b><i>S</i> â a <i>S</i>? b</b> describes the simple <a href="/wiki/Context-free_language" title="Context-free language">context-free</a> "matching language" <img class="tex" alt=" \{ a^n b^n&#160;: n \ge 1 \} " src="http://upload.wikimedia.org/math/5/1/9/519944a32ffda65fefab106d7cdee9b2.png" />. The following parsing expression grammar describes the classic non-context-free language <img class="tex" alt=" \{ a^n b^n c^n&#160;: n \ge 1 \} " src="http://upload.wikimedia.org/math/0/7/9/07940b90bb6d1f016844981ffe8d83ad.png" />:</p>
<dl>
<dd><i>S</i> â &amp;(<i>A</i>&#160;!b) a+ <i>B</i>&#160;!(a/b/c)</dd>
<dd><i>A</i> â a <i>A</i>? b</dd>
<dd><i>B</i> â b <i>B</i>? c</dd>
</dl>
<p>The following recursive rule matches standard C-style if/then/else statements in such a way that the optional "else" clause always binds to the innermost "if", because of the implicit prioritization of the '/' operator. (In a <a href="/wiki/Context-free_grammar" title="Context-free grammar">context-free grammar</a>, this construct yields the classic <a href="/wiki/Dangling_else" title="Dangling else">dangling else</a> <a href="/wiki/Ambiguous" title="Ambiguous" class="mw-redirect">ambiguity</a>.)</p>
<dl>
<dd><i>S</i> â if <i>C</i> then <i>S</i> else <i>S</i> / if <i>C</i> then <i>S</i></dd>
</dl>
<p>The parsing expression <b>foo &amp;(bar)</b> matches and consumes the text "foo" but only if it is followed by the text "bar". The parsing expression <b>foo&#160;!(bar)</b> matches the text "foo" but only if it is <i>not</i> followed by the text "bar". The expression <b>!(a+ b) a</b> matches a single "a" but only if it is not the first in an arbitrarily-long sequence of a's followed by a b.</p>
<p>The following recursive rule matches Pascal-style nested comment syntax, (* which can (* nest *) like this *). The comment symbols appear in double quotes to distinguish them from PEG operators.</p>
<dl>
<dd><i>Begin</i> â "(*"</dd>
<dd><i>End</i> â "*)"</dd>
<dd><i>C</i> â <i>Begin</i> <i>N</i>* <i>End</i><br /></dd>
<dd><i>N</i> â <i>C</i> / (!<i>Begin</i>&#160;!<i>End</i> <i>Z</i>)<br /></dd>
<dd><i>Z</i> â <i>any single character</i><br /></dd>
</dl>
<p><a name="Implementing_parsers_from_parsing_expression_grammars" id="Implementing_parsers_from_parsing_expression_grammars"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=4" title="Edit section: Implementing parsers from parsing expression grammars">edit</a>]</span> <span class="mw-headline">Implementing parsers from parsing expression grammars</span></h2>
<p>Any parsing expression grammar can be converted directly into a <a href="/wiki/Recursive_descent_parser" title="Recursive descent parser">recursive descent parser</a><sup class="noprint Template-Fact"><span title="This claim needs references to reliable sources&#160;since February 2007" style="white-space: nowrap;">[<i><a href="/wiki/Wikipedia:Citation_needed" title="Wikipedia:Citation needed">citation needed</a></i>]</span></sup>. Due to the unlimited <a href="/wiki/Lookahead" title="Lookahead">lookahead</a> capability that the grammar formalism provides, however, the resulting parser could exhibit <a href="/wiki/Exponential_time" title="Exponential time">exponential time</a> performance in the worst case.</p>
<p>By <a href="/wiki/Memoization" title="Memoization">memoizing</a> the results of intermediate parsing steps and ensuring that each parsing function is only invoked at most once at a given input position, however, it is possible to convert any parsing expression grammar into a <i>packrat parser</i>, which always runs in <a href="/wiki/Linear_time" title="Linear time">linear time</a> at the cost of substantially greater storage space requirements.</p>
<p>A packrat parser<sup id="cite_ref-ford02_0-0" class="reference"><a href="#cite_note-ford02-0" title=""><span>[</span>1<span>]</span></a></sup> is a form of <a href="/wiki/Parsing" title="Parsing">parser</a> similar to a <a href="/wiki/Recursive_descent_parser" title="Recursive descent parser">recursive descent parser</a> in construction, except that during the parsing process it <a href="/wiki/Memoization" title="Memoization">memoizes</a> the intermediate results of all invocations of the <a href="/wiki/Mutual_recursion" title="Mutual recursion">mutually recursive</a> parsing functions. Because of this <a href="/wiki/Memoization" title="Memoization">memoization</a>, a packrat parser has the ability to parse many <a href="/wiki/Context-free_grammar" title="Context-free grammar">context-free grammars</a> and <i>any</i> parsing expression grammar (including some that do not represent context-free languages) in <a href="/wiki/Linear_time" title="Linear time">linear time</a>.</p>
<p>It is also possible to build <a href="/wiki/LL_parser" title="LL parser">LL parsers</a> and <a href="/wiki/LR_parser" title="LR parser">LR parsers</a> from parsing expression grammars, but the unlimited lookahead capability of the grammar formalism is lost in this case.</p>
<p><a name="Advantages" id="Advantages"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=5" title="Edit section: Advantages">edit</a>]</span> <span class="mw-headline">Advantages</span></h2>
<p>PEGs make a good replacement for <a href="/wiki/Regular_expressions" title="Regular expressions" class="mw-redirect">regular expressions</a>, because they are strictly more powerful. For example, a regular expression inherently cannot find matched pairs of parentheses, because it is not recursive, but a PEG can.</p>
<p>Any PEG can be parsed in linear time by using a packrat parser, as described above.</p>
<p>Parsers for languages expressed as a CFG, such as <a href="/wiki/LR_parser" title="LR parser">LR parsers</a>, require a separate <a href="/wiki/Tokenization" title="Tokenization" class="mw-redirect">tokenization</a> step to be done first, which breaks up the input based on the location of spaces, punctuation, etc. The tokenization is necessary because of the way these parsers use <i>lookahead</i> to parse CFGs that meet certain requirements in linear time. PEGs do not require tokenization to be a separate step, and tokenization rules can be written in the same way as any other grammar rule.</p>
<p>Many CFGs contain inherent ambiguities, even when they're intended to describe unambiguous languages. The "<a href="/wiki/Dangling_else" title="Dangling else">dangling else</a>" problem in C, C++, and Java is one example. These problems are often resolved by applying a rule outside of the grammar. In a PEG, these ambiguities never arise, because of prioritization.</p>
<p><a name="Disadvantages" id="Disadvantages"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=6" title="Edit section: Disadvantages">edit</a>]</span> <span class="mw-headline">Disadvantages</span></h2>
<p>PEGs are new and not widely implemented. In contrast, regular expressions and CFGs have been around for decades, the code to parse them has been extensively optimized, and many programmers are familiar with how to use them.</p>
<p>PEGs cannot express <i><a href="/wiki/Left_recursion" title="Left recursion">left-recursive</a></i> rules where a rule refers to itself without moving forward in the string. For example, in the arithmetic grammar above, it would be tempting to move some rules around so that the precedence order of products and sums could be expressed in one line:</p>
<dl>
<dd><i>Value</i> â [0-9.]+ / '(' <i>Expr</i> ')'</dd>
<dd><i>Product</i> â <i>Expr</i> (('*' / '/') <i>Expr</i>)*</dd>
<dd><i>Sum</i> â <i>Expr</i> (('+' / '-') <i>Expr</i>)*</dd>
<dd><i>Expr</i> â <i>Product</i> / <i>Sum</i> / <i>Value</i></dd>
</dl>
<p>The problem with this is that it says that to match an <tt>Expr</tt>, you need to first see if a <tt>Product</tt> matches there, and to match a <tt>Product</tt>, you need to first see if an <tt>Expr</tt> matches there. This is not possible.</p>
<p>However, left-recursive rules can always be rewritten to eliminate left-recursion. For example, a left-recursive rule can repeat a certain expression indefinitely, as in the CFG rule:</p>
<dl>
<dd><i>string-of-a</i> â <i>string-of-a</i> 'a' | 'a'</dd>
</dl>
<p>This can be rewritten in a PEG using the plus operator:</p>
<dl>
<dd><i>string-of-a</i> â 'a'+</dd>
</dl>
<p>PEGs are also associated with <i>packrat parsing</i>, which uses <a href="/wiki/Memoization" title="Memoization">memoization</a> to eliminate redundant parsing steps. Packrat parsing requires storage proportional to the total input size, rather than the depth of the parse tree as with LR parsers.<sup id="cite_ref-ford02_0-1" class="reference"><a href="#cite_note-ford02-0" title=""><span>[</span>1<span>]</span></a></sup> With some modification, traditional packrat parsing can be made to support left recursion. <sup id="cite_ref-warth08_1-0" class="reference"><a href="#cite_note-warth08-1" title=""><span>[</span>2<span>]</span></a></sup></p>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=7" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/Formal_grammar" title="Formal grammar">Formal grammar</a></li>
<li><a href="/wiki/Regular_expressions" title="Regular expressions" class="mw-redirect">Regular expressions</a></li>
<li><a href="/wiki/Top-down_parsing_language" title="Top-down parsing language">Top-down parsing language</a></li>
<li><a href="/wiki/Comparison_of_parser_generators" title="Comparison of parser generators">Comparison of parser generators</a></li>
<li><a href="/wiki/Parser_combinators" title="Parser combinators" class="mw-redirect">Parser combinators</a></li>
</ul>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=8" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<ol class="references">
<li id="cite_note-ford02-0">^ <a href="#cite_ref-ford02_0-0" title=""><sup><i><b>a</b></i></sup></a> <a href="#cite_ref-ford02_0-1" title=""><sup><i><b>b</b></i></sup></a> <cite style="font-style:normal" class="web" id="CITEREFFord2002">Ford, Bryan (September 2002). <a href="http://pdos.csail.mit.edu/~baford/packrat/thesis" class="external text" title="http://pdos.csail.mit.edu/~baford/packrat/thesis" rel="nofollow">"Packrat Parsing: a Practical Linear-Time Algorithm with Backtracking"</a>. Massachusetts Institute of Technology<span class="printonly">. <a href="http://pdos.csail.mit.edu/~baford/packrat/thesis" class="external free" title="http://pdos.csail.mit.edu/~baford/packrat/thesis" rel="nofollow">http://pdos.csail.mit.edu/~baford/packrat/thesis</a></span><span class="reference-accessdate">. Retrieved on 2007-07-27</span>.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=bookitem&amp;rft.btitle=Packrat+Parsing%3A+a+Practical+Linear-Time+Algorithm+with+Backtracking&amp;rft.atitle=&amp;rft.aulast=Ford&amp;rft.aufirst=Bryan&amp;rft.au=Ford%2C+Bryan&amp;rft.date=September+2002&amp;rft.pub=Massachusetts+Institute+of+Technology&amp;rft_id=http%3A%2F%2Fpdos.csail.mit.edu%2F%7Ebaford%2Fpackrat%2Fthesis&amp;rfr_id=info:sid/en.wikipedia.org:Parsing_expression_grammar"><span style="display: none;">&#160;</span></span></li>
<li id="cite_note-warth08-1"><b><a href="#cite_ref-warth08_1-0" title="">^</a></b> <cite style="font-style:normal" class="" id="CITEREFAlessandro_Warth.2C_James_R._Douglass.2C_Todd_Millstein2008">Alessandro Warth, James R. Douglass, Todd Millstein (January 2008) (<a href="/wiki/PDF" title="PDF" class="mw-redirect">PDF</a>). <i><a href="http://www.vpri.org/pdf/tr2007002_packrat.pdf" class="external text" title="http://www.vpri.org/pdf/tr2007002_packrat.pdf" rel="nofollow">Packrat Parsers Can Support Left Recursion</a></i>. Viewpoints Research Institute<span class="printonly">. <a href="http://www.vpri.org/pdf/tr2007002_packrat.pdf" class="external free" title="http://www.vpri.org/pdf/tr2007002_packrat.pdf" rel="nofollow">http://www.vpri.org/pdf/tr2007002_packrat.pdf</a></span><span class="reference-accessdate">. Retrieved on 2008-10-02</span>.</cite><span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=Packrat+Parsers+Can+Support+Left+Recursion&amp;rft.aulast=Alessandro+Warth%2C+James+R.+Douglass%2C+Todd+Millstein&amp;rft.au=Alessandro+Warth%2C+James+R.+Douglass%2C+Todd+Millstein&amp;rft.date=January+2008&amp;rft.pub=Viewpoints+Research+Institute&amp;rft_id=http%3A%2F%2Fwww.vpri.org%2Fpdf%2Ftr2007002_packrat.pdf&amp;rfr_id=info:sid/en.wikipedia.org:Parsing_expression_grammar"><span style="display: none;">&#160;</span></span></li>
</ol>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit&amp;section=9" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.brynosaurus.com/pub/lang/peg-slides.pdf" class="external text" title="http://www.brynosaurus.com/pub/lang/peg-slides.pdf" rel="nofollow">Parsing Expression Grammars: A Recognition-Based Syntactic Foundation</a> (PDF slides)</li>
<li><a href="http://pdos.csail.mit.edu/~baford/packrat/" class="external text" title="http://pdos.csail.mit.edu/~baford/packrat/" rel="nofollow">The Packrat Parsing and Parsing Expression Grammars Page</a></li>
<li><a href="http://pdos.csail.mit.edu/~baford/packrat/thesis/" class="external text" title="http://pdos.csail.mit.edu/~baford/packrat/thesis/" rel="nofollow">Packrat Parsing: a Practical Linear-Time Algorithm with Backtracking</a></li>
<li>The <a href="/wiki/Constructed_language" title="Constructed language">constructed language</a> <a href="/wiki/Lojban" title="Lojban">Lojban</a> has a <a href="http://www.digitalkingdom.org/~rlpowell/hobbies/lojban/grammar/" class="external text" title="http://www.digitalkingdom.org/~rlpowell/hobbies/lojban/grammar/" rel="nofollow">fairly large PEG grammar</a> allowing unambiguous parsing of Lojban text.</li>
<li>The Aurochs parser generator has an <a href="http://aurochs.fr/cgi/demo.cgi" class="external text" title="http://aurochs.fr/cgi/demo.cgi" rel="nofollow">on-line parsing demo</a> that displays the parse tree for any given grammar and input</li>
<li><a href="/wiki/REBOL#parse" title="REBOL">REBOL parse dialect</a> is PEG-compatible</li>
</ul>


<!-- 
NewPP limit report
Preprocessor node count: 1058/1000000
Post-expand include size: 9113/2048000 bytes
Template argument size: 3460/2048000 bytes
Expensive parser function count: 1/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:892899-0!1!0!default!!en!2 and timestamp 20090415224607 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/Parsing_expression_grammar">http://en.wikipedia.org/wiki/Parsing_expression_grammar</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Formal_languages" title="Category:Formal languages">Formal languages</a></span> | <span dir='ltr'><a href="/wiki/Category:Parsing_algorithms" title="Category:Parsing algorithms">Parsing algorithms</a></span></div><div id="mw-hidden-catlinks" class="mw-hidden-cats-hidden">Hidden categories:&#32;<span dir='ltr'><a href="/wiki/Category:All_articles_with_unsourced_statements" title="Category:All articles with unsourced statements">All articles with unsourced statements</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_unsourced_statements_since_February_2007" title="Category:Articles with unsourced statements since February 2007">Articles with unsourced statements since February 2007</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Parsing_expression_grammar" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:Parsing_expression_grammar" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=Parsing_expression_grammar&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=Parsing_expression_grammar&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Parsing_expression_grammar" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content â the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Parsing_expression_grammar" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Parsing_expression_grammar" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=Parsing_expression_grammar&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=Parsing_expression_grammar&amp;oldid=284092395" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=Parsing_expression_grammar&amp;id=284092395">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-de"><a href="http://de.wikipedia.org/wiki/Packrat_Parser">Deutsch</a></li>
				<li class="interwiki-fa"><a href="http://fa.wikipedia.org/wiki/PEG">ÙØ§Ø±Ø³Û</a></li>
				<li class="interwiki-fr"><a href="http://fr.wikipedia.org/wiki/Parser_packrat">FranÃ§ais</a></li>
				<li class="interwiki-ja"><a href="http://ja.wikipedia.org/wiki/%E8%A7%A3%E6%9E%90%E8%A1%A8%E7%8F%BE%E6%96%87%E6%B3%95">æ¥æ¬èª</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 15 April 2009, at 22:46 (UTC).</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv219 in 0.041 secs. --></body></html>
