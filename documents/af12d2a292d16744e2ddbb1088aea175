<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="MX record,A record,Domain Name System,Domain name,Domain name system,E-mail,E-mail address,E-mail mailbox,E-mail spam,Exim,Host name" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=MX_record&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=MX_record&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>MX record - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "MX_record";
		var wgTitle = "MX record";
		var wgAction = "view";
		var wgArticleId = "66511";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 278522914;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-MX_record skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">MX record</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p>An <b>MX record</b> or <b>Mail exchanger record</b> is a type of <a href="/wiki/Resource_record" title="Resource record" class="mw-redirect">resource record</a> in the <a href="/wiki/Domain_Name_System" title="Domain Name System">Domain Name System</a> (DNS) specifying how <a href="/wiki/Internet" title="Internet">Internet</a> <a href="/wiki/E-mail" title="E-mail">e-mail</a> should be routed using the <a href="/wiki/Simple_Mail_Transfer_Protocol" title="Simple Mail Transfer Protocol">Simple Mail Transfer Protocol</a> (SMTP). Each MX record contains a <b>preference</b> and a <b><a href="/wiki/Host_name" title="Host name" class="mw-redirect">host name</a></b>, so that the collection of MX records for a given <i><a href="/wiki/Domain_name" title="Domain name">domain name</a></i> point to the servers that should receive e-mail for that domain, and their priority relative to each other.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1"><a href="#MX_preference.2C_distance.2C_and_priority"><span class="tocnumber">2</span> <span class="toctext">MX preference, distance, and priority</span></a>
<ul>
<li class="toclevel-2"><a href="#The_Basics"><span class="tocnumber">2.1</span> <span class="toctext">The Basics</span></a></li>
<li class="toclevel-2"><a href="#Load_distribution_among_an_array_of_mail_servers"><span class="tocnumber">2.2</span> <span class="toctext">Load distribution among an array of mail servers</span></a></li>
<li class="toclevel-2"><a href="#The_backup_MX"><span class="tocnumber">2.3</span> <span class="toctext">The backup MX</span></a></li>
<li class="toclevel-2"><a href="#Why_have_priority.3F"><span class="tocnumber">2.4</span> <span class="toctext">Why have priority?</span></a></li>
<li class="toclevel-2"><a href="#Spammers"><span class="tocnumber">2.5</span> <span class="toctext">Spammers</span></a></li>
<li class="toclevel-2"><a href="#The_preference_debate"><span class="tocnumber">2.6</span> <span class="toctext">The preference debate</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#History_of_fallback_to_A"><span class="tocnumber">3</span> <span class="toctext">History of fallback to A</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#References"><span class="tocnumber">5</span> <span class="toctext">References</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Overview" id="Overview"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=1" title="Edit section: Overview">edit</a>]</span> <span class="mw-headline">Overview</span></h2>
<p>The <i>host name</i> contained in an MX record must have an address, i.e. an A or AAAA <a href="/wiki/Domain_name_system#Types_of_DNS_records" title="Domain name system" class="mw-redirect">DNS record</a>. <a href="/wiki/List_of_DNS_record_types" title="List of DNS record types">CNAME</a> aliases are prohibited in an MX record <i>data</i>, while CNAME is allowed for the MX record <i>label</i>, that is for the <i>domain name</i> leading to the MX record itself.<sup id="cite_ref-0" class="reference"><a href="#cite_note-0" title=""><span>[</span>1<span>]</span></a></sup> It is also not permitted to use an IP address directly in an MX record;<sup id="cite_ref-1" class="reference"><a href="#cite_note-1" title=""><span>[</span>2<span>]</span></a></sup> while some <a href="/wiki/Mail_server" title="Mail server" class="mw-redirect">mail servers</a> will send mail to domains with IP-based MX records, many (most notably <a href="/wiki/Exim" title="Exim">Exim</a>) will refuse to do so.</p>
<p>When an e-mail message is sent through the Internet, the sending <a href="/wiki/Mail_transfer_agent" title="Mail transfer agent">mail transfer agent</a> makes a DNS query requesting the MX records for each recipient's <a href="/wiki/Domain_name" title="Domain name">domain name</a>, which is the portion of the <a href="/wiki/E-mail_address" title="E-mail address">e-mail address</a> following the "@". This query returns a list of <a href="/wiki/Host_name" title="Host name" class="mw-redirect">host names</a> of mail exchange servers accepting incoming mail for that domain, together with a preference number. The sending agent then attempts to establish an <a href="/wiki/Simple_Mail_Transfer_Protocol" title="Simple Mail Transfer Protocol">SMTP</a> connection to one of these servers, starting with the one with the smallest preference number, delivering the message to the first server with which a connection can be made. If no MX records were present, the server <i>falls back to A</i>, that is to say, it makes a request for the <a href="/wiki/A_record" title="A record" class="mw-redirect">A record</a> of the same domain.</p>
<p>The MX mechanism provides the ability to run multiple mail servers for a single domain, and allows administrators to specify an order in which they should be tried. This ability to run multiple mail servers proves very valuable for high-availability clusters of inexpensive mail gateways, which can then process hundreds of messages per second in aggregate to quarantine or remove <a href="/wiki/E-mail_spam" title="E-mail spam">spam</a> and/or viruses.</p>
<p>The MX mechanism does not grant the ability to provide mail service on alternative <a href="/wiki/TCP_and_UDP_port" title="TCP and UDP port">ports</a>, nor does it provide the ability to distribute mail delivery across a set of equal-priority mail servers by assigning a weighting value to each one.</p>
<p><a name="MX_preference.2C_distance.2C_and_priority" id="MX_preference.2C_distance.2C_and_priority"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=2" title="Edit section: MX preference, distance, and priority">edit</a>]</span> <span class="mw-headline">MX preference, distance, and priority</span></h2>
<p>According to RFC2821, the lowest-numbered records are the most preferred.<sup id="cite_ref-RFC2821_2-0" class="reference"><a href="#cite_note-RFC2821-2" title=""><span>[</span>3<span>]</span></a></sup> This phrasing can be confusing, and so the <i>preference number</i> is sometimes referred to as the <i>distance</i>: smaller distances are more preferable. An older RFC, RFC974, indicates that when the preference numbers are the same for two servers, they have the same <i>priority</i>, hence those two terms are used interchangeably.</p>
<p><a name="The_Basics" id="The_Basics"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=3" title="Edit section: The Basics">edit</a>]</span> <span class="mw-headline">The Basics</span></h3>
<p>When a server decides to send SMTP mail, the relative priority of an MX server is determined by the preference number present in the DNS MX record of the recipient's domain. When a remote client (typically another mail server) does an MX lookup for the domain name, it gets a list of servers and their preference numbers. The smallest preference number has the highest priority and any server with the highest priority must be tried first. To provide reliable mail transmission, the SMTP client <i>must</i> be able to try (and retry) each of the relevant addresses in this list in order, until a delivery attempt succeeds.<sup id="cite_ref-RFC2821_2-1" class="reference"><a href="#cite_note-RFC2821-2" title=""><span>[</span>3<span>]</span></a></sup> If there is more than one MX record with the same preference number, all of those must be tried before moving on to lower-priority entries.</p>
<p><a name="Load_distribution_among_an_array_of_mail_servers" id="Load_distribution_among_an_array_of_mail_servers"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=4" title="Edit section: Load distribution among an array of mail servers">edit</a>]</span> <span class="mw-headline">Load distribution among an array of mail servers</span></h3>
<p>One technique used to distribute the load of incoming mail over an array of servers is to return the same preference number for each server in the set. When determining which server of equal preference to send mail to, "the sender-SMTP MUST randomize them to spread the load across multiple mail exchangers for a specific organization."<sup id="cite_ref-RFC2821_2-2" class="reference"><a href="#cite_note-RFC2821-2" title=""><span>[</span>3<span>]</span></a></sup> This technique mainly addresses routing problems; other types of server load can be addressed by using an SMTP proxy.</p>
<p>The other alternative mentioned in the RFC is to use what appears to be a multi-homed <a href="/wiki/A_record" title="A record" class="mw-redirect">A record</a> for a mail server. It may in fact be an array of mail servers that share the same host name. This method places the burden on the DNS system rather than the SMTP-sender to perform the load balancing, which in this case will present a list of IP addresses in a specific order to the clients querying the A record of the mail exchanger. Since the RFC requires that the SMTP-sender use the order given in the A record query, the DNS server is free to carefully manipulate its balancing based on any method, including <a href="/wiki/Round_robin_DNS" title="Round robin DNS">round robin DNS</a>, mail server load, or some undisclosed priority scheme.</p>
<p><a name="The_backup_MX" id="The_backup_MX"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=5" title="Edit section: The backup MX">edit</a>]</span> <span class="mw-headline">The backup MX</span></h3>
<p>A <i>target server</i>, i.e. one that knows how to deliver to the relevant user's <a href="/wiki/E-mail_mailbox" title="E-mail mailbox" class="mw-redirect">e-mail mailbox</a> is typically one which is the most preferred. Lower priority servers, a.k.a. <i>backup MX</i> or <i>secondary MX</i>, usually keep the messages in a queue waiting for the primary server to become available. If both servers are online or in some way connected to one another, the backup MX will typically queue a message briefly and immediately forward it to the primary MX. The backup MX acts as a <a href="/wiki/Store-and-forward" title="Store-and-forward" class="mw-redirect">store-and-forward</a> mail server.</p>
<p><a name="Why_have_priority.3F" id="Why_have_priority.3F"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=6" title="Edit section: Why have priority?">edit</a>]</span> <span class="mw-headline">Why have priority?</span></h3>
<p>A common misconception about the MX preference ordering is that it is intended to increase the likelihood that mail may be delivered, however merely having multiple MX records with the same preference provides this benefit. Because the MX preference ordering specifies that some servers should be tried <i>first</i>, it is, if anything, a means of establishing load imbalance. Another common misinterpretation of MX preference ordering is that it is intended to provide a means of "failover" in the case of server overload. While it can be used that way, it is a poor resource management technique because it intentionally creates overload and does not fully exploit the available hardware. Assigning the same preference value to all of the available servers provides the same benefit and may even help avoid overload situations and thereby increase system throughput by decreasing latency.</p>
<p>The <a href="/wiki/SMTP" title="SMTP" class="mw-redirect">SMTP</a> protocol establishes a store-and-forward network, and if a domain's mail servers are all offline, sending servers are required to queue messages destined for that domain to retry later. However, these sending servers have no way of being notified that a previously offline domain's servers are now available. The sending servers will only discover that the domain is available whenever delivery of the delayed messages is next attempted. The delay between when a domain's servers come online and when delayed messages are finally delivered can be anywhere from minutes to days, depending on the retry schedule of the sending servers. <i>This</i> is the problem that backup MX records are uniquely qualified to solve. The idea is that the servers listed as secondary MX servers have some out-of-band way of knowing when the primary servers are back online. Thus, they are a more useful place to queue messages when the primary servers are offline than the original sender's queue.</p>
<p>The question then becomes: if the secondary servers are still online, why not give them the same priority as the rest of the domain's MX records? Secondary servers are ones that, for whatever reason, cannot or should not be used normally, but that can be used if the primary servers are offline. Reasons for them to not be used normally can vary wildly, but here are some examples:</p>
<ul>
<li>the backup server is owned by a different company or organization</li>
<li>the backup server does not have direct access to the primary mail storage</li>
<li>the backup server cannot determine valid recipient addresses</li>
<li>the backup server's Internet bandwidth costs more</li>
<li>the backup server has significantly less Internet bandwidth</li>
<li>the backup server has a high-latency Internet connection</li>
</ul>
<p><a name="Spammers" id="Spammers"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=7" title="Edit section: Spammers">edit</a>]</span> <span class="mw-headline">Spammers</span></h3>
<p>A favorite technique of <a href="/wiki/Spammer" title="Spammer" class="mw-redirect">spammers</a> is to connect to the backup (high distance) MX servers for a domain first in order to avoid any anti-spam filters that may be running on the primary (lowest distance/highest preference) MX. Backup MX servers often have different anti-spam techniques, and using them can hide the spammer's IP address from the primary MX servers. This behavior can be used against spammers by using bogus high-distance MX servers. Alternately, sometimes spammers only target the lowest-distance MX records for domains, and do not fall back to higher-distance MX records when the lowest-distance MX records are unreachable. This behavior can also be used against spammers, using a technique called <a href="/wiki/Nolisting" title="Nolisting">nolisting</a>.</p>
<p><a name="The_preference_debate" id="The_preference_debate"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=8" title="Edit section: The preference debate">edit</a>]</span> <span class="mw-headline">The preference debate</span></h3>
<p>The SMTP RFC<sup id="cite_ref-RFC2821_2-3" class="reference"><a href="#cite_note-RFC2821-2" title=""><span>[</span>3<span>]</span></a></sup> is ambiguous about exactly what kinds of delivery failure must result in re-attempting delivery via more distant MX records (those with higher preference values).</p>
<p>For example, sometimes servers indicate temporary failures, either by explicitly sending a 4xx error or by ending the connection unexpectedly (which must be treated as a 451 error, according to <a href="http://tools.ietf.org/html/rfc2821#section-3.10" class="external text" title="http://tools.ietf.org/html/rfc2821#section-3.10" rel="nofollow">Section 3.10</a> of the RFC). If there is a temporary failure, should a more distant MX record be attempted, or should the server wait and retry later? According to <a href="http://tools.ietf.org/html/rfc2821#section-4.5.4.1" class="external text" title="http://tools.ietf.org/html/rfc2821#section-4.5.4.1" rel="nofollow">Section 4.5.4.1</a>:</p>
<pre>
 The sender MUST delay retrying a particular destination after one
 attempt has failed.
</pre>
<p>But when the sender retries later, the RFC is silent about whether the sender should retry the same server that gave the previous temporary error or a more distant MX record. It does say, in <a href="http://tools.ietf.org/html/rfc2821#section-5" class="external text" title="http://tools.ietf.org/html/rfc2821#section-5" rel="nofollow">Section 5</a>:</p>
<pre>
 When the lookup succeeds, the mapping can result in a list of
 alternative delivery addresses rather than a single address, because
 of multiple MX records, multihoming, or both.   To provide reliable
 mail transmission, the SMTP client MUST be able to try (and retry)
 each of the relevant addresses in this list in order, until a
 delivery attempt succeeds.
</pre>
<p>It is not specific about what should cause the sender to use a higher-preference MX record, merely that the sender must be <i>able</i> to use higher-preference MX records. Some servers (such as <a href="/wiki/Sendmail" title="Sendmail">Sendmail</a> and <a href="/wiki/Postfix" title="Postfix">Postfix</a> 2.1 or later <sup id="cite_ref-postfix20-21_3-0" class="reference"><a href="#cite_note-postfix20-21-3" title=""><span>[</span>4<span>]</span></a></sup>) will attempt the next-furthest MX server after some types of temporary delivery failures, such as greeting failures<sup id="cite_ref-4" class="reference"><a href="#cite_note-4" title=""><span>[</span>5<span>]</span></a></sup>. Other servers (such as <a href="/wiki/Qmail" title="Qmail">qmail</a> and <a href="/wiki/Postfix" title="Postfix">Postfix</a> 2.0 or earlier) will only use more distant MX records if the servers specified in the shortest-distance MX records could not be contacted at all.</p>
<p>Both behaviors are valid, since the RFC is not specific. Re-attempting with more distant MX records makes a lot of sense if the primary MX's failure is considered non-authoritative; that is, if there is an expectation that the message may yet be delivered by the backup MX servers. This is often phrased as "if the alternative is giving up and not delivering the mail, why not try the higher-preference MXs?"<sup id="cite_ref-5" class="reference"><a href="#cite_note-5" title=""><span>[</span>6<span>]</span></a></sup> However, if the primary MX's failure is considered authoritative (i.e. it is the primary server for a non-arbitrary reason), attempting to deliver to secondary MX servers is not only a waste of time but potentially a waste of expensive resources, depending on the reason why the secondary servers have higher preference values.</p>
<p>The different MX-handling behaviors of email servers (<a href="/wiki/MTA" title="MTA">MTAs</a>) often comes up in discussions of <a href="/wiki/Nolisting" title="Nolisting">nolisting</a> and similar anti-spam strategies that rely on manipulating the MX order and exercising MTA failure handling mechanisms.</p>
<p>Regardless of how one interprets the RFCs there is an advantage to choosing to deliver to higher numbered MX records when receiving a 4xx error from a primary mail server. If the primary server is overloaded or experiencing some other temporary failure the backup server can accept the email and process it. This means the email is delivered faster that waiting to retry the primary server until it recovers. Some front end spam filtering services apply gray listing techniques only on the primary server to discourage spam bot email. Sending servers that retry the higher MX records will be able to deliver they outgoing mail immediately where servers like qmail will be delayed typically for an hour till the primary server allows it. So servers that retry higher numbered MX records gain a performance advantage.</p>
<p><a name="History_of_fallback_to_A" id="History_of_fallback_to_A"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=9" title="Edit section: History of fallback to A">edit</a>]</span> <span class="mw-headline">History of fallback to A</span></h2>
<p><a href="http://tools.ietf.org/html/rfc821" class="external" title="http://tools.ietf.org/html/rfc821">RFC 821</a> came out in 1982. It makes only passing references to DNS, because at the time the transition from HOSTS.TXT to the DNS had not yet started. <a href="http://tools.ietf.org/html/rfc883" class="external" title="http://tools.ietf.org/html/rfc883">RFC 883</a>, the first description of the DNS, came out over a year later in late 1983. It described the experimental and little used MD and MF records. According to <a href="http://tools.ietf.org/html/rfc897" class="external" title="http://tools.ietf.org/html/rfc897">RFC 897</a> and <a href="http://tools.ietf.org/html/rfc921" class="external" title="http://tools.ietf.org/html/rfc921">RFC 921</a>, the transition to DNS started in 1983, but HOSTS.TXT wasn't scheduled to go away until the end of 1985 and wasn't totally phased out until the late 1980s.</p>
<p>In January 1986, <a href="http://tools.ietf.org/html/rfc973" class="external" title="http://tools.ietf.org/html/rfc973">RFC 973</a> and <a href="http://tools.ietf.org/html/rfc974" class="external" title="http://tools.ietf.org/html/rfc974">RFC 974</a> deprecated the MD and MF records, replaced them with MX, and defined the MX lookup with fallback to A. <a href="http://tools.ietf.org/html/rfc974" class="external" title="http://tools.ietf.org/html/rfc974">RFC 974</a> recommends that clients do a WKS lookup on each MX host to see if it actually supports SMTP and discard the MX entry if it doesn't. However, <a href="http://tools.ietf.org/html/rfc1123" class="external" title="http://tools.ietf.org/html/rfc1123">RFC 1123</a> changed this to say that WKS "SHOULD NOT" be checked.</p>
<p>This means that SMTP had been in use for at least a year using HOSTS.TXT, and then another couple of years using A, MD, and MF, before MX came along. MD and MF were hard to use, so most people just used the A record. Under the circumstances, MX without fallback to A wouldn't have worked because of the substantial installed base of mail servers using A records. The early use of MX was to identify gateways to other networks, but it didn't come into wide use until the DNS was well established in the early 1990s.<sup id="cite_ref-6" class="reference"><a href="#cite_note-6" title=""><span>[</span>7<span>]</span></a></sup></p>
<p><a href="http://tools.ietf.org/html/rfc2821" class="external" title="http://tools.ietf.org/html/rfc2821">RFC 2821</a> sec. 5 now clearly states that:</p>
<ol>
<li>SMTP clients must look up for an MX record;</li>
<li>if no MX record for domain is present, look up for an A RR record, and if such record is present, treat it as an MX record;</li>
<li>if an MX record is present, clients MUST NOT use an A RR record.</li>
</ol>
<pre>
  <i><a href="http://tools.ietf.org/html/rfc2821" class="external" title="http://tools.ietf.org/html/rfc2821">RFC 2821</a>, sec. 5, page 60</i>
  <b>5. Address Resolution and Mail Handling</b>
  Once an SMTP client lexically identifies a domain to which mail will
  be delivered for processing (as described in sections 3.6 and 3.7), a
  DNS lookup MUST be performed to resolve the domain name [22].  The
  names are expected to be fully-qualified domain names (FQDNs):
  mechanisms for inferring FQDNs from partial names or local aliases
  are outside of this specification and, due to a history of problems,
  are generally discouraged.  The lookup first attempts to locate an MX
  record associated with the name.  If a CNAME record is found instead,
  the resulting name is processed as if it were the initial name.  If
  no MX records are found, but an A RR is found, the A RR is treated as
  if it was associated with an implicit MX RR, with a preference of 0,
  pointing to that host.  If one or more MX RRs are found for a given
  name, SMTP systems MUST NOT utilize any A RRs associated with that
  name unless they are located using the MX RRs; the "implicit MX" rule
  above applies only if there are no MX records present.  If MX records
  are present, but none of them are usable, this situation MUST be
  reported as an error.
</pre>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=10" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/SRV_record" title="SRV record">SRV record</a> - a similar DNS record for advertising other network services</li>
<li><a href="/wiki/Sender_Policy_Framework" title="Sender Policy Framework">Sender Policy Framework</a> - some what of a reverse MX record, saying where mail gets sent from, rather than sent to.</li>
<li><a href="/wiki/List_of_DNS_record_types" title="List of DNS record types">List of DNS record types</a></li>
<li><a href="/wiki/A_record" title="A record" class="mw-redirect">A record</a></li>
</ul>
<p>Spam related MX systems:</p>
<ul>
<li><a href="/wiki/Nolisting" title="Nolisting">Nolisting</a></li>
<li><a href="/wiki/Null_MX" title="Null MX">Null MX</a></li>
</ul>
<p>Relevant RFCs:</p>
<ul>
<li><a href="http://tools.ietf.org/html/rfc974" class="external" title="http://tools.ietf.org/html/rfc974">RFC 974</a> (1986), Mail Routing and the Domain System (obsolete)</li>
<li><a href="http://tools.ietf.org/html/rfc1035" class="external" title="http://tools.ietf.org/html/rfc1035">RFC 1035</a> (1987), Domain Names - Implementation and Specification</li>
<li><a href="http://tools.ietf.org/html/rfc2821" class="external" title="http://tools.ietf.org/html/rfc2821">RFC 2821</a> (2001), Simple Mail Transfer Protocol</li>
<li><a href="http://tools.ietf.org/html/rfc1912" class="external" title="http://tools.ietf.org/html/rfc1912">RFC 1912</a> (1996), Common DNS Operational and Configuration Errors</li>
</ul>
<p><a name="References" id="References"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=MX_record&amp;action=edit&amp;section=11" title="Edit section: References">edit</a>]</span> <span class="mw-headline">References</span></h2>
<div class="references-small">
<ol class="references">
<li id="cite_note-0"><b><a href="#cite_ref-0" title="">^</a></b> The prohibition on labels in the data that resolve to CNAMEs is discussed in <a href="http://tools.ietf.org/html/rfc2181" class="external" title="http://tools.ietf.org/html/rfc2181">RFC 2181</a>, Section 10.3; its rationale is to allow a <i>backup MX</i> to recognize itself by name, thereby simplifying the algorithm used to determine the target host. See also <a href="http://tools.ietf.org/html/rfc1034" class="external" title="http://tools.ietf.org/html/rfc1034">RFC 1034</a>.</li>
<li id="cite_note-1"><b><a href="#cite_ref-1" title="">^</a></b> per <a href="http://tools.ietf.org/html/rfc974" class="external" title="http://tools.ietf.org/html/rfc974">RFC 974</a> and <a href="http://tools.ietf.org/html/rfc1035" class="external" title="http://tools.ietf.org/html/rfc1035">RFC 1035</a> Section 3.3.9</li>
<li id="cite_note-RFC2821-2">^ <a href="#cite_ref-RFC2821_2-0" title=""><sup><i><b>a</b></i></sup></a> <a href="#cite_ref-RFC2821_2-1" title=""><sup><i><b>b</b></i></sup></a> <a href="#cite_ref-RFC2821_2-2" title=""><sup><i><b>c</b></i></sup></a> <a href="#cite_ref-RFC2821_2-3" title=""><sup><i><b>d</b></i></sup></a> <a href="http://tools.ietf.org/html/rfc2821" class="external" title="http://tools.ietf.org/html/rfc2821">RFC 2821</a></li>
<li id="cite_note-postfix20-21-3"><b><a href="#cite_ref-postfix20-21_3-0" title="">^</a></b> <a href="http://archives.neohapsis.com/archives/postfix/2005-11/0636.html" class="external autonumber" title="http://archives.neohapsis.com/archives/postfix/2005-11/0636.html" rel="nofollow">[1]</a> <i>If the primary MX responds, but fails mid-transaction, Postfix 1.2 and 2.0 will not try a backup MX.</i></li>
<li id="cite_note-4"><b><a href="#cite_ref-4" title="">^</a></b> A greeting failure is an error-code that is sent instead of or in response to the standard SMTP greeting handshake.</li>
<li id="cite_note-5"><b><a href="#cite_ref-5" title="">^</a></b> This argument ignores the fact that in most cases (such as with <a href="/wiki/Sendmail" title="Sendmail">Sendmail</a> and <a href="/wiki/Postfix" title="Postfix">Postfix</a>) the more distant MXs may be used long before the server gets close to giving up.</li>
<li id="cite_note-6"><b><a href="#cite_ref-6" title="">^</a></b> This section is adapted from <a href="/wiki/John_Levine" title="John Levine" class="mw-redirect">John Levine</a> <a href="http://www.imc.org/ietf-smtp/mail-archive/msg04438.html" class="external text" title="http://www.imc.org/ietf-smtp/mail-archive/msg04438.html" rel="nofollow">ietf-smtp message</a></li>
</ol>
</div>
<p>.</p>


<!-- 
NewPP limit report
Preprocessor node count: 149/1000000
Post-expand include size: 133/2048000 bytes
Template argument size: 0/2048000 bytes
Expensive parser function count: 0/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:66511-0!1!0!default!!en!2 and timestamp 20090403125516 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/MX_record">http://en.wikipedia.org/wiki/MX_record</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Domain_name_system" title="Category:Domain name system">Domain name system</a></span> | <span dir='ltr'><a href="/wiki/Category:E-mail" title="Category:E-mail">E-mail</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/MX_record" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:MX_record" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=MX_record&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=MX_record&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=MX_record" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/MX_record" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/MX_record" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=MX_record&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=MX_record&amp;oldid=278522914" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=MX_record&amp;id=278522914">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-ca"><a href="http://ca.wikipedia.org/wiki/MX">Català</a></li>
				<li class="interwiki-de"><a href="http://de.wikipedia.org/wiki/MX_Resource_Record">Deutsch</a></li>
				<li class="interwiki-es"><a href="http://es.wikipedia.org/wiki/MX_(registro)">Español</a></li>
				<li class="interwiki-fr"><a href="http://fr.wikipedia.org/wiki/Enregistrement_Mail_eXchanger">Français</a></li>
				<li class="interwiki-hu"><a href="http://hu.wikipedia.org/wiki/MX_rekord">Magyar</a></li>
				<li class="interwiki-nl"><a href="http://nl.wikipedia.org/wiki/MX-record">Nederlands</a></li>
				<li class="interwiki-ja"><a href="http://ja.wikipedia.org/wiki/MX%E3%83%AC%E3%82%B3%E3%83%BC%E3%83%89">日本語</a></li>
				<li class="interwiki-ru"><a href="http://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%BF%D0%B8%D1%81%D1%8C_MX">Русский</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 20 March 2009, at 12:54 (UTC).</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv202 in 0.104 secs. --></body></html>
