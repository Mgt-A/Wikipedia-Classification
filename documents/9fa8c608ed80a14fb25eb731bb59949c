<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="Verlet integration,Velocity Verlet,Backward Euler method,Beeman&#039;s algorithm,Carl Størmer,Coefficient of restitution,Collision,Constraint algorithm,Courant–Friedrichs–Lewy condition,Crank–Nicolson method,Elastic collision" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Verlet_integration&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=Verlet_integration&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Verlet integration - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Verlet_integration";
		var wgTitle = "Verlet integration";
		var wgAction = "view";
		var wgArticleId = "825735";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 280725538;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Verlet_integration skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">Verlet integration</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p><b>Verlet integration</b> (<small>IPA</small>:&#160;<span title="Pronunciation in IPA" class="IPA"><a href="/wiki/Wikipedia:IPA" title="Wikipedia:IPA">[veʁ'le]</a></span>) is a numerical method used to <a href="/wiki/Time_integration_method" title="Time integration method" class="mw-redirect">integrate</a> <a href="/wiki/Issac_Newton" title="Issac Newton" class="mw-redirect">Newton's</a> <a href="/wiki/Equations_of_motion" title="Equations of motion">equations of motion</a>. It is frequently used to calculate <a href="/wiki/Trajectory" title="Trajectory">trajectories</a> of particles in <a href="/wiki/Molecular_dynamics" title="Molecular dynamics">molecular dynamics</a> simulations and <a href="/wiki/Video_game" title="Video game">video games</a>. The verlet integrator offers greater <a href="/wiki/Numerical_stability" title="Numerical stability">stability</a> than the much simpler <a href="/wiki/Euler_method" title="Euler method">Euler method</a>, as well as other properties that are important in physical systems such as time-reversibility and <a href="/wiki/Symplectic_integrator" title="Symplectic integrator">area preserving properties</a>. At first it may seem natural to simply calculate trajectories using <a href="/wiki/Euler_integration" title="Euler integration" class="mw-redirect">Euler integration</a>. However, this kind of integration suffers from many problems, as discussed at <a href="/wiki/Euler_integration" title="Euler integration" class="mw-redirect">Euler integration</a>. Stability of the technique depends fairly heavily upon either a uniform update rate, or the ability to accurately identify positions at a small time delta into the past. The method was used by <a href="/wiki/Carl_St%C3%B8rmer" title="Carl Størmer">Carl Størmer</a> to compute the trajectories of particles moving in a magnetic field (hence it is also called <b>Störmer's method</b>) and was popularized in molecular dynamics by French physicist <a href="/wiki/Loup_Verlet" title="Loup Verlet">Loup Verlet</a> in 1967.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Basic_Verlet"><span class="tocnumber">1</span> <span class="toctext">Basic Verlet</span></a></li>
<li class="toclevel-1"><a href="#Velocity_Verlet"><span class="tocnumber">2</span> <span class="toctext">Velocity Verlet</span></a></li>
<li class="toclevel-1"><a href="#Error_terms"><span class="tocnumber">3</span> <span class="toctext">Error terms</span></a></li>
<li class="toclevel-1"><a href="#Constraints"><span class="tocnumber">4</span> <span class="toctext">Constraints</span></a></li>
<li class="toclevel-1"><a href="#Collision_reactions"><span class="tocnumber">5</span> <span class="toctext">Collision reactions</span></a></li>
<li class="toclevel-1"><a href="#Applications"><span class="tocnumber">6</span> <span class="toctext">Applications</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">8</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Basic_Verlet" id="Basic_Verlet"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=1" title="Edit section: Basic Verlet">edit</a>]</span> <span class="mw-headline">Basic Verlet</span></h2>
<p>The Verlet algorithm <a href="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html" class="external autonumber" title="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html" rel="nofollow">[1]</a> reduces the level of errors introduced into the integration by calculating the position at the next time step from the positions at the previous and current time steps, without using the velocity. It is derived by writing two <a href="/wiki/Taylor_expansion" title="Taylor expansion" class="mw-redirect">Taylor expansions</a> of the position vector <img class="tex" alt="\vec{x}(t)" src="http://upload.wikimedia.org/math/5/b/7/5b7f0340dc0eca285ea9a9804762848e.png" /> in different time directions.</p>
<dl>
<dd><img class="tex" alt="\vec{x}(t + \Delta t) = \vec{x}(t) + \vec{v}(t)\Delta t + \frac{\vec{a}(t) \Delta t^2}{2} + \frac{\vec{b}(t) \Delta t^3}{6} + O(\Delta t^4)\," src="http://upload.wikimedia.org/math/2/0/c/20cb8fe0f0810dddaf837ad2432ca81b.png" /></dd>
<dd><img class="tex" alt="\vec{x}(t - \Delta t) = \vec{x}(t) - \vec{v}(t)\Delta t + \frac{\vec{a}(t) \Delta t^2}{2} - \frac{\vec{b}(t) \Delta t^3}{6} + O(\Delta t^4).\," src="http://upload.wikimedia.org/math/4/2/8/428b9e41d55344c13e0f8a949bf32000.png" /></dd>
</dl>
<p>Where <img class="tex" alt="\vec{x}" src="http://upload.wikimedia.org/math/f/b/4/fb4766506bcea9e6256be140a411651d.png" /> is the position, <img class="tex" alt="\vec{v}" src="http://upload.wikimedia.org/math/2/0/d/20d88c8c828fbb1bc9168d9cfd816060.png" /> the velocity, <img class="tex" alt="\vec{a}" src="http://upload.wikimedia.org/math/a/1/5/a159b61a2221d23bb55d352231cab456.png" /> the acceleration and <img class="tex" alt="\vec{b}" src="http://upload.wikimedia.org/math/0/0/5/00534a7a980de9db23c1bdf9cdbde215.png" /> the <a href="/wiki/Jerk_(physics)" title="Jerk (physics)">jerk</a> (third derivative of the position with respect to the time) <span class="texhtml"><i>t</i></span>. Adding these two expansions gives</p>
<dl>
<dd><img class="tex" alt="\vec{x}(t + \Delta t) = 2\vec{x}(t) - \vec{x}(t - \Delta t) + \vec{a}(t) \Delta t^2 + O(\Delta t^4).\," src="http://upload.wikimedia.org/math/0/e/b/0ebe4048736871900fb314c22924caad.png" /></dd>
</dl>
<p>This offers the advantage that the first and third-order term from the Taylor expansion cancels out, thus making the Verlet integrator an order more accurate than integration by simple Taylor expansion alone. Note that if using this equation at <span class="texhtml"><i>t</i> = 0</span>, one needs the position at time <span class="texhtml">− Δ<i>t</i></span>, <img class="tex" alt="\vec{x}(-\Delta t)" src="http://upload.wikimedia.org/math/a/4/5/a4518ca06350b9d3408e0f0756bd5bfa.png" />. At first sight this could give problems, because the initial conditions are known only at the initial time. This can be solved by doing the first time step using the equation</p>
<dl>
<dd><img class="tex" alt="\vec{x}(\Delta t) \approx \vec{x}(0) + \vec{v}(0)\Delta t + \frac{\vec{a}(0)\Delta t^2}{2} + O(\Delta t^3).\," src="http://upload.wikimedia.org/math/9/6/9/969a7275843fee190f4025bdc6c687a6.png" /></dd>
</dl>
<p>The error on the first time step calculation then is of <span class="texhtml">Δ<i>t</i><sup>3</sup></span> order. This is not considered a problem because on a simulation of over a large amount of timesteps, the error on the first timestep is only a negligible small amount of the total error. As also can be seen in the basic verlet formula, the velocities are not explicitly given in the Basic Verlet equation, but often they are necessary for the calculation of certain physical quantities. This can create technical challenges in <a href="/wiki/Molecular_dynamics" title="Molecular dynamics">molecular dynamics</a> simulations, because kinetic energy and instantaneous temperatures at time <span class="texhtml"><i>t</i></span> cannot be calculated for a system until the positions are known at time <span class="texhtml"><i>t</i> + Δ<i>t</i></span>. This deficiency can either be dealt with using the Velocity Verlet algorithm, or estimating the velocity using the position terms and the <a href="/wiki/Mean_value_theorem" title="Mean value theorem">mean value theorem</a>:</p>
<dl>
<dd><img class="tex" alt="\vec{v}(t) = \frac{\vec{x}(t + \Delta t) - \vec{x}(t - \Delta t)}{2\Delta t} + O(\Delta t^2)." src="http://upload.wikimedia.org/math/d/6/a/d6a6f6fa2e343e153d620c9571fd5578.png" /></dd>
</dl>
<p>Note that this velocity term is for the velocity at time <span class="texhtml"><i>t</i></span>, not <span class="texhtml"><i>t</i> + Δ<i>t</i></span>, meaning that the velocity term is a step behind the position term. You can shorten the interval to approximate the velocity at time <span class="texhtml"><i>t</i> + Δ<i>t</i></span> at the cost of accuracy:</p>
<dl>
<dd><img class="tex" alt="\vec{v}(t + \Delta t) = \frac{\vec{x}(t + \Delta t) - \vec{x}(t)}{\Delta t} + O(\Delta t)." src="http://upload.wikimedia.org/math/a/f/a/afa0fcbd01ed602f2a0ef4593fb92028.png" /></dd>
</dl>
<p><a name="Velocity_Verlet" id="Velocity_Verlet"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=2" title="Edit section: Velocity Verlet">edit</a>]</span> <span class="mw-headline">Velocity Verlet</span></h2>
<p>A related, and more commonly used, algorithm is the <b>Velocity Verlet</b> algorithm <a href="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html" class="external autonumber" title="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html" rel="nofollow">[2]</a>. This uses a similar approach but explicitly incorporates velocity, solving the first-timestep problem in the Basic Verlet algorithm:</p>
<dl>
<dd><img class="tex" alt="\vec{x}(t + \Delta t) = \vec{x}(t) + \vec{v}(t)\, \Delta t + \frac{1}{2} \vec{a}(t) (\Delta t)^2  \," src="http://upload.wikimedia.org/math/e/f/6/ef60d0a3191deae14474de499fb1fd64.png" /></dd>
<dd><img class="tex" alt="\vec{v}(t + \Delta t) = \vec{v}(t) + \frac{\vec{a}(t) + \vec{a}(t + \Delta t)}{2} \Delta t  \," src="http://upload.wikimedia.org/math/5/a/5/5a5a4cebe21a1d0f356c29475971698a.png" /></dd>
</dl>
<p>It can be shown that the error on the Velocity Verlet is of the same order as the Basic Verlet. Note that the Velocity algorithm is not necessarily more memory consuming, because it's not necessary to keep track of the velocity at every timestep during the simulation. The standard implementation scheme of this algorithm is:</p>
<ol>
<li>Calculate: <img class="tex" alt="\vec{x}(t + \Delta t) = \vec{x}(t) + \vec{v}(t)\, \Delta t + \frac{1}{2} \vec{a}(t) (\Delta t)^2  \," src="http://upload.wikimedia.org/math/e/f/6/ef60d0a3191deae14474de499fb1fd64.png" /></li>
<li>Calculate: <img class="tex" alt="\vec{v}(t + \frac{\Delta t}{2}) = \vec{v}(t) + \frac{\vec{a}(t)\Delta t}{2} \," src="http://upload.wikimedia.org/math/2/7/2/272a819c07faf40f2510e04628b6f0a3.png" /></li>
<li>Derive <img class="tex" alt="\vec{a}(t + \Delta t)" src="http://upload.wikimedia.org/math/f/4/7/f47c95696f424db5da40489ca4b6bfe2.png" /> from the interaction potential.</li>
<li>Calculate: <img class="tex" alt="\vec{v}(t + \Delta t) = \vec{v}(t + \frac{\Delta t}{2}) + \frac{\vec{a}(t + \Delta t)\Delta t}{2} \," src="http://upload.wikimedia.org/math/8/3/8/838dd648c4c96e5c923e42017a3b5215.png" /></li>
</ol>
<p>The derivation of the acceleration comes from the relation</p>
<dl>
<dd><img class="tex" alt="\vec{F} = - \vec{\nabla}V = m \vec{a}\, " src="http://upload.wikimedia.org/math/2/3/3/233cccd9b2d4e599736ce2a82676e9e6.png" /></dd>
</dl>
<p>Note, however, that this algorithm assumes that acceleration at time <img class="tex" alt="\vec{a}(t + \Delta t)" src="http://upload.wikimedia.org/math/f/4/7/f47c95696f424db5da40489ca4b6bfe2.png" /> only depends on position <img class="tex" alt="\vec{x}(t + \Delta t)" src="http://upload.wikimedia.org/math/4/b/b/4bba327e0d5a5c020c01c366c2f018bf.png" />, and does not depend on velocity <img class="tex" alt="\vec{v}(t + \Delta t)" src="http://upload.wikimedia.org/math/e/2/6/e26c00e57b59edad349273d6507ef929.png" /></p>
<p><a name="Error_terms" id="Error_terms"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=3" title="Edit section: Error terms">edit</a>]</span> <span class="mw-headline">Error terms</span></h2>
<p>The local error in position of the Verlet integrator is <span class="texhtml"><i>O</i>(Δ<i>t</i><sup>4</sup>)</span> as described above, and the local error in velocity is <span class="texhtml"><i>O</i>(Δ<i>t</i><sup>2</sup>)</span>.</p>
<p>The global error in position, in contrast, is <span class="texhtml"><i>O</i>(Δ<i>t</i><sup>2</sup>)</span> and the global error in velocity is <span class="texhtml"><i>O</i>(Δ<i>t</i><sup>2</sup>)</span>. These can be derived by noting the following:</p>
<dl>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + \Delta t)\bigr) = O(\Delta t^4)" src="http://upload.wikimedia.org/math/6/5/9/659362744acfdb1f17c1ef55af7b7b40.png" /></dd>
</dl>
<p>and</p>
<dl>
<dd><img class="tex" alt="x(t_0 + 2\Delta t) = 2x(t_0 + \Delta t) - x(t_0) + \Delta t^2 x''(t_0 + \Delta t) + O(\Delta t^4) \, " src="http://upload.wikimedia.org/math/9/f/0/9f0b0ab6b8b71293005558202b32b5fa.png" /></dd>
</dl>
<p>Therefore:</p>
<dl>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + 2\Delta t)\bigr) = 2\mathrm{error}\bigl(x(t_0 + \Delta t)\bigr) + O(\Delta t^4) = 3\,O(\Delta t^4)" src="http://upload.wikimedia.org/math/0/0/f/00fb4282cac84912b7807ec3392e0047.png" /></dd>
</dl>
<p>Similarly:</p>
<dl>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + 3\Delta t)\bigl) = 6\,O(\Delta t^4)" src="http://upload.wikimedia.org/math/5/1/4/5142db49c3b38f9bb16ce6e2f5f4fe9a.png" /></dd>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + 4\Delta t)\bigl) = 10\,O(\Delta t^4)" src="http://upload.wikimedia.org/math/8/7/e/87e8d0df8d187d46f2f6b45ee6ed707b.png" /></dd>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + 5\Delta t)\bigl) = 15\,O(\Delta t^4)" src="http://upload.wikimedia.org/math/9/4/e/94e58ef60de8a5583825913daedd3267.png" /></dd>
</dl>
<p>Which can be generalized to (it can be shown by induction, but it is given here without proof):</p>
<dl>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + n\Delta t)\bigr) = \frac{n(n+1)}{2}\,O(\Delta t^4)" src="http://upload.wikimedia.org/math/7/3/4/7346dae75206dadb130963131f4269de.png" /></dd>
</dl>
<p>If we consider the global error in position between <span class="texhtml"><i>x</i>(<i>t</i>)</span> and <span class="texhtml"><i>x</i>(<i>t</i> + <i>T</i>)</span>, where <span class="texhtml"><i>T</i> = <i>n</i>Δ<i>t</i></span>, it is clear that:</p>
<dl>
<dd><img class="tex" alt="\mathrm{error}\bigl(x(t_0 + T)\bigr) = \left(\frac{T^2}{2\Delta t^2} + \frac{T}{2\Delta t}\right) O(\Delta t^4)" src="http://upload.wikimedia.org/math/2/f/d/2fde896a6b649bd384a024e4a836e2e2.png" /></dd>
</dl>
<p>And therefore, the global (cumulative) error over a constant interval of time is given by:</p>
<dl>
<dd><img class="tex" alt="\mathrm{error}\bigr(x(t_0 + T)\bigl) = O(\Delta t^2)" src="http://upload.wikimedia.org/math/0/6/5/0658e985bd9328d090e0c72757c4f352.png" /></dd>
</dl>
<p>Because the velocity is determined in a non-cumulative way from the positions in the Verlet integrator, the global error in velocity is also <span class="texhtml"><i>O</i>(Δ<i>t</i><sup>2</sup>)</span>.</p>
<p>In molecular dynamics simulations, the global error is typically far more important than the local error, and the Verlet integrator is therefore known as a second-order integrator.</p>
<p><a name="Constraints" id="Constraints"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=4" title="Edit section: Constraints">edit</a>]</span> <span class="mw-headline">Constraints</span></h2>
<div class="rellink noprint relarticle mainarticle">Main article: <a href="/wiki/Constraint_algorithm" title="Constraint algorithm">Constraint algorithm</a></div>
<p>The most notable thing that is now easier due to using Verlet integration rather than Eulerian is that constraints between particles are very easy to do. A constraint is a connection between multiple points that limits them in some way, perhaps setting them at a specific distance or keeping them apart, or making sure they are closer than a specific distance. Often physics systems use springs between the points in order to keep them in the locations they are supposed to be. However, using springs of infinite stiffness between two points usually gives the best results coupled with the verlet algorithm. Here's how:</p>
<dl>
<dd><img class="tex" alt="d_1=x_2^{(t)}-x_1^{(t)}\," src="http://upload.wikimedia.org/math/b/b/4/bb49006a2df71ba2aef4f970e2819c5c.png" /></dd>
</dl>
<dl>
<dd><img class="tex" alt="d_2=\|d_1\|\," src="http://upload.wikimedia.org/math/c/3/b/c3b625febfc79dc1c77dd7a85a579f36.png" /></dd>
</dl>
<dl>
<dd><img class="tex" alt="d_3=\frac{d_2-r}{d_2}\," src="http://upload.wikimedia.org/math/8/4/c/84ca8311ce5cc7e8d8d4437ddf68b53d.png" /></dd>
</dl>
<dl>
<dd><img class="tex" alt="x_1^{(t+\Delta t)}=\tilde{x}_1^{(t+\Delta t)}+\frac{1}{2}d_1d_3\," src="http://upload.wikimedia.org/math/d/d/7/dd7436078197eff9f9f9579f23ce21ed.png" /></dd>
</dl>
<dl>
<dd><img class="tex" alt="x_2^{(t+\Delta t)}=\tilde{x}_2^{(t+\Delta t)}-\frac{1}{2}d_1d_3\," src="http://upload.wikimedia.org/math/1/2/6/1263ecc77e46ee8841215cbe332f0c18.png" /></dd>
</dl>
<p>The <img class="tex" alt="x_i^{(t)}" src="http://upload.wikimedia.org/math/f/c/1/fc1d9c8e0cb8632b2865cc0df36ac05b.png" /> variables are the positions of the points <i>i</i> at time <i>t</i>, the <img class="tex" alt="\tilde{x}_i^{(t)}" src="http://upload.wikimedia.org/math/1/5/5/15564f853a278900b112dad989e34a3c.png" /> are the <i>unconstrained</i> positions (<i>i.e.</i> the point positions before applying the constraints) of the points <i>i</i> at time <i>t</i>, the d variables are temporary (they are added for <a href="http://en.wiktionary.org/wiki/optimize" class="extiw" title="wiktionary:optimize">optimization</a> as the results of their expressions are needed multiple times), and <i>r</i> is the distance that is supposed to be between the two points. Currently this is in one dimension; however, it is easily expanded to two or three. Simply find the delta (first equation) of each dimension, and then add the deltas squared to the inside of the square root of the second equation (<a href="/wiki/Pythagorean_theorem" title="Pythagorean theorem">Pythagorean theorem</a>). Then, duplicate the last two equations for the number of dimensions there are. This is where verlet makes constraints simple - instead of say, applying a velocity to the points that would eventually satisfy the constraint, you can simply position the point where it should be and the verlet integrator takes care of the rest.</p>
<p>Problems, however, arise when multiple constraints position a vertex. One way to solve this is to loop through all the vertices in a simulation in a criss cross manner, so that at every vertex the constraint relaxation of the last vertex is already used speed up the spread of the information. Either use fine time steps for the simulation, use a fixed number of constraint solving steps per time step, or solve constrains until they are met by a specific deviation.</p>
<p>When approximating the constraints locally to first order this is the same as the <a href="/wiki/Gauss%E2%80%93Seidel_method" title="Gauss–Seidel method">Gauss–Seidel method</a>. For small <a href="/wiki/Matrix_(mathematics)" title="Matrix (mathematics)">matrices</a> it is known that <a href="/wiki/LU_decomposition" title="LU decomposition">LU decomposition</a> is faster. Large systems can be divided into clusters (for example: each <a href="/wiki/Ragdoll_physics" title="Ragdoll physics">ragdoll</a>=cluster). Inside clusters the LU method is used, between clusters the <a href="/wiki/Gauss%E2%80%93Seidel_method" title="Gauss–Seidel method">Gauss–Seidel method</a> is used. The matrix code can be reused: The dependency of the forces on the positions can be approximated locally to first order, and the verlet integration can be made more implicit.</p>
<p>For big matrices sophisticated solvers (look especially for "The sizes of these small dense matrices can be tuned to match the sweet spot" in <a href="http://crd.lbl.gov/~xiaoye/SuperLU/superlu_ug.pdf" class="external autonumber" title="http://crd.lbl.gov/~xiaoye/SuperLU/superlu_ug.pdf" rel="nofollow">[3]</a>) for sparse matrices exist, any self made Verlet integration has to compete with these. The usage of (clusters of) matrices is not generally more precise or stable, but addresses the specific problem, that a force on one vertex of a sheet of cloth should reach any other vertex in a low number of time steps even if a fine grid is used for the cloth <a href="http://www.cs.cmu.edu/~baraff/papers/index.html" class="external autonumber" title="http://www.cs.cmu.edu/~baraff/papers/index.html" rel="nofollow">[4]</a> (link needs refinement) and not form a <a href="/wiki/Sound_wave" title="Sound wave" class="mw-redirect">sound wave</a>.</p>
<p>Another way to solve <a href="/wiki/Holonomic_constraints" title="Holonomic constraints">Holonomic constraints</a> is to use <a href="/wiki/Constraint_algorithm" title="Constraint algorithm">constraint algorithms</a>.</p>
<p><a name="Collision_reactions" id="Collision_reactions"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=5" title="Edit section: Collision reactions">edit</a>]</span> <span class="mw-headline">Collision reactions</span></h2>
<p>One way of reacting to collisions is to use a penalty-based system which basically applies a set force to a point upon contact. The problem with this is that it is very difficult to choose the force imparted. Use too strong a force and objects will become unstable, too weak and the objects will penetrate each other. Another way is to use projection collision reactions which takes the offending point and attempts to move it the shortest distance possible to move it out of the other object.</p>
<p>The Verlet integration would automatically handle the velocity imparted via the collision in the latter case, however note that this is not guaranteed to do so in a way that is consistent with <a href="/wiki/Collision" title="Collision">collision physics</a> (that is, changes in momentum are not guaranteed to be realistic). Instead of implicitly changing the velocity term, you would need to explicitly control the final velocities of the objects colliding (by changing the recorded position from the previous time step).</p>
<p>The two simplest methods for deciding on a new velocity are perfectly <a href="/wiki/Elastic_collision" title="Elastic collision">elastic collisions</a> and <a href="/wiki/Inelastic_collision" title="Inelastic collision">inelastic collisions</a>. A slightly more complicated strategy that offers more control would involve using the <a href="/wiki/Coefficient_of_restitution" title="Coefficient of restitution">coefficient of restitution</a>.</p>
<p><a name="Applications" id="Applications"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=6" title="Edit section: Applications">edit</a>]</span> <span class="mw-headline">Applications</span></h2>
<p>The Verlet equations can also be modified to create a very simple damping effect (for instance, to emulate air friction in computer games):</p>
<dl>
<dd><img class="tex" alt="x(t + \Delta t) = (2-f) x(t) -(1-f) x(t - \Delta t) + a(t)(\Delta t)^2.\," src="http://upload.wikimedia.org/math/e/f/6/ef6d88b5c3a3205add7bb5ee06d3463d.png" /></dd>
</dl>
<p>Where f is a number representing the fraction of the velocity per update that is lost to friction (0-1).</p>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=7" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/Courant%E2%80%93Friedrichs%E2%80%93Lewy_condition" title="Courant–Friedrichs–Lewy condition">Courant–Friedrichs–Lewy condition</a></li>
<li><a href="/wiki/Symplectic_integrator" title="Symplectic integrator">Symplectic integrator</a></li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Verlet_integration&amp;action=edit&amp;section=8" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.teknikus.dk/tj/gdc2001.htm" class="external text" title="http://www.teknikus.dk/tj/gdc2001.htm" rel="nofollow">Advanced Character Physics by Thomas Jakobsen</a></li>
<li><a href="http://www.dhteumeuleu.com/dhtml/v-grid.html" class="external text" title="http://www.dhteumeuleu.com/dhtml/v-grid.html" rel="nofollow">Clothlike demo using the Verlet algorithm</a></li>
<li><a href="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html" class="external text" title="http://www.fisica.uniud.it/~ercolessi/md/md/node21.html" rel="nofollow">The Verlet algorithm</a></li>
<li><a href="http://www.ch.embnet.org/MD_tutorial/pages/MD.Part1.html" class="external text" title="http://www.ch.embnet.org/MD_tutorial/pages/MD.Part1.html" rel="nofollow">Theory of Molecular Dynamics Simulations</a> - bottom of page</li>
</ul>
<table class="navbox" cellspacing="0" style=";">
<tr>
<td style="padding:2px;">
<table cellspacing="0" class="nowraplinks collapsible autocollapse" style="width:100%;background:transparent;color:inherit;;">
<tr>
<th style=";" colspan="2" class="navbox-title">
<div style="float:left; width:6em;text-align:left;">
<div class="noprint plainlinksneverexpand navbar" style="background:none; padding:0; font-weight:normal;;;border:none;; font-size:xx-small;"><a href="/wiki/Template:Numerical_integrators" title="Template:Numerical integrators"><span title="View this template" style=";;border:none;">v</span></a>&#160;<span style="font-size:80%;">•</span>&#160;<a href="/w/index.php?title=Template_talk:Numerical_integrators&amp;action=edit&amp;redlink=1" class="new" title="Template talk:Numerical integrators (page does not exist)"><span title="Discussion about this template" style=";;border:none;">d</span></a>&#160;<span style="font-size:80%;">•</span>&#160;<a href="http://en.wikipedia.org/w/index.php?title=Template:Numerical_integrators&amp;action=edit" class="external text" title="http://en.wikipedia.org/w/index.php?title=Template:Numerical_integrators&amp;action=edit" rel="nofollow"><span title="Edit this template" style=";;border:none;;">e</span></a></div>
</div>
<span style="font-size:110%;"><a href="/wiki/Numerical_ordinary_differential_equations" title="Numerical ordinary differential equations">Numerical integration</a></span></th>
</tr>
<tr style="height:2px;">
<td></td>
</tr>
<tr>
<td class="navbox-group" style=";;"><a href="/wiki/Numerical_ordinary_differential_equations#Consistency_and_order" title="Numerical ordinary differential equations">First order methods</a></td>
<td style="text-align:left;border-left:2px solid #fdfdfd;width:100%;padding:0px;line-height:1.4em; padding:0.33em 0;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em"><span style="white-space:nowrap"><a href="/wiki/Euler_method" title="Euler method">Euler method</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Backward_Euler_method#The_backward_Euler_method" title="Backward Euler method" class="mw-redirect">Backward Euler</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Semi%E2%80%93implicit_Euler" title="Semi–implicit Euler" class="mw-redirect">Semi–implicit Euler</a></span></div>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td class="navbox-group" style=";;"><a href="/wiki/Numerical_ordinary_differential_equations#Consistency_and_order" title="Numerical ordinary differential equations">Second order methods</a></td>
<td style="text-align:left;border-left:2px solid #fdfdfd;width:100%;padding:0px;line-height:1.4em; padding:0.33em 0;;;" class="navbox-list navbox-even">
<div style="padding:0em 0.25em"><span style="white-space:nowrap"><strong class="selflink">Verlet integration</strong>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Velocity_Verlet" title="Velocity Verlet" class="mw-redirect">Velocity Verlet</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Crank%E2%80%93Nicolson_method" title="Crank–Nicolson method">Crank–Nicolson method</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Beeman%27s_algorithm" title="Beeman's algorithm">Beeman's algorithm</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Midpoint_method" title="Midpoint method">Midpoint method</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Heun%27s_method" title="Heun's method">Heun's method</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Newmark-beta_method" title="Newmark-beta method">Newmark-beta method</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Leapfrog_integration" title="Leapfrog integration">Leapfrog integration</a></span></div>
</td>
</tr>
<tr style="height:2px">
<td></td>
</tr>
<tr>
<td class="navbox-group" style=";;"><a href="/wiki/Numerical_ordinary_differential_equations#Consistency_and_order" title="Numerical ordinary differential equations">Higher order methods</a></td>
<td style="text-align:left;border-left:2px solid #fdfdfd;width:100%;padding:0px;line-height:1.4em; padding:0.33em 0;;;" class="navbox-list navbox-odd">
<div style="padding:0em 0.25em"><span style="white-space:nowrap"><a href="/wiki/Runge%E2%80%93Kutta_methods" title="Runge–Kutta methods">Runge–Kutta methods</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/List_of_Runge-Kutta_methods" title="List of Runge-Kutta methods" class="mw-redirect">List of Runge-Kutta methods</a>&#160;<b>·</b></span> <span style="white-space:nowrap"><a href="/wiki/Linear_multistep_method" title="Linear multistep method">Linear multistep method</a></span></div>
</td>
</tr>
</table>
</td>
</tr>
</table>


<!-- 
NewPP limit report
Preprocessor node count: 619/1000000
Post-expand include size: 13651/2048000 bytes
Template argument size: 4981/2048000 bytes
Expensive parser function count: 0/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:825735-0!1!0!default!!en!2 and timestamp 20090427082140 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/Verlet_integration">http://en.wikipedia.org/wiki/Verlet_integration</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Numerical_differential_equations" title="Category:Numerical differential equations">Numerical differential equations</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Verlet_integration" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:Verlet_integration" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=Verlet_integration&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=Verlet_integration&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Verlet_integration" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Verlet_integration" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Verlet_integration" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=Verlet_integration&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=Verlet_integration&amp;oldid=280725538" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=Verlet_integration&amp;id=280725538">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-pl"><a href="http://pl.wikipedia.org/wiki/Algorytm_Verleta">Polski</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 30 March 2009, at 20:53 (UTC).</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv99 in 0.089 secs. --></body></html>
