<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15alpha" />
		<meta name="keywords" content="Netflow,Articles with minor POV problems from March 2009,Alcatel Lucent,Autonomous system (Internet),CPU,Cisco ASA,Cisco IOS,Cisco Systems,Classless Inter-Domain Routing,FreeBSD,Gigabit Switch Router" />
		<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Netflow&amp;action=edit" />
		<link rel="edit" title="Edit this page" href="/w/index.php?title=Netflow&amp;action=edit" />
		<link rel="apple-touch-icon" href="http://en.wikipedia.org/apple-touch-icon.png" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikipedia (en)" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="Wikipedia RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Netflow - Wikipedia, the free encyclopedia</title>
		<link rel="stylesheet" href="/skins-1.5/common/shared.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/common/commonPrint.css?207xx" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins-1.5/monobook/main.css?207xx" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins-1.5/chick/main.css?207xx" type="text/css" media="handheld" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE50Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins-1.5/monobook/IE55Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins-1.5/monobook/IE60Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins-1.5/monobook/IE70Fixes.css?207xx" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Handheld.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" media="handheld" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=2678400&amp;action=raw&amp;maxage=2678400" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=2678400&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins-1.5/common/IEFixes.js?207xx"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins-1.5";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://en.wikipedia.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Netflow";
		var wgTitle = "Netflow";
		var wgAction = "view";
		var wgArticleId = "1206114";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 284374386;
		var wgVersion = "1.15alpha";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgMWSuggestTemplate = "http://en.wikipedia.org/w/api.php?action=opensearch\x26search={searchTerms}\x26namespace={namespaces}\x26suggest";
		var wgDBname = "enwiki";
		var wgSearchNamespaces = [0];
		var wgMWSuggestMessages = ["with suggestions", "no suggestions"];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins-1.5/common/wikibits.js?207xx"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/skins-1.5/common/ajax.js?207xx"></script>
		<script type="text/javascript" src="/skins-1.5/common/mwsuggest.js?207xx"></script>
<script type="text/javascript">/*<![CDATA[*/
var wgNotice='';var wgNoticeLocal='';
/*]]>*/</script>		<script type="text/javascript" src="http://upload.wikimedia.org/centralnotice/wikipedia/en/centralnotice.js?207xx"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Netflow skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="siteNotice"><script type='text/javascript'>if (wgNotice != '') document.writeln(wgNotice);</script></div>		<h1 id="firstHeading" class="firstHeading">Netflow</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Wikipedia, the free encyclopedia</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table class="metadata plainlinks ambox ambox-style" style="">
<tr>
<td class="mbox-image">
<div style="width: 52px;"><a href="/wiki/File:Text_document_with_red_question_mark.svg" class="image" title="Text document with red question mark.svg"><img alt="" src="http://upload.wikimedia.org/wikipedia/commons/thumb/a/a4/Text_document_with_red_question_mark.svg/40px-Text_document_with_red_question_mark.svg.png" width="40" height="40" border="0" /></a></div>
</td>
<td class="mbox-text" style="">This article includes a <a href="/wiki/Wikipedia:Citing_sources" title="Wikipedia:Citing sources">list of references</a> or <a href="/wiki/Wikipedia:External_links" title="Wikipedia:External links">external links</a>, but <b>its sources remain unclear because it lacks <a href="/wiki/Wikipedia:Citing_sources#Inline_citations" title="Wikipedia:Citing sources">inline citations</a>.</b> Please <a href="/wiki/Wikipedia:WikiProject_Fact_and_Reference_Check" title="Wikipedia:WikiProject Fact and Reference Check">improve</a> this article by introducing more precise citations <a href="/wiki/Wikipedia:When_to_cite" title="Wikipedia:When to cite">where appropriate</a>. <small><i>(March 2009)</i></small></td>
</tr>
</table>
<div class="thumb tright">
<div class="thumbinner" style="width:402px;"><a href="/wiki/File:Netflow_architecture_en.svg" class="image" title="NetFlow architecture"><img alt="" src="http://upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Netflow_architecture_en.svg/400px-Netflow_architecture_en.svg.png" width="400" height="300" border="0" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify"><a href="/wiki/File:Netflow_architecture_en.svg" class="internal" title="Enlarge"><img src="/skins-1.5/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
NetFlow architecture</div>
</div>
</div>
<p><b>NetFlow</b> is a <a href="/wiki/Network_protocol" title="Network protocol" class="mw-redirect">network protocol</a> developed by <a href="/wiki/Cisco_Systems" title="Cisco Systems">Cisco Systems</a> to run on <a href="/wiki/Cisco_IOS" title="Cisco IOS">Cisco IOS</a>-enabled equipment for collecting <a href="/wiki/Internet_Protocol" title="Internet Protocol">IP</a> traffic information. It's proprietary and supported by platforms other than IOS, such as <a href="/wiki/Juniper_Networks" title="Juniper Networks">Juniper</a> routers or <a href="/wiki/FreeBSD" title="FreeBSD">FreeBSD</a> and <a href="/wiki/OpenBSD" title="OpenBSD">OpenBSD</a>.</p>
<table id="toc" class="toc" summary="Contents">
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul>
<li class="toclevel-1"><a href="#Protocol_description"><span class="tocnumber">1</span> <span class="toctext">Protocol description</span></a>
<ul>
<li class="toclevel-2"><a href="#NetFlow_and_IPFIX"><span class="tocnumber">1.1</span> <span class="toctext">NetFlow and IPFIX</span></a></li>
<li class="toclevel-2"><a href="#Network_Flows"><span class="tocnumber">1.2</span> <span class="toctext">Network Flows</span></a></li>
<li class="toclevel-2"><a href="#Netflow_Record"><span class="tocnumber">1.3</span> <span class="toctext">Netflow Record</span></a></li>
<li class="toclevel-2"><a href="#Cisco.27s_Sampled_NetFlow"><span class="tocnumber">1.4</span> <span class="toctext">Cisco's Sampled NetFlow</span></a></li>
<li class="toclevel-2"><a href="#Cisco.27s_NetFlow_Security_Event_Logging"><span class="tocnumber">1.5</span> <span class="toctext">Cisco's NetFlow Security Event Logging</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#NetFlow_Monitoring_Based_on_Standalone_Probes"><span class="tocnumber">2</span> <span class="toctext">NetFlow Monitoring Based on Standalone Probes</span></a></li>
<li class="toclevel-1"><a href="#Versions"><span class="tocnumber">3</span> <span class="toctext">Versions</span></a></li>
<li class="toclevel-1"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1"><a href="#External_links"><span class="tocnumber">5</span> <span class="toctext">External links</span></a></li>
</ul>
</td>
</tr>
</table>
<script type="text/javascript">
//<![CDATA[
 if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } 
//]]>
</script>
<p><a name="Protocol_description" id="Protocol_description"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=1" title="Edit section: Protocol description">edit</a>]</span> <span class="mw-headline">Protocol description</span></h2>
<p>Cisco <a href="/wiki/Router" title="Router">routers</a> that have the Netflow feature enabled generate netflow records; these are exported from the router in User Datagram Protocol (<a href="/wiki/User_Datagram_Protocol" title="User Datagram Protocol">UDP</a>) or Stream Control Transmission Protocol (<a href="/wiki/Stream_Control_Transmission_Protocol" title="Stream Control Transmission Protocol">SCTP</a>) packets and collected using a netflow collector. Other vendors provide similar features for their routers but with different names:</p>
<ul>
<li>Jflow or cflowd for <a href="/wiki/Juniper_Networks" title="Juniper Networks">Juniper Networks</a></li>
<li>NetStream for <a href="/wiki/Huawei" title="Huawei">Huawei Technology</a></li>
<li>Cflowd for <a href="/wiki/Alcatel_Lucent" title="Alcatel Lucent" class="mw-redirect">Alcatel-Lucent</a></li>
</ul>
<p><a name="NetFlow_and_IPFIX" id="NetFlow_and_IPFIX"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=2" title="Edit section: NetFlow and IPFIX">edit</a>]</span> <span class="mw-headline">NetFlow and IPFIX</span></h3>
<p>Although initially implemented by Cisco, NetFlow is emerging as an <a href="/wiki/Internet_Engineering_Task_Force" title="Internet Engineering Task Force">IETF</a> standard: Internet Protocol Flow Information eXport (<a href="/wiki/IPFIX" title="IPFIX" class="mw-redirect">IPFIX</a>). Based on the NetFlow Version 9 implementation, IPFIX is going to be the industry standard in the very near future. Network infrastructure vendors, including <a href="/wiki/Nortel" title="Nortel">Nortel Networks</a> and others, are already adding IPFIX support to their devices.</p>
<p><a name="Network_Flows" id="Network_Flows"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=3" title="Edit section: Network Flows">edit</a>]</span> <span class="mw-headline">Network Flows</span></h3>
<p>A network <b>flow</b> has been defined in many ways. The traditional Cisco definition is to use a 7-<a href="/wiki/Tuple" title="Tuple">tuple</a> key, where a flow is defined as a unidirectional sequence of packets all sharing all of the following 7 values:</p>
<ol>
<li>Source <a href="/wiki/IP_address" title="IP address">IP address</a></li>
<li>Destination <a href="/wiki/IP_address" title="IP address">IP address</a></li>
<li>Source port for <a href="/wiki/User_Datagram_Protocol" title="User Datagram Protocol">UDP</a> or <a href="/wiki/Transmission_Control_Protocol" title="Transmission Control Protocol">TCP</a>, 0 for other protocols</li>
<li>Destination port for <a href="/wiki/User_Datagram_Protocol" title="User Datagram Protocol">UDP</a> or <a href="/wiki/Transmission_Control_Protocol" title="Transmission Control Protocol">TCP</a>, type and code for <a href="/wiki/Internet_Control_Message_Protocol" title="Internet Control Message Protocol">ICMP</a>, or 0 for other protocols</li>
<li><a href="/wiki/IP_protocol" title="IP protocol" class="mw-redirect">IP protocol</a></li>
<li>Ingress interface</li>
<li>IP <a href="/wiki/Type_of_Service" title="Type of Service">Type of Service</a></li>
</ol>
<p>Flexible Netflow and IPFIX support user-defined flow keys.</p>
<p>The router will output a flow record when it determines that the flow is finished. It does this by flow aging: when the router sees new traffic for an existing flow it resets the aging counter. Also, <a href="/w/index.php?title=TCP_session&amp;action=edit&amp;redlink=1" class="new" title="TCP session (page does not exist)">TCP session</a> termination in a TCP flow causes the router to expire the flow. Routers can also be configured to output a flow record at a fixed interval even if the flow is still ongoing. In Flexible NetFlow (FNF) an administrator could actually define flow properties on the router.</p>
<p><a name="Netflow_Record" id="Netflow_Record"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=4" title="Edit section: Netflow Record">edit</a>]</span> <span class="mw-headline">Netflow Record</span></h3>
<p>A NetFlow record can contain a wide variety of information about the traffic in a given flow. NetFlow version 5 (one of the most commonly used versions, followed by version 9) contains the following:</p>
<ul>
<li>Version number</li>
<li>Sequence number</li>
<li>Input and output interface indices used by <a href="/wiki/SNMP" title="SNMP" class="mw-redirect">SNMP</a> (ifIndex in IF-MIB).</li>
<li>Timestamps for the flow start and finish time, in milliseconds since the last boot.</li>
<li>Number of bytes and packets observed in the flow</li>
<li><a href="/wiki/Layer_3" title="Layer 3">Layer 3</a> headers:
<ul>
<li>Source &amp; destination IP addresses</li>
<li>Source and destination port numbers</li>
<li>IP protocol</li>
<li><a href="/wiki/Type_of_Service" title="Type of Service">Type of Service</a> (ToS) value</li>
</ul>
</li>
<li>In the case of TCP flows, the union of all TCP flags observed over the life of the flow.</li>
<li>Layer 3 <a href="/wiki/Routing" title="Routing">Routing</a> information:
<ul>
<li>IP address of the immediate next-hop (not the BGP nexthop) along the route to the destination</li>
<li>Source &amp; destination IP masks (prefix lengths in the <a href="/wiki/Classless_Inter-Domain_Routing" title="Classless Inter-Domain Routing">CIDR</a> notation)</li>
</ul>
</li>
</ul>
<p>Some routers will also include the source and destination <a href="/wiki/Autonomous_system_(Internet)" title="Autonomous system (Internet)">Autonomous System</a> (AS) number. Depending on the router configuration, it can also be the immediate neighbor AS. That information is not always accurate, and the local AS will be indicated by the same value (zero) as any unknown AS.</p>
<p>NetFlow version 9 can include all of these fields and can optionally include additional information such as <a href="/wiki/Multiprotocol_Label_Switching" title="Multiprotocol Label Switching">Multiprotocol Label Switching</a> (MPLS) labels and <a href="/wiki/IPv6" title="IPv6">IPv6</a> addresses and ports,</p>
<p>By analyzing flow data, a picture of traffic flow and traffic volume in a network can be built. The NetFlow record format has evolved over time, hence the inclusion of version numbers. Cisco maintains details of the different version numbers and the layout of the packets for each version.</p>
<p>NetFlow records are usually sent via a UDP or SCTP in newer software, and for efficiency reasons, the router does not store flow records once they are exported. Therefore, if the NetFlow record is dropped due to <a href="/wiki/Network_congestion" title="Network congestion">network congestion</a>, it is lost forever -- there's no way for the router to resend it (this is correct for UDP NetFlow only). The IP address of the netflow collector and the port upon which it is listening must be configured on the sending router but is usually either on ports 2055, 9555, or 9995. NetFlow is also enabled on a per-interface basis to avoid unnecessary burdening of the router's <a href="/wiki/CPU" title="CPU" class="mw-redirect">CPU</a>. NetFlow is generally based on the packets input to interfaces where it is enabled. This avoids double counting and saves work for the router. It also allows the router to export NetFlow records for <a href="/w/index.php?title=Dropped_packets&amp;action=edit&amp;redlink=1" class="new" title="Dropped packets (page does not exist)">dropped packets</a>.</p>
<p>ICMP records use the Destination Port number field to define the ICMP Type and CODE in HEX. The type and code are concatenated before the conversion. An ICMP Host Unreachable message would be TYPE 3 with a CODE of 01 (301). Netflow converts this value to a hex value of 769 when exported.</p>
<p><a name="Cisco.27s_Sampled_NetFlow" id="Cisco.27s_Sampled_NetFlow"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=5" title="Edit section: Cisco's Sampled NetFlow">edit</a>]</span> <span class="mw-headline">Cisco's Sampled NetFlow</span></h3>
<p>Maintaining NetFlow data can be computationally expensive for the router and burden the router's CPU to the point where it runs out of capacity. To avoid problems caused by router CPU exhaustion, Cisco provides "Sampled NetFlow". Rather than looking at every packet to maintain NetFlow records, the router looks at every <i>n<sup>th</sup></i> packet, where <i>n</i> can be configured (as in Deterministic NetFlow, used on Cisco's <a href="/wiki/Gigabit_Switch_Router" title="Gigabit Switch Router" class="mw-redirect">GSRs</a>) or it is a randomly selecting interval (as used in Random Sampled Netflow, used on all other Cisco platforms). When Sampled NetFlow is used, the NetFlow records must be adjusted for the effect of sampling - traffic volumes, in particular, are now an estimate rather than the actual measured flow volume.</p>
<p><a name="Cisco.27s_NetFlow_Security_Event_Logging" id="Cisco.27s_NetFlow_Security_Event_Logging"></a></p>
<h3><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=6" title="Edit section: Cisco's NetFlow Security Event Logging">edit</a>]</span> <span class="mw-headline">Cisco's NetFlow Security Event Logging</span></h3>
<p>Introduced with the launch of the <a href="/wiki/Cisco_ASA" title="Cisco ASA">Cisco ASA</a> 5580 products, <a href="http://www.cisco.com/en/US/docs/security/asa/asa81/netflow/netflow.html" class="external text" title="http://www.cisco.com/en/US/docs/security/asa/asa81/netflow/netflow.html" rel="nofollow">NetFlow Security Event Logging</a> utilizes Netflow v9 fields and templates in order to efficiently deliver security telemetry in high performance environments. NetFlow Security Event Logging scales better than <a href="/wiki/Syslog" title="Syslog">syslog</a> while offering the same level of detail and granularity in logged events.<sup class="noprint Inline-Template"><span title="This statement may not be entirely without bias&#160;from March 2009" style="white-space: nowrap;">[<i><a href="/wiki/Wikipedia:Neutral_point_of_view" title="Wikipedia:Neutral point of view">neutrality disputed</a></i>]</span></sup></p>
<p><a name="NetFlow_Monitoring_Based_on_Standalone_Probes" id="NetFlow_Monitoring_Based_on_Standalone_Probes"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=7" title="Edit section: NetFlow Monitoring Based on Standalone Probes">edit</a>]</span> <span class="mw-headline">NetFlow Monitoring Based on Standalone Probes</span></h2>
<table class="metadata plainlinks ambox ambox-content" style="">
<tr>
<td class="mbox-image">
<div style="width: 52px;"><a href="/wiki/File:Ambox_content.png" class="image" title="Ambox content.png"><img alt="" src="http://upload.wikimedia.org/wikipedia/en/f/f4/Ambox_content.png" width="40" height="40" border="0" /></a></div>
</td>
<td class="mbox-text" style="">This section <b>may contain <a href="/wiki/Wikipedia:No_original_research" title="Wikipedia:No original research">original research</a> or <a href="/wiki/Wikipedia:Verifiability" title="Wikipedia:Verifiability">unverified claims</a></b>. Please <a href="http://en.wikipedia.org/w/index.php?title=Netflow&amp;action=edit" class="external text" title="http://en.wikipedia.org/w/index.php?title=Netflow&amp;action=edit" rel="nofollow">improve the article</a> by adding <a href="/wiki/Wikipedia:References" title="Wikipedia:References" class="mw-redirect">references</a>. See the <a href="/wiki/Talk:Netflow" title="Talk:Netflow">talk page</a> for details. <small><i>(March 2009)</i></small></td>
</tr>
</table>
<div class="thumb tright">
<div class="thumbinner" style="width:182px;"><a href="/wiki/File:NewNetFlowApproach.png" class="image" title="NetFlow architecture using standalone probes."><img alt="" src="http://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/NewNetFlowApproach.png/180px-NewNetFlowApproach.png" width="180" height="167" border="0" class="thumbimage" /></a>
<div class="thumbcaption">
<div class="magnify"><a href="/wiki/File:NewNetFlowApproach.png" class="internal" title="Enlarge"><img src="/skins-1.5/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>
NetFlow architecture using standalone probes.</div>
</div>
</div>
<p>Although frequently used, the router-based approach suffers from several limitations. Cisco routers often use input packet sampling and the number of supported packets/sec or flows/sec is limited unless additional specialized and costly network boards are used. Furthermore, the routers have fixed placement, layer 3 visibility makes them target of attacks, and the provided statistics are not reliable enough for billing or security applications. Moreover, enabling the NetFlow monitoring on software-based routers (Cisco 7200 etc.) slows down their performance.</p>
<p>For this reason, a new approach in NetFlow monitoring using standalone NetFlow probes is becoming very popular. This approach overcomes the limitations of router-based NetFlow monitoring. The probes are transparently connected to the monitored link as a totally passive appliance using TAP or SPAN port of switch or router. NetFlow probes are using dedicated link for NetFlow exports, so they are completely invisible on the monitored link.</p>
<p><a name="Versions" id="Versions"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=8" title="Edit section: Versions">edit</a>]</span> <span class="mw-headline">Versions</span></h2>
<table class="metadata plainlinks ambox ambox-content" style="">
<tr>
<td class="mbox-image">
<div style="width: 52px;"><a href="/wiki/File:Ambox_content.png" class="image" title="Ambox content.png"><img alt="" src="http://upload.wikimedia.org/wikipedia/en/f/f4/Ambox_content.png" width="40" height="40" border="0" /></a></div>
</td>
<td class="mbox-text" style="">This section contains information which may be of <b>unclear or questionable <a href="/wiki/Wikipedia:What_Wikipedia_is_not#Wikipedia_is_not_an_indiscriminate_collection_of_information" title="Wikipedia:What Wikipedia is not">importance</a> or <a href="/wiki/Wikipedia:Guide_to_writing_better_articles" title="Wikipedia:Guide to writing better articles" class="mw-redirect">relevance</a></b> to the article's subject matter.<br />
<small>Please help <a href="http://en.wikipedia.org/w/index.php?title=Netflow&amp;action=edit" class="external text" title="http://en.wikipedia.org/w/index.php?title=Netflow&amp;action=edit" rel="nofollow">improve this article</a> by clarifying or removing superfluous information.</small></td>
</tr>
</table>
<table class="wikitable" style="margin: 0 auto; text-align: left">
<tr>
<th>Version</th>
<th>Comment</th>
</tr>
<tr>
<th>v1</th>
<td>First try</td>
</tr>
<tr>
<th>v5</th>
<td>Most used version</td>
</tr>
<tr>
<th>v6</th>
<td>Encapsulation information</td>
</tr>
<tr>
<th>v7</th>
<td>Switch information</td>
</tr>
<tr>
<th>v8</th>
<td>Several aggregation forms</td>
</tr>
<tr>
<th>v9</th>
<td>Template Based, allowing many combinations</td>
</tr>
<tr>
<th>IPFIX</th>
<td>aka v10; IETF Standardized NetFlow 9 with Enterprise fields and other community input</td>
</tr>
</table>
<p><a name="See_also" id="See_also"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=9" title="Edit section: See also">edit</a>]</span> <span class="mw-headline">See also</span></h2>
<ul>
<li><a href="/wiki/IP_Flow_Information_Export" title="IP Flow Information Export">IP Flow Information Export</a> (IPFIX) - <a href="/wiki/IETF" title="IETF" class="mw-redirect">IETF</a> work to standardize flow export, based on NetFlow version 9</li>
<li><a href="/wiki/SFlow" title="SFlow">SFlow</a></li>
</ul>
<p><a name="External_links" id="External_links"></a></p>
<h2><span class="editsection">[<a href="/w/index.php?title=Netflow&amp;action=edit&amp;section=10" title="Edit section: External links">edit</a>]</span> <span class="mw-headline">External links</span></h2>
<ul>
<li><a href="http://www.cisco.com/go/netflow" class="external text" title="http://www.cisco.com/go/netflow" rel="nofollow">Basic Netflow information on the Cisco Site</a></li>
<li><a href="http://www.cisco.com/en/US/technologies/tk648/tk362/technologies_white_paper09186a00800a3db9.html" class="external text" title="http://www.cisco.com/en/US/technologies/tk648/tk362/technologies_white_paper09186a00800a3db9.html" rel="nofollow">Packet format for Version 9 NetFlow packets</a></li>
<li><a href="http://www.cisco.com/en/US/docs/security/asa/asa81/netflow/netflow.html" class="external text" title="http://www.cisco.com/en/US/docs/security/asa/asa81/netflow/netflow.html" rel="nofollow">Cisco NetFlow Security Event Logging</a></li>
<li><a href="http://www.ietf.org/rfc/rfc3334.txt" class="external text" title="http://www.ietf.org/rfc/rfc3334.txt" rel="nofollow">RFC3334 - Policy-Based Accounting</a></li>
<li><a href="http://www.ietf.org/rfc/rfc3954.txt" class="external text" title="http://www.ietf.org/rfc/rfc3954.txt" rel="nofollow">RFC3954 - NetFlow Version 9</a></li>
<li><a href="http://www.ietf.org/rfc/rfc3955.txt" class="external text" title="http://www.ietf.org/rfc/rfc3955.txt" rel="nofollow">RFC3955 - Candidate Protocols for IP Flow Information Export (IPFIX)</a></li>
<li><a href="http://www.ietf.org/rfc/rfc5101.txt" class="external text" title="http://www.ietf.org/rfc/rfc5101.txt" rel="nofollow">RFC5101 - Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information (IPFIX)</a></li>
<li><a href="http://www.ietf.org/rfc/rfc5102.txt" class="external text" title="http://www.ietf.org/rfc/rfc5102.txt" rel="nofollow">RFC5102 - Information Model for IP Flow Information Export</a></li>
<li><a href="http://www.switch.ch/network/projects/completed/TF-NGN/floma/software.html" class="external text" title="http://www.switch.ch/network/projects/completed/TF-NGN/floma/software.html" rel="nofollow">List of software related to flow accounting</a></li>
</ul>


<!-- 
NewPP limit report
Preprocessor node count: 459/1000000
Post-expand include size: 10028/2048000 bytes
Template argument size: 3228/2048000 bytes
Expensive parser function count: 1/500
-->

<!-- Saved in parser cache with key enwiki:pcache:idhash:1206114-0!1!0!default!!en!2 and timestamp 20090417074253 -->
<div class="printfooter">
Retrieved from "<a href="http://en.wikipedia.org/wiki/Netflow">http://en.wikipedia.org/wiki/Netflow</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>:&#32;<span dir='ltr'><a href="/wiki/Category:Computer_network_analysis" title="Category:Computer network analysis">Computer network analysis</a></span> | <span dir='ltr'><a href="/wiki/Category:Network-related_software" title="Category:Network-related software">Network-related software</a></span> | <span dir='ltr'><a href="/wiki/Category:Cisco_protocols" title="Category:Cisco protocols">Cisco protocols</a></span></div><div id="mw-hidden-catlinks" class="mw-hidden-cats-hidden">Hidden categories:&#32;<span dir='ltr'><a href="/wiki/Category:Articles_lacking_in-text_citations_from_March_2009" title="Category:Articles lacking in-text citations from March 2009">Articles lacking in-text citations from March 2009</a></span> | <span dir='ltr'><a href="/wiki/Category:All_pages_needing_cleanup" title="Category:All pages needing cleanup">All pages needing cleanup</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_with_minor_POV_problems_from_March_2009" title="Category:Articles with minor POV problems from March 2009">Articles with minor POV problems from March 2009</a></span> | <span dir='ltr'><a href="/wiki/Category:Articles_that_may_contain_original_research_since_March_2009" title="Category:Articles that may contain original research since March 2009">Articles that may contain original research since March 2009</a></span> | <span dir='ltr'><a href="/wiki/Category:All_articles_that_may_contain_original_research" title="Category:All articles that may contain original research">All articles that may contain original research</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/Netflow" title="View the content page [c]" accesskey="c">Article</a></li>
				 <li id="ca-talk"><a href="/wiki/Talk:Netflow" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="/w/index.php?title=Netflow&amp;action=edit" title="You can edit this page. &#10;Please use the preview button before saving. [e]" accesskey="e">Edit this page</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=Netflow&amp;action=history" title="Past versions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Netflow" title="You are encouraged to log in; however, it is not mandatory. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-contents"><a href="/wiki/Portal:Contents" title="Guides to browsing Wikipedia">Contents</a></li>
				<li id="n-featuredcontent"><a href="/wiki/Portal:Featured_content" title="Featured content — the best of Wikipedia">Featured content</a></li>
				<li id="n-currentevents"><a href="/wiki/Portal:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random article [x]" accesskey="x">Random article</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Wikipedia [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if one exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search Wikipedia for this text" />
			</div></form>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-interaction'>
		<h5>Interaction</h5>
		<div class='pBody'>
			<ul>
				<li id="n-aboutsite"><a href="/wiki/Wikipedia:About" title="Find out about Wikipedia">About Wikipedia</a></li>
				<li id="n-portal"><a href="/wiki/Wikipedia:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-contact"><a href="/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia">Contact Wikipedia</a></li>
				<li id="n-sitesupport"><a href="http://wikimediafoundation.org/wiki/Donate" title="Support us">Donate to Wikipedia</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Netflow" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Netflow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-upload"><a href="/wiki/Wikipedia:Upload" title="Upload files [u]" accesskey="u">Upload file</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=Netflow&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=Netflow&amp;oldid=284374386" title="Permanent link to this version of the page">Permanent link</a></li><li id="t-cite"><a href="/w/index.php?title=Special:Cite&amp;page=Netflow&amp;id=284374386">Cite this page</a></li>			</ul>
		</div>
	</div>
	<div id="p-lang" class="portlet">
		<h5>Languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-de"><a href="http://de.wikipedia.org/wiki/Netflow">Deutsch</a></li>
				<li class="interwiki-cs"><a href="http://cs.wikipedia.org/wiki/Netflow">Česky</a></li>
				<li class="interwiki-ru"><a href="http://ru.wikipedia.org/wiki/Netflow">Русский</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins-1.5/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://wikimediafoundation.org/"><img src="/images/wikimedia-button.png" border="0" alt="Wikimedia Foundation"/></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 17 April 2009, at 07:42 (UTC).</li>
					<li id="copyright">All text is available under the terms of the <a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Text_of_the_GNU_Free_Documentation_License" title="Wikipedia:Text of the GNU Free Documentation License">GNU Free Documentation License</a>. (See <b><a class='internal' href="http://en.wikipedia.org/wiki/Wikipedia:Copyrights" title="Wikipedia:Copyrights">Copyrights</a></b> for details.) <br /> Wikipedia&reg; is a registered trademark of the <a href="http://www.wikimediafoundation.org">Wikimedia Foundation, Inc.</a>, a U.S. registered <a class='internal' href="http://en.wikipedia.org/wiki/501%28c%29#501.28c.29.283.29" title="501(c)(3)">501(c)(3)</a> <a href="http://wikimediafoundation.org/wiki/Deductibility_of_donations">tax-deductible</a> <a class='internal' href="http://en.wikipedia.org/wiki/Non-profit_organization" title="Non-profit organization">nonprofit</a> <a href="http://en.wikipedia.org/wiki/Charitable_organization" title="Charitable organization">charity</a>.<br /></li>
					<li id="privacy"><a href="http://wikimediafoundation.org/wiki/Privacy_policy" title="wikimedia:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/Wikipedia:About" title="Wikipedia:About">About Wikipedia</a></li>
					<li id="disclaimer"><a href="/wiki/Wikipedia:General_disclaimer" title="Wikipedia:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served by srv151 in 0.102 secs. --></body></html>
